!function(){function e(e,t,i){return e.call.apply(e.bind,arguments)}function t(e,t,i){if(!e)throw Error();if(2<arguments.length){var o=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,o),e.apply(t,i)}}return function(){return e.apply(t,arguments)}}function i(o,n,a){return(i=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?e:t).apply(null,arguments)}var o=Date.now||function(){return+new Date};function n(e,t){this.a=e,this.o=t||e,this.c=this.o.document}var a=!!window.FontFace;function r(e,t,i,o){if(t=e.c.createElement(t),i)for(var n in i)i.hasOwnProperty(n)&&("style"==n?t.style.cssText=i[n]:t.setAttribute(n,i[n]));return o&&t.appendChild(e.c.createTextNode(o)),t}function s(e,t,i){(e=e.c.getElementsByTagName(t)[0])||(e=document.documentElement),e.insertBefore(i,e.lastChild)}function l(e){e.parentNode&&e.parentNode.removeChild(e)}function d(e,t,i){t=t||[],i=i||[];for(var o=e.className.split(/\s+/),n=0;n<t.length;n+=1){for(var a=!1,r=0;r<o.length;r+=1)if(t[n]===o[r]){a=!0;break}a||o.push(t[n])}for(t=[],n=0;n<o.length;n+=1){for(a=!1,r=0;r<i.length;r+=1)if(o[n]===i[r]){a=!0;break}a||t.push(o[n])}e.className=t.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function c(e,t){for(var i=e.className.split(/\s+/),o=0,n=i.length;o<n;o++)if(i[o]==t)return!0;return!1}function h(e,t,i){function o(){c&&n&&l&&(c(d),c=null)}t=r(e,"link",{rel:"stylesheet",href:t,media:"all"});var n=!1,l=!0,d=null,c=i||null;a?(t.onload=function(){n=!0,o()},t.onerror=function(){n=!0,d=Error("Stylesheet failed to load"),o()}):setTimeout(function(){n=!0,o()},0),s(e,"head",t)}function u(e,t,i,o){var n=e.c.getElementsByTagName("head")[0];if(n){var a=r(e,"script",{src:t}),s=!1;return a.onload=a.onreadystatechange=function(){s||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(s=!0,i&&i(null),a.onload=a.onreadystatechange=null,"HEAD"==a.parentNode.tagName&&n.removeChild(a))},n.appendChild(a),setTimeout(function(){s||(s=!0,i&&i(Error("Script load timeout")))},o||5e3),a}return null}function g(){this.a=0,this.c=null}function p(e){return e.a++,function(){e.a--,f(e)}}function m(e,t){e.c=t,f(e)}function f(e){0==e.a&&e.c&&(e.c(),e.c=null)}function v(e){this.a=e||"-"}function b(e,t){this.c=e,this.f=4,this.a="n";var i=(t||"n4").match(/^([nio])([1-9])$/i);i&&(this.a=i[1],this.f=parseInt(i[2],10))}function _(e){var t=[];e=e.split(/,\s*/);for(var i=0;i<e.length;i++){var o=e[i].replace(/['"]/g,"");-1!=o.indexOf(" ")||/^\d/.test(o)?t.push("'"+o+"'"):t.push(o)}return t.join(",")}function y(e){return e.a+e.f}function w(e){var t="normal";return"o"===e.a?t="oblique":"i"===e.a&&(t="italic"),t}function C(e){var t=4,i="n",o=null;return e&&((o=e.match(/(normal|oblique|italic)/i))&&o[1]&&(i=o[1].substr(0,1).toLowerCase()),(o=e.match(/([1-9]00|normal|bold)/i))&&o[1]&&(/bold/i.test(o[1])?t=7:/[1-9]00/.test(o[1])&&(t=parseInt(o[1].substr(0,1),10)))),i+t}function S(e,t){this.c=e,this.f=e.o.document.documentElement,this.h=t,this.a=new v("-"),this.j=!1!==t.events,this.g=!1!==t.classes}function x(e){if(e.g){var t=c(e.f,e.a.c("wf","active")),i=[],o=[e.a.c("wf","loading")];t||i.push(e.a.c("wf","inactive")),d(e.f,i,o)}E(e,"inactive")}function E(e,t,i){e.j&&e.h[t]&&(i?e.h[t](i.c,y(i)):e.h[t]())}function k(){this.c={}}function I(e,t){this.c=e,this.f=t,this.a=r(this.c,"span",{"aria-hidden":"true"},this.f)}function T(e){s(e.c,"body",e.a)}function A(e){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+_(e.c)+";font-style:"+w(e)+";font-weight:"+e.f+"00;"}function M(e,t,i,o,n,a){this.g=e,this.j=t,this.a=o,this.c=i,this.f=n||3e3,this.h=a||void 0}function P(e,t,i,o,n,a,r){this.v=e,this.B=t,this.c=i,this.a=o,this.s=r||"BESbswy",this.f={},this.w=n||3e3,this.u=a||null,this.m=this.j=this.h=this.g=null,this.g=new I(this.c,this.s),this.h=new I(this.c,this.s),this.j=new I(this.c,this.s),this.m=new I(this.c,this.s),e=A(e=new b(this.a.c+",serif",y(this.a))),this.g.a.style.cssText=e,e=A(e=new b(this.a.c+",sans-serif",y(this.a))),this.h.a.style.cssText=e,e=A(e=new b("serif",y(this.a))),this.j.a.style.cssText=e,e=A(e=new b("sans-serif",y(this.a))),this.m.a.style.cssText=e,T(this.g),T(this.h),T(this.j),T(this.m)}v.prototype.c=function(e){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return t.join(this.a)},M.prototype.start=function(){var e=this.c.o.document,t=this,i=o(),n=new Promise(function(n,a){!function r(){o()-i>=t.f?a():e.fonts.load(function(e){return w(e)+" "+e.f+"00 300px "+_(e.c)}(t.a),t.h).then(function(e){1<=e.length?n():setTimeout(r,25)},function(){a()})}()}),a=null,r=new Promise(function(e,i){a=setTimeout(i,t.f)});Promise.race([r,n]).then(function(){a&&(clearTimeout(a),a=null),t.g(t.a)},function(){t.j(t.a)})};var O={D:"serif",C:"sans-serif"},L=null;function N(){if(null===L){var e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);L=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))}return L}function D(e,t,i){for(var o in O)if(O.hasOwnProperty(o)&&t===e.f[O[o]]&&i===e.f[O[o]])return!0;return!1}function R(e){var t,n=e.g.a.offsetWidth,a=e.h.a.offsetWidth;(t=n===e.f.serif&&a===e.f["sans-serif"])||(t=N()&&D(e,n,a)),t?o()-e.A>=e.w?N()&&D(e,n,a)&&(null===e.u||e.u.hasOwnProperty(e.a.c))?H(e,e.v):H(e,e.B):function(e){setTimeout(i(function(){R(this)},e),50)}(e):H(e,e.v)}function H(e,t){setTimeout(i(function(){l(this.g.a),l(this.h.a),l(this.j.a),l(this.m.a),t(this.a)},e),0)}function V(e,t,i){this.c=e,this.a=t,this.f=0,this.m=this.j=!1,this.s=i}P.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=o(),R(this)};var $=null;function G(e){0==--e.f&&e.j&&(e.m?((e=e.a).g&&d(e.f,[e.a.c("wf","active")],[e.a.c("wf","loading"),e.a.c("wf","inactive")]),E(e,"active")):x(e.a))}function F(e){this.j=e,this.g=new k,this.h=0,this.a=this.f=!0}function z(e,t){se.g.c[e]=t}function B(e,t,o,n,a){var r=0==--e.h;(e.a||e.f)&&setTimeout(function(){var e=a||null,s=n||{};if(0===o.length&&r)x(t.a);else{t.f+=o.length,r&&(t.j=r);var l,c=[];for(l=0;l<o.length;l++){var h=o[l],u=s[h.c],g=t.a,p=h;if(g.g&&d(g.f,[g.a.c("wf",p.c,y(p).toString(),"loading")]),E(g,"fontloading",p),g=null,null===$)if(window.FontFace){p=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var m=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);$=p?42<parseInt(p[1],10):!m}else $=!1;g=$?new M(i(t.g,t),i(t.h,t),t.c,h,t.s,u):new P(i(t.g,t),i(t.h,t),t.c,h,t.s,e,u),c.push(g)}for(l=0;l<c.length;l++)c[l].start()}},0)}function q(e,t){this.c=e,this.a=t}function W(e,t){this.c=e,this.a=t}function j(e,t){this.c=e||U,this.a=[],this.f=[],this.g=t||""}V.prototype.g=function(e){var t=this.a;t.g&&d(t.f,[t.a.c("wf",e.c,y(e).toString(),"active")],[t.a.c("wf",e.c,y(e).toString(),"loading"),t.a.c("wf",e.c,y(e).toString(),"inactive")]),E(t,"fontactive",e),this.m=!0,G(this)},V.prototype.h=function(e){var t=this.a;if(t.g){var i=c(t.f,t.a.c("wf",e.c,y(e).toString(),"active")),o=[],n=[t.a.c("wf",e.c,y(e).toString(),"loading")];i||o.push(t.a.c("wf",e.c,y(e).toString(),"inactive")),d(t.f,o,n)}E(t,"fontinactive",e),G(this)},F.prototype.load=function(e){this.c=new n(this.j,e.context||this.j),this.f=!1!==e.events,this.a=!1!==e.classes,function(e,t,i){var o=[],n=i.timeout;!function(e){e.g&&d(e.f,[e.a.c("wf","loading")]),E(e,"loading")}(t);var o=function(e,t,i){var o,n=[];for(o in t)if(t.hasOwnProperty(o)){var a=e.c[o];a&&n.push(a(t[o],i))}return n}(e.g,i,e.c),a=new V(e.c,t,n);for(e.h=o.length,t=0,i=o.length;t<i;t++)o[t].load(function(t,i,o){B(e,a,t,i,o)})}(this,new S(this.c,e),e)},q.prototype.load=function(e){var t=this,i=t.a.projectId,o=t.a.version;if(i){var n=t.c.o;u(this.c,(t.a.api||"https://fast.fonts.net/jsapi")+"/"+i+".js"+(o?"?v="+o:""),function(o){o?e([]):(n["__MonotypeConfiguration__"+i]=function(){return t.a},function t(){if(n["__mti_fntLst"+i]){var o,a=n["__mti_fntLst"+i](),r=[];if(a)for(var s=0;s<a.length;s++){var l=a[s].fontfamily;null!=a[s].fontStyle&&null!=a[s].fontWeight?(o=a[s].fontStyle+a[s].fontWeight,r.push(new b(l,o))):r.push(new b(l))}e(r)}else setTimeout(function(){t()},50)}())}).id="__MonotypeAPIScript__"+i}else e([])},W.prototype.load=function(e){var t,i,o=this.a.urls||[],n=this.a.families||[],a=this.a.testStrings||{},r=new g;for(t=0,i=o.length;t<i;t++)h(this.c,o[t],p(r));var s=[];for(t=0,i=n.length;t<i;t++)if((o=n[t].split(":"))[1])for(var l=o[1].split(","),d=0;d<l.length;d+=1)s.push(new b(o[0],l[d]));else s.push(new b(o[0]));m(r,function(){e(s,a)})};var U="https://fonts.googleapis.com/css";function K(e){this.f=e,this.a=[],this.c={}}var Y={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},Z={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},X={i:"i",italic:"i",n:"n",normal:"n"},J=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function Q(e,t){this.c=e,this.a=t}var ee={Arimo:!0,Cousine:!0,Tinos:!0};function te(e,t){this.c=e,this.a=t}Q.prototype.load=function(e){var t=new g,i=this.c,o=new j(this.a.api,this.a.text),n=this.a.families;!function(e,t){for(var i=t.length,o=0;o<i;o++){var n=t[o].split(":");3==n.length&&e.f.push(n.pop());var a="";2==n.length&&""!=n[1]&&(a=":"),e.a.push(n.join(a))}}(o,n);var a=new K(n);!function(e){for(var t=e.f.length,i=0;i<t;i++){var o=e.f[i].split(":"),n=o[0].replace(/\+/g," "),a=["n4"];if(2<=o.length){var r;if(r=[],s=o[1])for(var s,l=(s=s.split(",")).length,d=0;d<l;d++){var c;if((c=s[d]).match(/^[\w-]+$/))if(null==(u=J.exec(c.toLowerCase())))c="";else{if(c=null==(c=u[2])||""==c?"n":X[c],null==(u=u[1])||""==u)u="4";else var h=Z[u],u=h||(isNaN(u)?"4":u.substr(0,1));c=[c,u].join("")}else c="";c&&r.push(c)}0<r.length&&(a=r),3==o.length&&(r=[],0<(o=(o=o[2])?o.split(","):r).length&&(o=Y[o[0]])&&(e.c[n]=o))}for(e.c[n]||(o=Y[n])&&(e.c[n]=o),o=0;o<a.length;o+=1)e.a.push(new b(n,a[o]))}}(a),h(i,function(e){if(0==e.a.length)throw Error("No fonts to load!");if(-1!=e.c.indexOf("kit="))return e.c;for(var t=e.a.length,i=[],o=0;o<t;o++)i.push(e.a[o].replace(/ /g,"+"));return t=e.c+"?family="+i.join("%7C"),0<e.f.length&&(t+="&subset="+e.f.join(",")),0<e.g.length&&(t+="&text="+encodeURIComponent(e.g)),t}(o),p(t)),m(t,function(){e(a.a,a.c,ee)})};var ie=window.__cargo_webfont_api__||"/type/css?family=";function oe(e,t){this.c=e,this.a=t}te.prototype.load=function(e){var t,i,o=this.a.families||[];0<o.length&&(""!==(t=o.join("|"))&&(t=t.replace(/[\. -]+/g,""),h(this.c,ie+t)));var n=[];for(t=0,i=o.length;t<i;t++){var a=o[t].split(":");if(a[1])for(var r=a[1].split(","),s=0;s<r.length;s+=1)n.push(new b(a[0],r[s]));else n.push(new b(a[0]))}e(n)};var ne=window.__persona_webfont_api__||"/type/css?family=";function ae(e,t){this.c=e,this.a=t}function re(e,t){this.c=e,this.f=t,this.a=[]}oe.prototype.load=function(e){var t,i,o=this.a.families||[];0<o.length&&(""!==(t=o.join("|"))&&(t=t.replace(/[\. -]+/g,""),h(this.c,ne+t)));var n=[];for(t=0,i=o.length;t<i;t++){var a=o[t].split(":");if(a[1])for(var r=a[1].split(","),s=0;s<r.length;s+=1)n.push(new b(a[0],r[s]));else n.push(new b(a[0]))}e(n)},ae.prototype.load=function(e){var t=this.a.id,i=this.c.o;t?u(this.c,(this.a.api||"https://use.typekit.net")+"/"+t+".js",function(t){if(t)e([]);else if(i.Typekit&&i.Typekit.config&&i.Typekit.config.fn){t=i.Typekit.config.fn;for(var o=[],n=0;n<t.length;n+=2)for(var a=t[n],r=t[n+1],s=0;s<r.length;s++)o.push(new b(a,r[s]));try{i.Typekit.load({events:!1,classes:!1,async:!0})}catch(e){}e(o)}},2e3):e([])},re.prototype.load=function(e){var t=this.f.id,i=this.c.o,o=this;t?(i.__webfontfontdeckmodule__||(i.__webfontfontdeckmodule__={}),i.__webfontfontdeckmodule__[t]=function(t,i){for(var n=0,a=i.fonts.length;n<a;++n){var r=i.fonts[n];o.a.push(new b(r.name,C("font-weight:"+r.weight+";font-style:"+r.style)))}e(o.a)},u(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function(e){return e.o.location.hostname||e.a.location.hostname}(this.c)+"/"+t+".js",function(t){t&&e([])})):e([])};var se=new F(window);z("custom",function(e,t){return new W(t,e)}),z("Persona",function(e,t){return new oe(t,e)}),z("cargo",function(e,t){return new te(t,e)}),z("fontdeck",function(e,t){return new re(t,e)}),z("monotype",function(e,t){return new q(t,e)}),z("typekit",function(e,t){return new ae(t,e)}),z("google",function(e,t){return new Q(t,e)});var le={load:i(se.load,se)};"function"==typeof define&&define.amd?define(function(){return le}):"undefined"!=typeof module&&module.exports?module.exports=le:(window.WebFont=le,window.WebFontConfig&&se.load(window.WebFontConfig))}();var Cargo={o:{}};Cargo.o.model={},Cargo.o.collection={},Cargo.o.view={},Cargo.Router={},Cargo.Template={},Cargo.Helper={},Cargo.API={},Cargo.Event={},Cargo.Collection={},Cargo.Model={},Cargo.View={};var Action=window.Action||{};function in_array(e,t,i){var o="";if(!!i){for(o in t)if(t[o]===e)return!0}else for(o in t)if(t[o]==e)return!0;return!1}function strip_tags(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return e.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(e,i){return t.indexOf("<"+i.toLowerCase()+">")>-1?e:""})}function closest(e,t){var i=e&&(t(e)?e:closest(e.parentNode,t));return i||null}function ucFirst(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}function lerp(e,t,i){var o=Math.max(Math.min(i,1),0);return(1-o)*e+o*t}Cargo.Core={log:function(e){"undefined"!=typeof console&&window.console&&console.log(e)},KeyboardShortcut:{Add:function(e,t,i){var o={type:"keydown",disable_in_input:!0,propagate:!0,keycode:t};shortcut.add(e,i,o)},Remove:function(e){shortcut.remove(e)},InitDefaults:function(){Cargo.Helper.IsAdminPath()||(this.Add("X",88,function(){lightbox.isActive||Action.Page.Home()}),this.Add("I",73,function(){lightbox.isActive||Action.Page.Home()}),this.Add("J",74,function(){lightbox.isActive||Action.Page.Next()}),this.Add("K",75,function(){lightbox.isActive||Action.Page.Prev()}),this.Add("Right",39,function(){lightbox.isActive||Action.Page.Next()}),this.Add("Left",37,function(){lightbox.isActive||Action.Page.Prev()}),this.Add("R",82,function(){lightbox.isActive||Action.Page.Random()}),this.Add("Shift+G",71,function(){lightbox.isActive||Cargo.Helper.GoToUrl("img")}),this.Add("Meta+/",191,function(e){e.preventDefault(),Action.yepThisIsACargoSite()})),this.Add("Shift+A",65,function(){Cargo.Helper.GoToUrl("admin")});var e=0;mouseY=0,Cargo.Model.DisplayOptions.get("layout_options").is_feed&&window.addEventListener("mousemove",function(t){e=t.clientX,mouseY=t.clientY}),Cargo.Core.loadAdminForActivePage=function(){if(parent.location==window.location)if(Cargo.Model.Site.GetIsEditor()){var t,i,o,n,a,r,s=Cargo.View.Content.el.querySelectorAll(".page.container[data-id]"),l=window.innerHeight/2,d=9e9;_.each(s,function(e){e.style.minHeight="1px"}),_.each(s,function(n){(a=n.getBoundingClientRect()).top<mouseY&&a.bottom>mouseY&&a.left<e&&a.right>e&&(i=n),a.top<l&&a.bottom>l?(t=n,d=0):d>0&&(a.top>l?o=Math.abs(l-a.top):a.bottom<l&&(o=Math.abs(l-a.bottom)),o<d&&(t=n,d=o))}),_.each(s,function(e){e.style.minHeight=""}),(t||i)&&(i?r=parseInt(i.getAttribute("data-id")):t&&(r=parseInt(t.getAttribute("data-id"))),n=Cargo.Collection.Scaffolding.getModel({id:r})),!n&&Cargo.View.Content.currentSet&&(n=Cargo.View.Content.currentSet.model),n&&!n.get("pin")?((n.get("stack")||n.get("is_set"))&&n.get("pages")&&n.get("pages").length>0&&(n=n.get("pages").models[0]),Cargo.Helper.GoToUrl("admin/"+n.id)):Cargo.Helper.GoToUrl("admin")}else Cargo.Helper.GoToUrl("admin")},this.Add("Shift+E",69,Cargo.Core.loadAdminForActivePage),this.Add("Shift+H",72,function(){Cargo.Helper.GoToUrl("admin/design/html")}),this.Add("Shift+C",67,function(){Cargo.Helper.GoToUrl("admin/design/css")}),this.Add("Shift+I",73,function(){Cargo.Helper.GoToUrl("admin/design/css")}),this.Add("Shift+D",68,function(){Cargo.Helper.GoToUrl("admin/design")}),this.Add("Shift+X",88,function(){Cargo.Helper.GoToUrl("")}),this.Add("Esc",27,function(){Cargo.Helper.IsAdminPath()||(Cargo.View.Following.isActive()&&!Cargo.Modal.isActive()?Cargo.View.Following.followingOverlay.classList.contains("prevent-close")||Cargo.View.Following.Toggle():Cargo.View.SiteMenu.isActive()?Cargo.View.SiteMenu.hide(!0):lightbox.isActive||Action.Page.Home())})}},InitKeycodeListener:function(){var e=_.bind(function(e){e.shiftKey||(83==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&(e.preventDefault(),Cargo.Event.trigger("save_shortcut_triggered",e),Cargo.contentWindow||window.top.Cargo.Event.trigger("save_shortcut_triggered",e)),13==e.keyCode&&Cargo.Event.trigger("enter_keycode_triggered",e),27==e.keyCode&&Cargo.Event.trigger("esc_keycode_triggered",e))},this);document.addEventListener("keydown",e,!1)},InitMessageListener:function(){window.addEventListener("message",function(e){"object"==typeof e.data&&"retrieve-newsletter-html"===e.data.type&&e.data.pid&&Cargo.View.Content.retrieveActivePageViewForPID(e.data.pid,_.bind(function(t){t&&setTimeout(function(){var i="https://weekly.cargo.site/w/",o=t.el.querySelector(".page_content");_.each(o.querySelectorAll("a[href]"),function(t){t.setAttribute("href",i+e.data.newsLetterID+"/[email-id]/click?l="+t.href)}),_.each(o.querySelectorAll("img"),function(e){var t=e.getAttribute("src"),i=e.offsetWidth,o=e.offsetHeight;for(e.hasAttribute("data-lazy-src")&&(t=e.getAttribute("data-lazy-src"));e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);e.setAttribute("src",t),e.setAttribute("width",i),e.setAttribute("height",o)});var n=document.createElement("a"),a=document.createElement("img");n.href=i+e.data.newsLetterID+"/[email-id]/unsubscribe",n.className="unsubscribe-link",n.innerHTML="Unsubscribe",a.src=i+e.data.newsLetterID+"/[email-id]/open.gif",a.width=1,a.height=1,a.style.visibility="hidden",a.className="tracking_pixel",o.appendChild(n),o.insertBefore(a,o.firstChild),parent.postMessage({type:"retrieve-newsletter-html-response",html:o.outerHTML,css:t.getLocalCSSElement().innerHTML.trim()},"*")},1e3)},this))},!1)},ReseedThumbnailCollection:function(){Cargo.Event.trigger("thumbnails:clear_cache"),Cargo.Collection.GlobalThumbnails.fetch({params:Cargo.Collection.GlobalThumbnails.currentParams,from_thumbnail_reseed:!0,reset:!0,merge:!0,success:function(){Cargo.View.Thumbnail.checkAndLoadThumbnails(Cargo.Helper.GetCurrentProjectId()),Cargo.Event.trigger("reseed_thumbnails_complete")}})}},Cargo.o.analytics=Backbone.View.extend({Config:{name:"__cargo_analytics"},initialize:function(){this.enabled=!0!==Cargo.Model.DisplayOptions.get("analytics_disabled"),this.enabled&&void 0===Cargo.Homepage&&!Cargo.Helper.IsAdminPath()&&(Cargo.API.Config.is_domain&&(this.Config.custom_url="/"+document.location.host),"undefined"!=typeof ga&&"undefined"!=typeof gaData&&ga("create",Object.keys(gaData)[0],"auto",{name:this.Config.name,cookieName:this.Config.name}),this.pageview(!1))},setDimension:function(e,t){this.enabled&&ga(this.Config.name+".set",e,t)},pageview:function(e,t){if("undefined"!=typeof ga){var i=this.Config.name,o=document.location.pathname.replace(/\/$/,"");if(this.enabled){if(void 0!==t&&!e)return void ga(this.Config.name+".send","pageview",{page:t,dimension3:"Cargo 2"});void 0!==this.Config.custom_url?ga(this.Config.name+".send","pageview",{page:this.Config.custom_url+o,dimension3:"Cargo 2"}):ga(this.Config.name+".send","pageview",{dimension3:"Cargo 2"})}"function"==typeof ga&&e&&(ga(function(){ga.getAll().map(function(e){var t=e.get("name");t!=i&&ga(t+".send","pageview",{page:o})})}),"undefined"!=typeof _gaq&&_gaq.push(["_trackPageview",o]))}},trackevent:function(e,t){if(void 0===Cargo.Homepage&&!Cargo.Helper.IsAdminPath()||"undefined"==typeof gtag)return!1;var i="",o="general";switch(e){case"signup_template":i="AW-671640766/EuJWCIvy578BEL7ZocAC",value=10,o="template";break;case"year_upgrade":i="AW-671640766/ms82CIDJ7r8BEL7ZocAC",value=99,o="upgrade";break;case"month_upgrade":i="AW-671640766/9bmQCKTencABEL7ZocAC",value=13,o="upgrade";break;case"domain_purchase":i="AW-671640766/jSPLCJ3fp8ABEL7ZocAC",value=t,o="domain";break;case"homepage_domain_lead":i="AW-671640766/JBfcCIuCksIBEL7ZocAC",value=1,o="domain";break;case"promo_code":i="AW-671640766/gmgRCOGLgsIBEL7ZocAC",value=1,o="upgrade";break;case"template_click":o="template";break;case"transfer_upgrade":o="upgrade"}return""!=i&&(gtag("event","conversion",{send_to:i,value:value,currency:"USD",transaction_id:""}),console.log("EVENT: conversion",{send_to:i,value:value,currency:"USD",transaction_id:""})),gtag("event",e,{event_category:o,event_label:t}),console.log("EVENT:",e,{event_category:o,event_label:t}),!1}}),Cargo.o.api=Backbone.View.extend({Config:{Version:"v0",api_path:"/_api",cargo_id:"",cargo_url:"",filter:"",search_term:"",route_name:"",current_offset:0,current_page:1,is_filter:!1,is_search:!1,is_editor:!1,is_template:!1,is_solo:!1,is_direct_link:!1,is_custom_route:!1,admin_edit_project:!1,first_load_finished:!1,tags:null},initialize:function(){_.extend(this.Config,$.parseJSON($("script[data-set='defaults']").html()))},fetch:function(e,t){$.getJSON(e,t)},GetBasePath:function(e){var t=this.Config;return"string"!=typeof e&&(e=t.Version),t.api_path+"/"+e},GetSitePath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/site/"+e.cargo_url},GetDesignPath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/design/"+e.cargo_url},GetTemplatesPath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/templates"},GetDesignFile:function(e){return this.GetDesignPath()+"?file="+e},GetTemplatePath:function(){var e=this.Config,t=e.route_name?e.route_name+"/":"";return this.GetDesignFile(t)},GetFilesPath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/files"},GetDesignAndFile:function(e,t){var i=this.GetTemplatePath()+e;return t&&(i+="&to_var=true"),i},GetDisplayOptionsPath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/displayoptions/"+e.cargo_url},GetImagesPath:function(e,t,i){e=e||"newest",t=t||"true",i=i||"false";var o=this.GetSitePath()+"/images";return o+="?sort="+e+"&unique="+t+"&projectsonly="+i},GetPluginsPath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/backdrops"},GetPagesPath:function(e,t,i){var o=this.GetSitePath()+"/pages";if(void 0!==e||void 0!==t||void 0!==i){"string"==typeof e&&(e=e.replace(/\ /g,"-")),o+="?";var n=new Array;void 0!==e&&n.push("tags="+e),void 0!==t&&n.push("offset="+t),void 0!==i&&n.push("limit="+i),o+=n.join("&")}return o},GetContentCollectionPath:function(e){var t=this.GetSitePath()+"/content";return e&&(t+="?tags="+e),t},GetAdminListPath:function(e,t){return e=e||this.Config.current_offset,t=t||Cargo.Helper.GetPageLimit(),this.GetSitePath()+"/admincollection"},GetSinglePagePath:function(e){var t=this.Config,i=t.api_path+"/"+t.Version+"/page";return e&&void 0!==e&&(i+="/"+e),i},GetSingleContentPath:function(e){var t=this.GetContentCollectionPath();return e?t+"/"+e:t},GetSingleStackPath:function(e){return this.GetSitePath()+"/stack/"+e},GetSiteFilesPutPath:function(){return"/dispatch/files/putFile"},GetDataPackage:function(e,t){var i={site:Cargo.Model.Site.toJSON(),display_options:Cargo.Model.DisplayOptions.toJSON(),config:this.Config};return i[e]=t,i},GetThumbnailsPath:function(e,t,i,o,n,a,r){var s=this.Config,l=s.api_path+"/"+s.Version+"/thumbnails/"+s.cargo_url;if(void 0!==e||void 0!==i||void 0!==o||void 0!==n||void 0!==a||void 0!==r||void 0!==t){"string"==typeof i&&(i=i.replace(/\ /g,"-")),l+="?";var d=new Array;void 0!==e&&d.push("page_id="+e),void 0!==t&&d.push("all=true"),void 0!==i&&d.push("tags="+i),void 0!==o&&d.push("set_id="+o),void 0!==n&&d.push("offset="+n),void 0!==r?(d.push("random_limit="+r),d.push("random=true")):void 0!==a&&d.push("limit="+a),l+=d.join("&")}return l},GetThumbnailModesPath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/thumbnailsettings/modes"},GetAllThumbnailSettingsPath:function(e,t,i){var o=this.Config,n=o.api_path+"/"+o.Version+"/thumbnailsettings/"+o.cargo_url+"/all";if(e||i||t){n+="?";var a=new Array;e&&a.push("page_id="+e),i&&a.push("iterator="+i),t&&a.push("mode_id="+t),n+=a.join("&")}return n},GetActiveThumbnailSettingsPath:function(e,t,i,o){var n=this.Config,a=n.api_path+"/"+n.Version+"/thumbnailsettings/"+n.cargo_url+"/single";if(o&&(a+="/"+o),e||i||t){a+="?";var r=new Array;e&&r.push("page_id="+e),i&&r.push("iterator="+i),t&&r.push("mode_id="+t),a+=r.join("&")}return a},PutSiteFile:function(e,t,i){$.ajax({type:"POST",url:this.GetSiteFilesPutPath(),context:this,data:{file:e,data:t,uid:Cargo.Model.Site.GetId()},dataType:"json",success:function(e){"function"==typeof i&&i.call(this,e)},error:function(e){}})}}),Action={Page:{Home:function(e){Cargo.View.Main.ShowHome(void 0,e)},Next:function(){Cargo.View.Main.NextPage()},Prev:function(){Cargo.View.Main.PrevPage()},Random:function(){Cargo.View.Main.RandomPage()}},yepThisIsACargoSite:function(){var e=new Image;e.onload=function(){var e=document.createElement("div");e.style.top="20%",e.style.width="100%",e.style.height="60%",e.style.zIndex="999",e.style.position="fixed",e.style.background='url("/assets/bolt.gif") center center / contain no-repeat',setTimeout(function(){e.style.transition="opacity 500ms",setTimeout(function(){e.parentNode.removeChild(e),e=null},700),setTimeout(function(){e.style.opacity="0"})},1e3),document.body.appendChild(e)},e.src="/assets/bolt.gif"},Start:function(e){$("[data-example-start]").html('<div class="loading_animation pulsing white inline right"><div></div></div>'),Cargo.API.Config.cookie_link&&Cargo.API.Config.cookie_site_count>0?Cargo.Modal.Alert({message:"<em>You’re already logged in; you can create new Sites in your Settings panel.</em>",confirm:function(){top.document.location.href=Cargo.API.Config.cookie_link+"/admin"}}):require(["/_jsapps/admin/_models/adminsite.js"],function(t){var i=new t;i.bind("sync",function(e,t){document.location.href=t.redirect}),i.bind("error",function(e,t){var i=JSON.parse(t.responseText);i&&i.message?Cargo.Modal.Alert({message:i.message,confirm:function(){i.data.redirect&&(document.location.href=i.data.redirect)}}):Cargo.Modal.Alert({message:"There was a problem submitting. Refresh and try again."}),$("[data-example-start]").html("Choose Style")}),e=e||Cargo.Model.Site.GetId(),i.set({template_id:e}),i.save()})}},Cargo.Event=Cargo.Event||{},_.extend(Cargo.Event,Backbone.Events),Cargo.Event.on("add_history",function(e,t){Cargo.Router.is_first_route=!1,(e=Cargo.Helper.NormalizeRouteLink(e))!==Cargo.Helper.GetCurrentProjectUrl()?(Cargo.Helper.IsCurrentRoute(e)?Cargo.Model.DisplayOptions.GetDisableProjectScroll()||Cargo.Helper.ScrollToTop():(t=t||Cargo.Helper.GetPidFromPurl(e),"admin"==e||/^following/.test(e)||/^cart/.test(e)||Cargo.Helper.ShowLoadingAnimation(t,e)),(!/^following/.test(Cargo.Router.previousRoute)&&!/^following/.test(Backbone.history.getFragment())&&/^following/.test(e)||!/^contact-form/.test(Cargo.Router.previousRoute)&&!/^contact-form/.test(Backbone.history.getFragment())&&/^contact-form/.test(e)||!/^cart(\/+(.*))*$/.test(Cargo.Router.previousRoute)&&!/^cart(\/+(.*))*$/.test(Backbone.history.getFragment())&&/^cart(\/+(.*))*$/.test(e))&&(Cargo.Router.previousSiteRoute=Backbone.history.getFragment()),Cargo.Router.previousRoute=Backbone.history.getFragment(),Cargo.Router.navigate(e,{trigger:!0})):Cargo.Model.DisplayOptions.GetDisableProjectScroll()||Cargo.Helper.ScrollToTop()}),Cargo.Event.on("add_history_passive",function(e){e=Cargo.Helper.NormalizeRouteLink(e),Cargo.Router.navigate(e,{trigger:!1,replace:!0})}),Cargo.Event.on("admin_page_update",function(e,t){}),Cargo.Event.on("BaseUnit:set",function(e){var t=Cargo.Helper.IsMobileWindowSize(e.cache.window.w);Cargo.Event.trigger("mobile_size",t)}),Cargo.Event.on("custom_route_loaded",function(e){}),Cargo.Event.on("content_view_closed",function(){}),Cargo.Event.on("first_page_collection_reset",function(){Cargo.API.Config.first_load_finished=!0}),Cargo.Event.on("hide_loading_anim",function(){"object"==typeof Cargo.Helper&&Cargo.Helper.HideLoadingAnimation&&Cargo.Helper.HideLoadingAnimation()}),Cargo.Event.on("homepage_loaded",function(){Cargo.Model.DisplayOptions.GetDisableProjectScroll()||Cargo.Helper.ScrollToTop(),Cargo.View.Main&&(Cargo.View.Main.SetHomepageClass(),Cargo.View.Main.SetFeedClass())}),Cargo.Event.on("loading_anims_replaced",function(){}),Cargo.Event.on("mobile_size",function(e){}),Cargo.Event.on("mobile_padding_set",function(){}),Cargo.Event.on("plugin_render",function(e){e.el.style.opacity=0,e.el.style.transition="opacity .5s ease-in-out",e.el.style.webkitTransition="opacity .5s ease-in-out",void 0===e.deferredLoadEventName?setTimeout(function(){e.el.style.opacity=1},33):Cargo.Event.once(e.deferredLoadEventName,function(){e.el.style.opacity=1})}),Cargo.Event.on("page_change",function(){}),Cargo.Event.on("page_collection_reset",function(){}),Cargo.Event.on("page_load_complete",function(e){Cargo.Event.PageTransition=new $.Deferred,Cargo.View.Main&&!Cargo.Helper.IsOnHomepage()?(Cargo.View.Main.RemoveHomepageClass(),Cargo.View.Main.RemoveFeedClass()):null!==Cargo.View.Content.activeContentModel&&Cargo.View.Content.activeContentModel.get("id")!==Cargo.Helper.GetHomepageId()&&(Cargo.View.Main.RemoveHomepageClass(),Cargo.View.Main.RemoveFeedClass()),Cargo.Helper.HideLoadingAnimation(),Cargo.View.Main.SetWindowTitle(),Cargo.Event.trigger("project_load_complete",e)}),Cargo.Event.on("content_load_complete",function(e){Cargo.View.Main&&!Cargo.Helper.IsOnHomepage()?Cargo.View.Main.RemoveHomepageClass():null!==Cargo.View.Content.activeContentModel&&Cargo.View.Content.activeContentModel.get("id")!==Cargo.Helper.GetHomepageId()&&Cargo.View.Main.RemoveHomepageClass(),Cargo.Model.DisplayOptions.GetDisableProjectScroll()||Cargo.Helper.ScrollToTop(),Cargo.View.Main.SetPageId(e),Cargo.API.Config.is_direct_link||Cargo.Helper.IsOnHomepage()||Cargo.Analytics.pageview(!0),Cargo.Helper.HideLoadingAnimation()}),Cargo.Event.on("set_render_complete",function(e){}),Cargo.Event.on("image_gallery_init_complete",function(e){}),Cargo.Event.on("image_gallery_render_complete",function(e){}),Cargo.Event.on("image_upload_complete",function(e){}),Cargo.Event.on("image_delete_complete",function(e){}),Cargo.Event.on("pagination_complete",function(e,t,i){i&&i.render_changes&&($(window).trigger("resize"),Cargo.Plugins.elementResizer.update())}),Cargo.Event.on("page_load_start",function(e){Cargo.Event.trigger("page_change")}),Cargo.Event.on("project_load_start",function(e){Cargo.Event.trigger("page_load_start",e)}),Cargo.Event.on("reseed_pages_complete",function(e){}),Cargo.Event.on("show_index_complete",function(e){Cargo.View.Main.SetWindowTitle(!0),Cargo.Event.IndexTransition=new $.Deferred}),Cargo.Event.on("show_index_start",function(e){Cargo.Event.trigger("page_change")}),Cargo.Event.on("show_loading_anim",function(){Cargo.Helper.ShowLoadingAnimation(null,"page")}),Cargo.Event.on("solo_link_loaded",function(e){}),Cargo.Event.on("template_loaded",function(e){}),Cargo.Event.PageTransition=new $.Deferred,Cargo.Event.IndexTransition=new $.Deferred,Cargo.Event.ShowPageTransition=function(e,t,i){return Cargo.Event.PageTransition.resolve(),Cargo.Event.PageTransition.promise()},Cargo.Event.ShowIndexTransition=function(e,t){return Cargo.Event.IndexTransition.resolve(),Cargo.Event.IndexTransition.promise()},window.addEventListener("popstate",function(){"object"==typeof lightbox&&void 0!==lightbox.activeGallery&&lightbox.activeGallery.close()}),Cargo.o.helpers=Backbone.View.extend({Data:{is_loading:!1,loading_timout:1e3,projectlist_volatile:!1},initialize:function(){Cargo.Event.on("adminlist_volatile",function(){this.Data.projectlist_volatile=!0},this),Cargo.Event.on("adminlist_stable",function(){this.Data.projectlist_volatile=!1},this)},FindCollectionByProjectUrl:function(e){var t=!1;return _.each(Cargo.Collection.Page,function(i){if(!t){var o=new Backbone.Collection;o.reset(i),o.where({project_url:e})[0]&&(t=i)}}),t},GetBackboneCaseInsensitive:function(e,t){var i={};for(var o in e)!e.hasOwnProperty(o)||"function"!=typeof e[o]&&"object"!=typeof e[o]||(i[o.toLowerCase()]=o);return t?i[t.toLowerCase()]:""},GetBaseUrl:function(e,t){if(Cargo.API.Config.is_domain)return t?"/":"";var i=e?Cargo.API.Config.cargo_url:"";return t?"/"+i:i},IsAdminProjectListSorting:function(){return this.Data.projectlist_volatile},GetBaseCargoDomain:function(){var e=Cargo.Model.Site.get("home_url");return e?e.replace(/(http(s)?:\/\/)/,""):document.location.host},GetAuthDomain:function(){var e=Cargo.Model.Site.get("auth_url");return e||"//"+document.location.host},GetBaseDomain:function(){return Cargo.Model.Site.get("home_url").replace(/(http(s)?:\/\/)/,"")},IsIndexableModel:function(e){return!(!e||"set"!==e.attributes.type)||!!e&&!(!1===e.attributes.display||e.attributes.pin||e.attributes.is_homepage&&!e.attributes.is_set)},GetCurrentProjectUrl:function(){var e=Cargo.View.Content.getActiveContentModel();return e?e.get("project_url"):null},GetCurrentProjectId:function(){if(void 0===Cargo.View.Content)return null;var e=Cargo.View.Content.getActiveContentModel();return e?e.get("id"):null},GetCurrentRoute:function(){return Backbone.history.fragment},GetDomainOrUrl:function(){return Cargo.API.Config.is_domain?this.GetUrl():location.pathname.split("/")[1]},GetHomeUrl:function(e,t){var i=t?"/":"";return Cargo.API.Config.set&&Cargo.API.Config.filter?Cargo.API.Config.is_domain?i+Cargo.API.Config.set+"/filter/"+encodeURIComponent(Cargo.API.Config.filter):this.GetBaseUrl(e,t)+"/"+Cargo.API.Config.set+"/filter/"+encodeURIComponent(Cargo.API.Config.filter):Cargo.API.Config.route&&Cargo.API.Config.filter?Cargo.API.Config.is_domain?Cargo.Helper.GetRouteUrl()+"/filter/"+encodeURIComponent(Cargo.API.Config.filter):this.GetBaseUrl(e,!1)+Cargo.Helper.GetRouteUrl()+"/filter/"+encodeURIComponent(Cargo.API.Config.filter):Cargo.API.Config.filter?Cargo.API.Config.is_domain?i+"filter/"+encodeURIComponent(Cargo.API.Config.filter):this.GetBaseUrl(e,t)+"/filter/"+encodeURIComponent(Cargo.API.Config.filter):Cargo.API.Config.set?Cargo.API.Config.is_domain?i+Cargo.API.Config.set:this.GetBaseUrl(e,t)+"/"+Cargo.API.Config.set:Cargo.API.Config.route&&Cargo.API.Config.is_domain?Cargo.Helper.GetRouteUrl():this.GetBaseUrl(e,t)},GetOffsetFromPage:function(e){return--e*this.GetPageLimit()},GetPageLimit:function(){var e=Cargo.Model.DisplayOptions.GetPaginationCount();return e&&Cargo.Model.DisplayOptions.GetIndexRouteName()&&Cargo.Model.DisplayOptions.GetIndexRouteName().toUpperCase()==Cargo.Helper.GetRouteName().toUpperCase()&&Cargo.Model.DisplayOptions.get("index_pagination_count")?e=Cargo.Model.DisplayOptions.get("index_pagination_count"):Cargo.Model.DisplayOptions.get("mobile_pagination_count")&&this.isMobile()&&(e=Cargo.Model.DisplayOptions.get("mobile_pagination_count")),e||10},IsMobileWindowSize:function(e){return e<this.GetMobileWindowBreakPoint()},GetMobileWindowBreakPoint:function(e){return 770},GetPageViewById:function(e){var t;return void 0===t&&Cargo.View.Content&&(t=Cargo.View.Content.getPageViewById(e)),void 0===t&&Cargo.View.PinnedTop&&(t=Cargo.View.PinnedTop.getPageViewById(e)),void 0===t&&Cargo.View.PinnedBottom&&(t=Cargo.View.PinnedBottom.getPageViewById(e)),t},GetPidFromPurl:function(e){var t=Cargo.Collection.Scaffolding.getModel({project_url:e});return t?t.get("id"):0},GetRouteName:function(){var e=Cargo.API.Config.route_name;return/display_options/.test(Cargo.API.Config.route)&&(e=Cargo.Model.DisplayOptions.GetIndexRouteName()),e},GetRouteUrl:function(){var e=Cargo.API.Config.route_name;return(/display_options/.test(Cargo.API.Config.route)||"feed"==e||"index"==e)&&(e=Cargo.Model.DisplayOptions.GetIndexRouteUrl()),e},GetHomepageId:function(){return Math.floor(Cargo.Model.Site.GetHomepageId())},GetUrl:function(){return Cargo.API.Config.cargo_url},GoToUrl:function(e){top.document.location.href=document.location.origin+"/"+e},HideLoadingAnimation:function(e){this.ClearLoadingAnimationTimeout(),this.Data.is_loading=!1,$("[data-loading]").hide()},IsAdminEdit:function(){var e=/\/adminedit/.test(document.location.pathname)||/\/admin/.test(document.location.pathname);try{var t=parent!=window&&"object"==typeof parent.Cargo,i=null!=Cargo.Editor;return e||t||i}catch(e){return!1}},IsAdminBackdrop:function(){return/\/adminbackdrop/.test(document.location.pathname)},IsStandaloneAdmin:function(){return!!(Cargo&&Cargo.Editor&&Cargo.Editor.hasOwnProperty("Standalone"))},IsCurrentRoute:function(e){return e=this.NormalizeRouteLink(e),Cargo.Helper.GetCurrentRoute()==e},isFeed:function(){return Cargo.Model.DisplayOptions.get("layout_options").is_feed},isFirefox:function(){return/Firefox\/\d+\.\d+/.test(navigator.userAgent)},isSafari:function(){return-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")},isIE:function(){return/MSIE (\d+\.\d+);/.test(navigator.userAgent)},isEdge:function(){return/Edge/.test(navigator.userAgent)},isIE8:function(){var e=-1;this.isIE()&&(null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)&&(e=parseFloat(RegExp.$1)));return e<9&&e>0},isIOS:function(){return!!navigator.userAgent.match(/i(Phone|Pod|Pad)/i)},isMobile:function(){if(this.isIOS())return!0;var e,t=!1,i=navigator.userAgent||navigator.vendor||window.opera;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e=i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t=t||!t&&/(android)/i.test(i.substr(0,40))},isIOSWebView:function(){var e=window.navigator.standalone,t=window.navigator.userAgent.toLowerCase(),i=/safari/.test(t);if(/iphone|ipod|ipad/.test(t)){if(!e&&i)return!1;if(e&&!i)return!1;if(!e&&!i)return!0}return!1},IsOnHomepage:function(){return(""==Cargo.Helper.GetCurrentRoute()||"adminedit"==Cargo.Helper.GetCurrentRoute())&&null!=Cargo.Helper.GetHomepageId()},isOldIE:function(){var e=-1;this.isIE()&&(null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)&&(e=parseFloat(RegExp.$1)));return e<=9&&e>0},IsAdminPath:function(){return/\/admin(\/|$)/.test(document.location.pathname)},IsPresetPreview:function(){return/\/presetpreview(\/|$)/.test(document.location.pathname)},IsCurrentRoute:function(e){return e=e.replace("/",""),this.GetCurrentRoute()&&e&&this.GetCurrentRoute().toLowerCase()==e.toLowerCase()},isTablet:function(){return"string"==typeof new MobileDetect(window.navigator.userAgent).tablet()},NormalizeRouteLink:function(e){if(!e)return e;-1!==e.indexOf(Cargo.Helper.GetBaseDomain())&&(e=e.split(Cargo.Helper.GetBaseDomain())[1]),"/"==e.charAt(0)&&(e=e.replace("/","")),!/following/.test(e)&&this.GetHomeUrl(!0)&&0==e.search(this.GetHomeUrl(!0))&&(e=e.replace(this.GetHomeUrl(!0)+"/","")),"/"==e.charAt(e.length-1)&&(e=e.substr(0,e.length-1));var t=Cargo.Collection.Scaffolding.getModel({project_url:e});return void 0!==t&&t.get("id")==Cargo.Helper.GetHomepageId()&&(e=""),e},ScrollToTop:function(){var e=Cargo.Router.scrollPositions[Backbone.history.getFragment()];requestAnimationFrame(function(){window.scrollTo(0,e)})},ShowLoadingAnimation:function(e,t){this.Data.is_loading=!0,e?this.Data.loadingAnimationTimeoutID=_.delay(function(){Cargo.Helper.ShowLoadingAnimationById(e)},Cargo.Helper.Data.loading_timout):t&&(this.Data.loadingAnimationTimeoutID=_.delay(function(){Cargo.Helper.ShowLoadingAnimationById("page")},Cargo.Helper.Data.loading_timout)),$("*[data-loading=global], *[data-loading=global] .retinaSpinner").show()},ClearLoadingAnimationTimeout:function(){window.clearTimeout(this.Data.loadingAnimationTimeoutID)},ShowLoadingAnimationById:function(e){this.Data.is_loading&&$("*[data-loading="+e+"], *[data-loading="+e+"] .retinaSpinner").show()},TestUrlCaseAndRedirect:function(){if(!Cargo.API.Config.is_domain){var e=document.location.pathname.split("/")[1],t=Cargo.API.Config.cargo_url;e!=t&&e.toUpperCase()==t.toUpperCase()&&history.replaceState(document.location.pathname.replace(e,t),Cargo.Model.Site.GetWebsiteTitle())}},UpdatePinPages:function(e){"top"==e?Cargo.View.PinnedTop.formatOverlayPages():"bottom"==e?Cargo.View.PinnedBottom.formatOverlayPages():(Cargo.View.PinnedTop.formatOverlayPages(),Cargo.View.PinnedBottom.formatOverlayPages())},htmlDecode:function(e){var t=document.createElement("div");return t.innerHTML=e,0===t.childNodes.length?"":t.childNodes[0].nodeValue}}),Cargo.o.router=Backbone.Router.extend({routes:{"":"Home",adminedit:"Home","cart(/:one)(/:two)(/)":"Cart","contact-form":"Contact","preview/:which":"Home","search/:query":"Search",":purl/adminedit":"AdminEdit",":purl":"slashProxy",":purl1/:purl2":"slashProxy",":purl1/:purl2/:purl3":"slashProxy","*actions":"defaultAction"},is_first_route:!0,executed_first_route:!1,defaultAction:function(e){this.route(e)},preventQueryStringRemoval:!1,initialize:function(){document.location.search&&"?example=true"!=document.location.search&&(this.handleQueryString(document.location.search),this.preventQueryStringRemoval||window.history.replaceState({},document.title,document.location.href.replace(document.location.search,""))),this._lastFrag=null,this.scrollPositions={}},handleQueryString:function(e){if("string"==typeof e){var t=["fontsinuse","wetransfer","wepresent","sightunseen","carbon","NYABF2018"],i=t.indexOf(e.substring(1));-1!==i&&setTimeout(function(){Cargo.Analytics.setDimension("dimension5",t[i])}),this.queryString=e}},execute:function(e,t,i){this.is_first_route||(this.executed_first_route=!0),null!==this._lastFrag&&document.scrollingElement&&(this.scrollPositions[this._lastFrag]=document.scrollingElement.scrollTop),this._lastFrag=Backbone.history.getFragment(),Backbone.Router.prototype.execute.apply(this,arguments)},navigate:function(e){this.scrollPositions.hasOwnProperty(e)&&delete this.scrollPositions[e],Backbone.Router.prototype.navigate.apply(this,arguments)},slashProxy:function(e,t,i){if(this.RouteIsHome(e))this.Home(e);else if(/\,|\~|\+/.test(e)&&!/\?/.test(e))Cargo.Event.trigger("thumbnails:load_tag",e),t?this.Page(t):Cargo.View.Content.hideActiveView();else if(/\,|\~\+/.test(t)){Cargo.Event.trigger("thumbnails:load_tag",t,e);var o=i||e;this.Page(o)}else if(e&&t&&!i){var n=Cargo.Collection.Tags.findTagByUrl(e),a=Cargo.Collection.Tags.findTagByUrl(t);n?(Cargo.Event.trigger("thumbnails:load_tag",n.get("url")),this.Page(t)):a&&(Cargo.Event.trigger("thumbnails:load_tag",a.get("url"),e),Cargo.View.Content.hideActiveView())}else this.Page(e)},Home:function(e){this.CheckToggleFollowing(),e||(e=""),Cargo.Event.trigger("before_purl_render",e),0!==Cargo.Helper.GetHomepageId()||Cargo.Helper.isFeed()?(Cargo.View.Content.RenderHomepage(),Cargo.View.Main&&(Cargo.View.Main.SetHomepageClass(),Cargo.View.Main.SetFeedClass())):Cargo.API.Config.offline?(Cargo.Event.trigger("page_load_complete"),Cargo.Event.trigger("content_load_complete")):(Cargo.View.Content.hideActiveView(),Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId()))},Contact:function(){Cargo.View.Following.loadSection("contact")},Cart:function(){Cargo.View.Following.loadSection(Backbone.history.getFragment(),!0)},Page:function(e){Cargo.Event.trigger("before_purl_render",e),this.CheckToggleFollowing(),e=(e+="").replace(/\//g,""),Cargo.View.Content.RenderPidOrPurl(e)},Search:function(e){this.Home()},AdminEdit:function(e){return this.CheckToggleFollowing(),Cargo.API.Config.admin_edit_project=!0,this.Page(e)},CheckToggleFollowing:function(){!0===Cargo.View.Following.isActive()&&Cargo.View.Following.disable()},_routeToRegExp:function(e){return e=e.replace(/[-{}[\]+?.,\\^$|#\s]/g,"\\$&").replace(/\((.*?)\)/g,"(?:$1)?").replace(/:\w+/g,"([^/]+/?)").replace(/\*\w+/g,"(.*?)"),new RegExp("^"+e+"$","i")},addroute:function(e,t,i){for(var o=["","/","?*querystring","/?*querystring"],n=0;n<o.length;n++){var a=o[n];this.route(e+a,t,i)}},RouteIsHome:function(e){var t=!1;return Cargo.API.Config.is_domain||e.toLowerCase()!=Cargo.Helper.GetDomainOrUrl().toLowerCase()||document.location.pathname.replace("/").split("/").length<=1&&(t=!0),t}}),Cargo.o.templates=Backbone.View.extend({Data:{},Get:function(e,t){var i=Cargo.Helper.GetBackboneCaseInsensitive(this.Data,e);if(i=i||e,this.Data[i]&&this.Data[i].template)return this.Data[i].template;this.Load(i,t)},Add:function(e,t,i){Cargo.Template.Data[e]={dataset:t,setname:i}},FindAndAddViewStubs:function(){$("[data-view]").each(function(){var e=$(this).data("view"),t=$(this).data("set"),i=new Backbone.Collection;if(t){var o=Cargo.Helper.GetBackboneCaseInsensitive(Cargo.Collection,t),n=Cargo.Helper.GetBackboneCaseInsensitive(Cargo.Model,t);o?i=Cargo.Collection[o]:n&&(i=Cargo.Model[n])}Cargo.Template.Add(e,i,t)})},Load:function(which,file_path){if(!file_path){var file_name=which;file_path=Cargo.API.GetDesignAndFile(file_name,!1)}Cargo.Template.Data[which]&&Cargo.Template.Data[which].loading||(Cargo.Template.Data[which]||(Cargo.Template.Data[which]={}),Cargo.Template.Data[which].loading=!0,Cargo.Event.trigger("template_preload",which),$.loadFiles(file_path).done(function(template){if(template){try{var template=eval(template)}catch(e){}Cargo.Template.Data[which].template=template}else{var template_var="templatesdesign"+file_name.replace(/(\/|\.)/g,"");Cargo.Template.Data[which].template=window[template_var]}return Cargo.Event.trigger("template_loaded",which),Cargo.Template.Data[which].template}))},LoadAll:function(){for(key in this.Data)void 0===this.Data[key].template&&this.Load(key)},LoadFoundViews:function(){for(key in this.Data){var e=0==key.indexOf("pinned")?"Pin":key,t=Cargo.Helper.GetBackboneCaseInsensitive(Cargo.o.view,e);if("function"==typeof Cargo.o.view[t]&&void 0===Cargo.View[t]){var i=0==key.indexOf("pinned")?key.toCamel(!0):t.toCamel(!0);if(void 0===Cargo.View[i]){var o=this;$("[data-view='"+key+"']").each(function(e){i=e>0?t+"_"+e:i,Cargo.View[i]=new Cargo.o.view[t]({el:this,collection:o.Data[key].dataset,template:o.Data[key].template,className:i}),null==o.Data[key].template&&Cargo.View[i].template&&(o.Data[key].template=Cargo.View[i].template)})}}else null==this.Data[key].template&&Cargo.View[t]&&void 0!==Cargo.View[t].template&&(this.Data[key].template=Cargo.View[t].template)}}}),Cargo.o.model.StripeProductModel=Backbone.Model.extend({initialize:function(){},parse:function(e,t){return e.is_file=!1,e&&e.attributes&&-1!==e.attributes.indexOf("link_to_file")&&(e.is_file=!0,e.attributes=[],e.skus.total_count>1&&e.attributes.push("description")),e&&e.skus&&e.skus.data&&_.each(e.skus.data,function(t){e.is_file&&e.skus.total_count>1&&"object"==typeof t.attributes&&0===_.keys(t.attributes).length&&(t.attributes.description=e.name+" - "+Cargo.o.view.ProductWidget.prototype.formatPriceForCurrency(t.price,t.currency)),t.is_file=e.is_file}),e},getSku:function(e){if(null!=this.attributes.skus)return _.findWhere(this.attributes.skus.data,{id:e})},getAvailableItemsForSKU:function(e){if(e){if(!1===e.active)return 0;if("finite"===e.inventory.type&&e.inventory.quantity>0)return e.inventory.quantity;if("infinite"===e.inventory.type)return 9e9;if("bucket"===e.inventory.type&&("in_stock"===e.inventory.value||"limited"===e.inventory.value))return 9e9}return 0}}),Cargo.o.collection.StripeProductCollection=Backbone.Collection.extend({model:Cargo.o.model.StripeProductModel,productSyncOccurred:!1,initialize:function(){this.cart_count=0,Cargo.Event.on("cart-size-changed",function(e){this.cart_count=e,Cargo.Core.Ecommerce.updateCartText(),Cargo.Core.Ecommerce.updateInlineCartCounters()},this),this.on("sync",function(){var e=[],t=localStorage.getItem("cargo_ecommerce_cart");if(null!==t&&t.length>0)try{e=JSON.parse(t)}catch(e){console.error(e)}_.each(e,function(e){e.available=!1;var t,i=this.findWhere({id:e.productID});i&&(t=i.getSku(e.skuID))&&(this.cart_count+=Math.min(e.amount,i.getAvailableItemsForSKU(t)))},this),Cargo.Core.Ecommerce.updateCartText(),Cargo.Core.Ecommerce.updateInlineCartCounters()}),Cargo.Event.on("stripe_account_connected stripe_account_disconnected",this.fetch,this)},parse:function(e){return _.filter(e,function(e){return e.active})},url:function(){return"/_api/v0/ecommerce/v1/products/"+Cargo.Model.Site.get("id")},updateCartText:function(){return Cargo.Core.Ecommerce.updateCartText.apply(Cargo.Core.Ecommerce,arguments)}}),Cargo.Core.PageviewFactory={pageViewTypes:[],constructPageView:function(){var e,t=Cargo.o.view.Page;for(e=0;e<this.pageViewTypes.length;e++)if(!0===this.pageViewTypes[e].filter.apply(this,arguments)){t=this.pageViewTypes[e].constructor;break}return new(Function.prototype.bind.apply(t,[].concat.apply([null],arguments)))},addPageViewType:function(e,t){t.constructor=function(){this.__super__=Object.getPrototypeOf(Object.getPrototypeOf(this)),Backbone.View.prototype.constructor.apply(this,arguments)},this.pageViewTypes.push({filter:e,constructor:Cargo.o.view.Page.extend(t)})}},Cargo.Core.SetViewFactory={setViewTypes:[],constructSetView:function(){var e,t=Cargo.o.view.Set;for(e=0;e<this.setViewTypes.length;e++)if(!0===this.setViewTypes[e].filter.apply(this,arguments)){t=this.setViewTypes[e].constructor;break}return new(Function.prototype.bind.apply(t,[].concat.apply([null],arguments)))},addSetViewType:function(e,t){t.constructor=function(){this.__super__=Object.getPrototypeOf(Object.getPrototypeOf(this)),Backbone.View.prototype.constructor.apply(this,arguments)},this.setViewTypes.push({filter:e,constructor:Cargo.o.view.Set.extend(t)})}},Cargo.Core.ImageGallery={draggingOverGallery:!1,draggingInEditor:!1,idIndex:0,imageGalleryObjects:{},imageGalleryModes:{},allModesLoaded:!1,galleryLoadInProgress:!1,currentEditableGallery:void 0,cachedScrollY:window.scrollY,galleryPaths:"staging"===__cargo_context__?{columns:"/_jsapps/imagegallery/columns/main.js",freeform:"/_jsapps/imagegallery/freeform/main.js",grid:"/_jsapps/imagegallery/grid/main.js",justify:"/_jsapps/imagegallery/justify/main.js",montessori:"/_jsapps/imagegallery/montessori/main.js",slideshow:"/_jsapps/imagegallery/slideshow/main.js"}:{columns:"https://static.cargo.site/assets/builds/imagegallery/columns.js",freeform:"https://static.cargo.site/assets/builds/imagegallery/freeform.js",grid:"https://static.cargo.site/assets/builds/imagegallery/grid.js",justify:"https://static.cargo.site/assets/builds/imagegallery/justify.js",montessori:"https://static.cargo.site/assets/builds/imagegallery/montessori.js",slideshow:"https://static.cargo.site/assets/builds/imagegallery/slideshow.js"},cachedPaddingSizes:{0:{fontSize:0,paddingMeasure:0}},setCachedPaddingSize:function(e,t,i){if(0!==i){var o=Math.floor(10*parseFloat(e))/10;t/=i,this.cachedPaddingSizes[o]={fontSize:e,paddingMeasure:t}}},getCachedPaddingSize:function(e,t){if(t>0){var i=Math.floor(10*parseFloat(e))/10;return this.cachedPaddingSizes.hasOwnProperty(i)?this.cachedPaddingSizes[i].paddingMeasure*parseFloat(t):null}return 0},loadGalleryModes:function(){var e=this;if(Cargo.Helper.IsAdminEdit()&&parent!==window&&!this.allModesLoaded&&!this.galleryLoadInProgress&&(void 0===Cargo.Homepage||parent!==window)){this.galleryLoadInProgress=!0;var t=_.unzip(_.pairs(Cargo.Core.ImageGallery.galleryPaths)),i=t[0],o=t[1];require(o,function(){e.imageGalleryModes=_.object(i,arguments),e.allModesLoaded=!0,e.galleryLoadInProgress=!1,e.InitImageGallery()})}},addEditorEvents:function(){"undefined"!=typeof CargoEditor&&CargoEditor.events&&_.each(this.editorEvents,function(e,t){this.boundEditorEvents.push(CargoEditor.events.on(t,_.bind(e,this)))},this)},initialize:function(){this.boundEditorEvents=[],this.addEditorEvents(),Cargo.Event.on("gallery-drag-end",function(e,t){var i=$('.image-gallery[gid="'+t+'"] [data-gallery-uid="'+e+'"]')[0];i&&Cargo.Core.ImageGallery.normalizeSelection(void 0,i)},this),Cargo.Helper.IsAdminEdit()&&Cargo.Event.on("image_gallery_rendered",this.addGalleryMenu),this.InitImageGallery()},addGalleryMenu:function(e){document.contains(e.el)&&function(e){e.galleryOptions.gallery_instance_id,closest(e.el,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("page_content")});var t=e.el.querySelector(".image-gallery-menu");t&&t.parentNode&&t.parentNode.removeChild(t);var i=document.createElement("div"),o=document.createElement("style");o.innerText="html, body, body * { cursor: move!important;}",i.style.position="fixed",i.style.zIndex=999,i.style.top=0,i.style.left=0,i.style.outline="1px dashed #698FFF",i.style.pointerEvents="none",i.appendChild(o);var n=document.createElement("div");n.setSaveable&&n.setSaveable(!1),n.classList.add("image-gallery-menu"),n.setAttribute("contenteditable",!1);var a=document.createElement("div");a.setAttribute("title","Remove Image Gallery"),a.className="remove-gallery-button gallery-menu-button",a.addEventListener("click",function(){CargoEditor.mutationManager.execute(function(){e.parentView.destroy()})}),a.innerHTML='<svg viewBox="0 0 40 40" version="1.1"><g class="gallery-menu-icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect class="icon-stroke" fill="#FFFFFF" transform="translate(20.000000, 20.000000) rotate(45.000000) translate(-20.000000, -20.000000) " x="8" y="19" width="24" height="2"></rect><rect class="icon-stroke" fill="#FFFFFF" transform="translate(20.000000, 20.000000) rotate(45.000000) translate(-20.000000, -20.000000) " x="19" y="8" width="2" height="24"></rect></g></svg>';var r=document.createElement("div");r.className="gallery-drag-handle gallery-menu-button",r.setAttribute("title","Move Image Gallery"),r.innerHTML='<svg viewBox="0 0 40 40" version="1.1"><polygon fill="#ffffff" points="12,20.9 19.1,20.9 19.1,28 16,28 20,32 24,28 20.9,28 20.9,20.9 28,20.9 28,24 32,20 28,16 28,19.1 20.9,19.1 20.9,12 24,12 20,8 16,12 19.1,12 19.1,19.1 12,19.1 12,16 8,20 12,24 \t"/></svg>';var s=document.createElement("div");s.classList.add("gallery-dropdown"),s.innerHTML='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 56 40" style="enable-background:new 0 0 56 40;" xml:space="preserve"><polygon fill="#ffffff" points="1,11.5 28,38.5 55,11.5 45,1.5 28,18.5 11,1.5 "/><polygon fill="#000000" points="6,11.5 28,33.5 50,11.5 45,6.5 28,23.5 11,6.5 "/></svg>',s.setAttribute("title","Make an Image Gallery");var l=document.createElement("select");l.style.cursor="default",l.style.width="30px",l.style.height="30px",l.style.position="absolute",l.style.display="block",l.style.top="0px",l.style.left="0px",l.style.zIndex=99,l.style.opacity=0,l.innerHTML=['<option value="disabled" disabled>Image Gallery mode:</option>','<option data-path="slideshow" '+("slideshow"==e.galleryOptions.path?"selected":"")+' value="6">Slideshow</option>','<option data-path="montessori" '+("montessori"==e.galleryOptions.path&&e.galleryOptions.data.zero_height?"selected":"")+' value="free-floating">Free-Floating</option>','<option data-path="justify" '+("justify"==e.galleryOptions.path?"selected":"")+' value="3">Justify</option>','<option data-path="grid" '+("grid"==e.galleryOptions.path?"selected":"")+' value="1">Grid</option>','<option data-path="columns" '+("columns"==e.galleryOptions.path?"selected":"")+' value="2">Columns</option>','<option data-path="freeform" '+("freeform"==e.galleryOptions.path?"selected":"")+' value="5">Irregular</option>','<option data-path="montessori" '+("montessori"!=e.galleryOptions.path||e.galleryOptions.data.zero_height?"":"selected")+' value="4">Freeform</option>'].join("");e.galleryOptions.data.zero_height;s.appendChild(l);var d={x:0,y:0,deltaX:0,deltaY:0},c=!1,h=function(e){d.deltaX=e.clientX-d.x,d.deltaY=e.clientY-d.y,c||(c=!0,requestAnimationFrame(function(){i.style.transform="translate("+d.deltaX+"px, "+d.deltaY+"px)",c=!1}))},u=function(t){Cargo.Core.ImageGallery.cachedScrollY=window.scrollY,window.removeEventListener("mouseup",u),window.removeEventListener("mousemove",h),e.el.classList.remove("drag-gallery"),document.body.removeChild(i);var o=CargoEditor.getActiveEditor().getElement();o&&(CargoEditor.mutationManager.execute(function(){try{CargoEditor.helpers.insertNodeAtCursorPosition({clientX:t.clientX,clientY:t.clientY},e.el,o)}catch(r){var i=o.getBoundingClientRect(),n=Math.max(Math.min(t.clientX,i.left+i.width+-20),i.left+10),a=Math.max(Math.min(t.clientY,i.top+i.height+-20),i.top+10);try{CargoEditor.helpers.insertNodeAtCursorPosition({clientX:n,clientY:a},e.el,o)}catch(e){console.error(e)}}}),_.delay(function(){var t=e.el.getBoundingClientRect();(t.top<0||t.top>window.innerHeight)&&e.el.scrollIntoView(!0)},50))};r.addEventListener("mousedown",function(t){t.preventDefault(),d.x=t.clientX,d.y=t.clientY;var o=e.el.getBoundingClientRect();i.setAttribute("image-gallery",""),i.setAttribute("image-gallery-gutter",e.el.getAttribute("image-gallery-gutter")),i.style.top=o.top+"px",i.style.left=o.left+"px",i.style.width=o.width+"px",i.style.height=o.height+"px",document.body.appendChild(i),e.el.classList.add("drag-gallery"),window.addEventListener("mousemove",h),window.addEventListener("mouseup",u)}),l.addEventListener("change",function(t){if("disabled"!=event.target.value){var i=t.target.value,o=event.target.querySelector('[value="'+i+'"]').getAttribute("data-path"),n=e.el.getAttribute("gid");Cargo.Core.ImageGallery.imageGalleryObjects[n].setEditMode(!0),Cargo.Core.ImageGallery.imageGalleryObjects[n].enableEditable();var a=CargoEditor.getActiveRange(),r=0,s=void 0;if(a&&a.commonAncestorContainer){var l=a.commonAncestorContainer;l.nodeType===Node.ELEMENT_NODE&&(s=l.classList.contains("gallery_card")?l:closest(l,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("gallery_card")}))&&(r=parseInt(s.getAttribute("data-gallery-item-id")))}s||(s=e.el.querySelector(".gallery_card"));var d=CargoEditor.rangy.createRange();d.setStartAfter(s),d.setEndAfter(s),CargoEditor.plugins.forcerange.makeRangeForced(d),Cargo.Core.ImageGallery.normalizeSelection(null,s),parent.Cargo.Event.once("modal-view-added",function(t,n){n.active_mode_path=o,n.once("image-gallery-subview-loaded",function(t){"montessori"===o&&("free-floating"===i?t.currentSubview.handleUIChange("zero_height",!0):t.currentSubview.handleUIChange("zero_height",!1),t.currentSubview.handleUIChange("responsive",!1)),_.defer(function(){var t=e.el.querySelector('[data-gallery-item-id="'+r+'"]');t||(t=e.el.querySelector(".gallery_card"));var i=CargoEditor.rangy.createRange();i.setStartAfter(t),i.setEndAfter(t),CargoEditor.plugins.forcerange.makeRangeForced(i),Cargo.Core.ImageGallery.normalizeSelection(null,t),window.scrollTo(window.scrollX,Cargo.Core.ImageGallery.cachedScrollY)})}),n.loadSubview()}),parent.Cargo.Editor.View.EditorUI.editorCommands["image-gallery"].openModal(parent.Cargo.Editor.View.EditorUI,e.el,Object.assign({},e.galleryOptions),t)}}),n.addEventListener("click",function(e){e.stopPropagation()}),n.appendChild(r),n.appendChild(a),n.appendChild(s),e.el.insertBefore(n,e.el.firstChild)}(e)},galleryDefaults:function(){return{name:"Columns",path:"columns",mode_id:2,gallery_instance_id:0,data:{column_size:10,columns:3,image_padding:2,responsive:!0,mobile_data:{columns:2,column_size:11,image_padding:1,separate_mobile_view:!1},meta_data:{}}}},init_options_defaults:{forceReCollectionOfItems:!1,targetElement:!1},parseGalleryOptions:function(e){for(var t=decodeURIComponent(e),i=0;"{"!==t[0]&&i<3;)t=decodeURIComponent(t),i++;if("{"!==t[0])return this.galleryDefaults();try{return JSON.parse(t)}catch(e){return console.warn("parsing error: gallery options failed to load"),this.galleryDefaults()}},InitImageGallery:function(e){var t=this;if(!Cargo.Helper.IsAdminEdit()||this.allModesLoaded){if(e||(e={}),!(e=_.defaults(e,this.init_options_defaults)).targetElement||jQuery.contains(document.documentElement,e.targetElement)){var i=[],o=[];(e.targetElement?$(e.targetElement).find(".image-gallery[gid-clone]"):$(".image-gallery[gid-clone]")).remove();var n=e.targetElement?$(e.targetElement).find(".image-gallery[gid]"):$(".image-gallery[gid]"),a=e.targetElement?$(e.targetElement).find(".image-gallery").not(".initialized, .initialization-in-progress").length:$(".image-gallery").not(".initialized, .initialization-in-progress").length;n.each(function(){var e=this.getAttribute("gid");-1==o.indexOf(e)?o.push(e):(this.removeAttribute("gid"),this.setAttribute("gid-clone",e))}),(e.targetElement?$(e.targetElement).find(".image-gallery"):$(".image-gallery")).each(function(){if($(this.parentNode).closest(".image-gallery").length>0)this.parentNode.removeChild(this);else if(Cargo.Helper.IsAdminEdit()&&this.setAttribute("contenteditable",!1),!1===$(this).hasClass("initialized")&&!1===$(this).hasClass("initialization-in-progress")){$(this).addClass("initialization-in-progress"),i.push(parseInt($(this).closest(".page").attr("data-id"))),this.hasAttribute("data-gallery")&&this.setAttribute("data-gallery",JSON.stringify(Cargo.Core.ImageGallery.parseGalleryOptions(this.getAttribute("data-gallery"))));var o,n=this.hasAttribute("gid")&&t.imageGalleryObjects.hasOwnProperty(this.getAttribute("gid"));this.hasAttribute("data-force-gid")&&this.hasAttribute("gid")?(o=this.getAttribute("gid"),this.removeAttribute("data-force-gid")):o=n?this.getAttribute("gid"):++t.idIndex,this.setAttribute("gid",o);var r={};if(n)t.imageGalleryObjects[o].el=this,(r=t.imageGalleryObjects[this.getAttribute("gid")]).subviewInited=!1,r.mobileSubviewInited=!1,r.subviewActive=!1,r.mobileSubviewActive=!1,e.forceReCollectionOfItems&&(r.images=null,r.removeViews(),r.checkMobileAndLoadSubview()),t.imageGalleryObjects[o]&&t.imageGalleryObjects[o].storeOptionsOnElement();else{if(r={options:Cargo.Core.ImageGallery.galleryDefaults(o),el:this,images:null,isEditing:!1,hasClick:!1,isEditable:!1,MobileSubview:null,mobileSubviewInitInProgress:!1,mobileSubviewInited:!1,mobileSubviewActive:!1,Subview:null,subviewInitInProgress:!1,subviewInited:!1,inited:!1,bindEvents:function(){var e=this;Cargo.Helper.IsAdminEdit()&&(Cargo.Core.ImageGallery.cachedScrollY=window.scrollY,$(this.el).on("mousedown.gallery",function(t){Cargo.Core.ImageGallery.cachedScrollY=window.scrollY,e.hasClick=!0,$(window).one("mouseup.gallery",function(){setTimeout(function(){window.scrollTo(window.scrollX,Cargo.Core.ImageGallery.cachedScrollY)},30),e.hasClick=!1})}),$(this.el).on("mouseleave.gallery",function(){e.hasClick=!1}),$(this.el).on("mousedown.editable",this.enableEditable),$(this.el).on("mouseup.editable mouseleave.editable",this.checkIfStillEditable),CargoEditor.events.on("editor-drop",this.checkIfStillEditable),CargoEditor.events.on("cursor-activity",this.checkIfStillEditable),CargoEditor.events.on("editor-deactivated",this.checkIfStillEditable)),Cargo.Event.on("mobile_size",this.requestTick,this)},unbindEvents:function(){$(this.el).off("mousedown.gallery mouseup.gallery mouseleave.gallery mousedown.editable mouseup.editable mouseleave.editable"),$(window).off("mouseup.gallery"),Cargo.Event.off("mobile_size",this.requestTick),Cargo.Helper.IsAdminEdit()&&(CargoEditor.events.off("editor-drop",this.checkIfStillEditable),CargoEditor.events.off("cursor-activity",this.checkIfStillEditable),CargoEditor.events.off("editor-deactivated",this.checkIfStillEditable))},enableEditable:function(e){if(e&&closest(e.target,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("image-gallery-menu")}))return;!0!==this.isEditable&&(Cargo.Core.ImageGallery.currentEditableGallery&&Cargo.Core.ImageGallery.currentEditableGallery.disableEditable(),this.el.removeAttribute("contenteditable"),this.isEditable=!0,Cargo.Core.ImageGallery.currentEditableGallery=this,Cargo.Event.trigger("gallery_editing_enabled",this))},disableEditable:function(){!1!==this.isEditable&&(this.el.setAttribute("contenteditable",!1),this.isEditable=!1,Cargo.Event.trigger("gallery_editing_disabled",this),Cargo.Core.ImageGallery.currentEditableGallery&&Cargo.Core.ImageGallery.currentEditableGallery.options.gallery_instance_id==this.options.gallery_instance_id&&(Cargo.Core.ImageGallery.currentEditableGallery=void 0))},checkIfStillEditable:function(e){if(!1!==this.isEditable){var t=CargoEditor.getActiveRange(),i=!1;if(t){var o=t.commonAncestorContainer;o.nodeType!==Node.ELEMENT_NODE&&(o=o.parentNode),i=this.el.contains(o)}i||this.disableEditable()}},setEditMode:function(e){e&&!this.isEditing?$(window).on("scroll.imagegalleryEdit",function(){r.cachedRects.needsUpdate=!0}):!e&&this.isEditing&&$(window).off("scroll.imagegalleryEdit"),this.isEditing=e},setElement:function(e){this.el=e,this.Subview&&this.Subview.setElement(this.el),this.MobileSubview&&this.MobileSubview.setElement(this.el)},checkMobileAndLoadSubview:function(){_.has(this.options.data,"mobile_data")&&("Freeform"===this.options.name||"Montessori"==this.options.name?this.options.data.mobile_data.separate_mobile_view=!0:this.options.data.mobile_data.separate_mobile_view=!1);var e=window.baseUnit.cache.window.w?window.baseUnit.cache.window.w:document.documentElement.clientWidth,t=Cargo.Helper.IsMobileWindowSize(e),i=this.options.data.mobile_data.separate_mobile_view,o=this.options.data.responsive,n=this.mobileSubviewActive,a=this.mobileSubviewInitInProgress,r=this.mobileSubviewInited,s=this.subviewInited,l=this.subviewInitInProgress;t&&i&&!n&&o?a||(r&&this.MobileSubview.galleryOptions.data.mobile_design_path==this.options.data.mobile_data.mobile_design_path?(this.MobileSubview.render(),this.cachedRects.needsUpdate=!0,this.mobileSubviewActive=!0):this.loadMobileSubview(),this.cachedRects.needsUpdate=!0):t&&i&&o||l||(!s||this.Subview&&this.Subview.galleryOptions.path!=this.options.path?this.loadSubview():n&&(this.Subview.render(),this.cachedRects.needsUpdate=!0,this.mobileSubviewActive=!1),this.cachedRects.needsUpdate=!0)},loadSubview:function(){var e=this;if(this.Subview&&this.subviewInited&&(this.Subview.destroy(),this.subviewInited=!1),this.subviewInitInProgress=!0,Cargo.Core.ImageGallery.imageGalleryModes.hasOwnProperty(this.options.path)){var t=Cargo.Core.ImageGallery.imageGalleryModes[this.options.path];Cargo.Helper.IsAdminEdit()?e.finishSubviewSetup(t):_.defer(function(){e.finishSubviewSetup(t)})}else require([Cargo.Core.ImageGallery.galleryPaths[this.options.path]],function(t){Cargo.Core.ImageGallery.imageGalleryModes[e.options.path]=t,e.finishSubviewSetup(t)})},finishSubviewSetup:function(e){var t=window.baseUnit.cache.window.w?window.baseUnit.cache.window.w:document.documentElement.clientWidth,o=Cargo.Helper.IsMobileWindowSize(t),n=new e({el:this.el,galleryOptions:Object.assign({},this.options),parentView:this,mobile_active:o}),r=!this.inited;this.Subview=n,this.images||(this.images=this.Subview.serialize()),0!=_.keys(this.images).length||Cargo.Core.ImageGallery.draggingInEditor||this.destroy(),$(this.el).removeClass("initialization-in-progress"),this.mobileSubviewActive=!1,this.unbindEvents(),this.Subview.render(),this.cachedRects.needsUpdate=!0,this.subviewInited=!0,this.subviewInitInProgress=!1,this.inited=!0,this.lastSerializedState=this.Subview.serialize();var s=this;_.defer(function(){s.bindEvents()}),r&&(Cargo.Event.trigger("image_gallery_render_complete",this),0==--a&&Cargo.Event.trigger("image_gallery_init_complete",i))},loadMobileSubview:function(){var e=this;this.MobileSubview&&this.mobileSubviewInited&&(this.MobileSubview.destroy(),this.mobileSubviewInited=!1),this.options.data.mobile_data.separate_mobile_view&&(this.mobileSubviewInitInProgress=!0,Cargo.Core.ImageGallery.imageGalleryModes.hasOwnProperty(this.options.data.mobile_data.mobile_design_path)?this.finishMobileSubviewSetup(Cargo.Core.ImageGallery.imageGalleryModes[this.options.data.mobile_data.mobile_design_path]):require([Cargo.Core.ImageGallery.galleryPaths[this.options.data.mobile_data.mobile_design_path]],function(t){Cargo.Core.ImageGallery.imageGalleryModes[e.options.data.mobile_data.mobile_design_path]=t,e.finishMobileSubviewSetup(t)}))},finishMobileSubviewSetup:function(e){var t=Object.assign({},this.options);t.data=_.extend(Object.assign({},t.data),t.data.mobile_data),t.data.responsive=!1;var o=!this.inited,n=new e({el:this.el,galleryOptions:Object.assign({},t),parentView:this,mobile_active:!0});this.MobileSubview=n,this.images=this.MobileSubview.serialize(),0!=_.keys(this.images).length||Cargo.Core.ImageGallery.draggingInEditor||this.destroy(),$(this.el).removeClass("initialization-in-progress"),this.mobileSubviewActive=!0,this.unbindEvents(),this.MobileSubview.render(),this.cachedRects.needsUpdate=!0,this.mobileSubviewInited=!0,this.mobileSubviewInitInProgress=!1,this.inited=!0;var r=this;_.defer(function(){r.bindEvents()}),this.lastSerializedState=this.MobileSubview.serialize(),o&&(Cargo.Event.trigger("image_gallery_render_complete",this),0==--a&&Cargo.Event.trigger("image_gallery_init_complete",i))},handleUpdates:function(e){this.debounceUnbindEvents(),"responsive"==e.changing&&this.options.data.mobile_data.separate_mobile_view?this.checkMobileAndLoadSubview():this.routeUpdatesToActiveSubview(e),this.debounceBindEvents()},checkForChanges:function(){var e=this.lastSerializedState,t=this.mobileSubviewActive?this.MobileSubview.serialize():this.Subview.serialize();if(e){var i=_.filter(e,function(e,i){return!t.hasOwnProperty(i)}),o=_.filter(t,function(t,i){return!e.hasOwnProperty(i)}),n={};_.each(t,function(t,i){if(null!=e[i]){var o=_.omit(t,function(t,o){return"data"==o||"itemSrc"==o||("object"==typeof e[i][o]&&"object"==typeof t?_.isEqual(e[i][o],t):e[i][o]==t)},this);_.keys(o).length>0&&(n[i]=o)}},this),(o.length>0||i.length>0||_.keys(n).length>0)&&(this.images=t,this.applyChanges({added:o,removed:i,updated:n}))}this.lastSerializedState=t},applyChanges:function(e){var t=this,i=[];for(var o in e.removed)i.push(e.removed[o].index);var n,a,r=CargoEditor.getActiveRange();if(r){var s=Cargo.Core.ImageGallery.getselectedGalleryId(r);void 0!==s&&(n=a=s),_.each(e.removed,function(e){e.index<=a+1&&n--}),_.each(e.added,function(e){e.index<=a&&n++})}this.removeViews(),this.checkMobileAndLoadSubview(),this.routeUpdatesToActiveSubview({changing:"gallery_changed"}),void 0===n||isNaN(n)||Cargo.Core.ImageGallery.draggingInEditor||_.delay(function(){var e=t.Subview.$el.find('[data-gallery-item-id="'+n+'"]')[0];e&&Cargo.Core.ImageGallery.normalizeSelection(void 0,e)},10);try{window.top.hasOwnProperty("Cargo")&&window.top.Cargo.hasOwnProperty("Editor")&&window.top.Cargo.Editor.View.ContentView.SaveButton.trigger("save_enable")}catch(e){console.warn("Cargo Editor not found, Image Gallery settings will not be saved")}},routeUpdatesToActiveSubview:function(e){var t=this,i=Cargo.Core.ImageGallery.getselectedGalleryId();if(this.mobileSubviewActive){this.Subview&&this.Subview.handleUpdates(Object.assign({},this.options),null);var o=Object.assign({},this.options);o.data=_.extend(Object.assign({},o.data),o.data.mobile_data),o.data.responsive=!1,this.MobileSubview.handleUpdates(o,e)}else this.Subview.handleUpdates(this.options,e);void 0===i||isNaN(i)||Cargo.Core.ImageGallery.draggingInEditor||_.defer(function(){var e=t.Subview.$el.find('[data-gallery-item-id="'+i+'"]')[0];e&&Cargo.Core.ImageGallery.normalizeSelection(void 0,e)})},insertionTick:function(){if(!this.allowInsertion){var e=this;this.insertionFrame=requestAnimationFrame(function(){e.allowInsertion=!0}),this.allowInsertion=!1}},indicateInsertion:function(e,t,i){this.insertionTick(),this.allowInsertion&&(this.draggingOverGallery=!0,this.updateCacheRects(),this.mobileSubviewActive?"function"==typeof this.MobileSubview.indicateInsertion&&this.MobileSubview.indicateInsertion(e,t,i):"function"==typeof this.Subview.indicateInsertion&&this.Subview.indicateInsertion(e,t,i),this.allowInsertion=!1)},resetIndication:function(e){cancelAnimationFrame(this.insertionFrame),(this.draggingOverGallery||e)&&(this.draggingOverGallery=!1,this.mobileSubviewActive?"function"==typeof this.MobileSubview.resetIndication&&this.MobileSubview.resetIndication():"function"==typeof this.Subview.resetIndication&&this.Subview.resetIndication())},removeViews:function(){Cargo.Core.ImageGallery.draggingInEditor,this.mobileSubviewInited&&"function"==typeof this.MobileSubview.destroy&&this.MobileSubview.destroy(),this.subviewInited&&"function"==typeof this.Subview.destroy&&this.Subview.destroy(),this.inited=!1,this.subviewInited=!1,this.mobileSubviewInited=!1,this.mobileSubviewActive=!1},destroy:function(){this.unbindEvents(),this.setEditMode(!1),this.disableEditable();for(var e=_.sortBy(this.images,"index"),t=0;t<e.length;t++){var i=this.mobileSubviewActive?this.MobileSubview.createItem(e[t],!0):this.Subview.createItem(e[t],!0);this.el.parentNode.insertBefore(i,this.el)}this.removeViews(),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.images=void 0,Cargo.Plugins.elementResizer.requestRefreshTick(),delete Cargo.Core.ImageGallery.imageGalleryObjects[this.el.getAttribute("gid")]},cachedRects:{rects:{default:{top:-9e9,left:-9e9,bottom:-9e9,width:0,height:0,positions:{distance:9e9}}},needsUpdate:!0},updateCacheRects:function(){if(this.cachedRects.needsUpdate){var e=window.innerHeight,t=_.clone(this.cachedRects.rects.default);this.cachedRects.rects={default:t};for(var i=this.el.querySelectorAll("[data-gallery-item-id]"),o=0;o<i.length;o++){var n=i[o].getAttribute("data-gallery-item-id"),a=i[o].getBoundingClientRect();a.bottom>=0&&a.top<=e&&(this.cachedRects.rects[n]=a,this.cachedRects.rects[n].midPoint={x:a.left+.5*a.width,y:a.top+.5*a.height})}this.cachedRects.needsUpdate=!1}},requestTick:function(){var e=this;this.ticking||(requestAnimationFrame(function(){e.checkMobileAndLoadSubview(),e.ticking=!1}),this.ticking=!0),this.cachedRects.needsUpdate=!0},updateOptions:function(e,t){var i=this.options.path,o=e.path;this.options=Object.assign({},e),t&&this.storeOptionsOnElement(),i!=o&&(this.removeViews(),this.checkMobileAndLoadSubview())},storeOptionsOnElement:function(){try{this.el.setAttribute("data-gallery",JSON.stringify(this.options))}catch(e){console.warn("unable to store image gallery settings",e)}},addItem:function(e){var t=this,i=parseInt(this.insertionPoint)||0;if($(e).is(".ce-in-progress")){if(!e.hasAttribute("width")||!e.hasAttribute("height")||0==e.getAttribute("width")||0==e.getAttribute("height"))return void(e.onload=function(){e.setAttribute("width",e.naturalWidth),e.setAttribute("height",e.naturalHeight),e.onload=null,t.addItem(e)});parent.Cargo.Event.once("image_upload_complete",function(e){t.checkForChanges()})}e.setAttribute("data-gallery-item-index",i),$(e).find("[data-gallery-item-index]").attr("data-gallery-item-index",i),this.meta_data_cache&&(e.setAttribute("data-meta",this.meta_data_cache),$(e).find("[data-meta]").attr("data-meta",this.meta_data_cache),this.meta_data_cache=""),$(this.el).find("[data-gallery-item-index]").each(function(){var e=parseInt(this.getAttribute("data-gallery-item-index"));e>=i&&this.setAttribute("data-gallery-item-index",e+1)}),e.removeAttribute("data-exclude-item"),$(e).find("[data-exclude-item]").removeAttr("data-exclude-item"),this.el.insertBefore(e,null),this.checkForChanges()}},!this)return;if(this.hasAttribute("data-gallery"))r.options=Cargo.Core.ImageGallery.parseGalleryOptions(this.getAttribute("data-gallery"));else if(this.hasAttribute("gid-clone")){if(!t.imageGalleryObjects.hasOwnProperty(this.getAttribute("gid-clone")))return void this.parentNode.removeChild(this);r.options=t.imageGalleryObjects[this.getAttribute("gid-clone")].options,this.removeAttribute("gid-clone")}r.options.gallery_instance_id=o,r.storeOptionsOnElement()}r.el=this,Cargo.Helper.IsAdminEdit()&&this.setAttribute("contenteditable",!1),r.debounceUnbindEvents=_.debounce(_.bind(r.unbindEvents,r),100,!0),r.debounceBindEvents=_.debounce(_.bind(r.bindEvents,r),100,!1),r.enableEditable=_.bind(r.enableEditable,r),r.checkIfStillEditable=_.bind(r.checkIfStillEditable,r),r.checkMobileAndLoadSubview(),r.finishSubviewSetup=_.bind(r.finishSubviewSetup,r),r.finishMobileSubviewSetup=_.bind(r.finishMobileSubviewSetup,r),t.imageGalleryObjects[o]=r}}),0==a&&Cargo.Event.trigger("image_gallery_init_complete",i)}}else this.loadGalleryModes()},doDelete:function(){CargoEditor.execCommand("delete")},removeMID:function(e){var t=this,i=0,o=$(".image-gallery img[data-mid="+e+"]");if(o.length>0){var n=o.first();parseInt(n.closest("[data-gallery-item-id]").attr("data-gallery-item-id")),i=n.closest(".image-gallery").attr("gid"),o.length>1&&Cargo.Event.once("image_gallery_render_complete",function(i){t.removeMID(e)}),null!==n.get(0).parentNode&&n.get(0).parentNode.removeChild(n.get(0)),this.imageGalleryObjects[i].checkForChanges()}},normalizeSelection:function(e,t){var i=CargoEditor.getActiveRange();if(i){void 0===t&&(t=e?e.target:i.endContainer);var o=$(t).closest(".gallery_card").get(0);if(o){var n=o.querySelectorAll("img, iframe, video")[0];if(n){var a=CargoEditor.rangy.createRange();a.selectNode(n),CargoEditor.helpers.setActiveRange(a)}else o.firstChild?(i.setStartBefore(o.firstChild),i.setEndAfter(o.lastChild),CargoEditor.helpers.setActiveRange(i)):(i.setStartBefore(o),i.setEndAfter(o),CargoEditor.helpers.setActiveRange(i));if(o.hasAttribute("data-gallery-item-index"))parseInt(o.getAttribute("data-gallery-item-index"));else{var r=o.querySelector("[data-gallery-item-index]");r&&parseInt(r.getAttribute("data-gallery-item-index"))}}Cargo.Event.trigger("image-gallery-range-normalized",CargoEditor.getActiveRange())}},getselectedGalleryId:function(e){if(e||(e=CargoEditor.getActiveRange())){var t=void 0,i=e.getNodes([Node.ELEMENT_NODE],function(e){return e.hasAttribute("data-gallery-item-id")});return 0==i.length&&(i=$(e.commonAncestorContainer).closest("[data-gallery-item-id]")),i[0]&&(t=parseInt(i[0].getAttribute("data-gallery-item-id"))),t}},editorEvents:{"editor-keydown":function(e,t){if(Cargo.Core.ImageGallery.currentEditableGallery)if(8===t.keyCode)this.doDelete(),t.preventDefault(),t.stopImmediatePropagation();else if(37===t.keyCode||39===t.keyCode){t.preventDefault(),t.stopImmediatePropagation();var i=CargoEditor.getActiveRange(),o=0,n=_.keys(Cargo.Core.ImageGallery.currentEditableGallery.images).length-1;if(i){var a=i.commonAncestorContainer.querySelector("[data-gallery-item-index]");a&&(o=parseInt(a.getAttribute("data-gallery-item-index")))}else o=37===t.keyCode?0:9e9;if(37===t.keyCode?o--:o++,o>n||o<0){var r=CargoEditor.rangy.createRange();o<0?(r.setStartBefore(Cargo.Core.ImageGallery.currentEditableGallery.el),r.setEndBefore(Cargo.Core.ImageGallery.currentEditableGallery.el)):(r.setStartAfter(Cargo.Core.ImageGallery.currentEditableGallery.el),r.setEndAfter(Cargo.Core.ImageGallery.currentEditableGallery.el)),r.collapse(),CargoEditor.plugins.forcerange.makeRangeForced(r)}else{var s=Cargo.Core.ImageGallery.currentEditableGallery.el.querySelector('[data-gallery-item-index="'+o+'"]');s&&this.normalizeSelection(null,s),!Cargo.Core.ImageGallery.currentEditableGallery.mobileSubviewActive&&Cargo.Core.ImageGallery.currentEditableGallery.Subview.el.hasOwnProperty("slick")&&Cargo.Core.ImageGallery.currentEditableGallery.Subview.$el.slick("slickGoTo",o,!0)}}else if(13===t.keyCode){t.preventDefault(),(r=CargoEditor.rangy.createRange()).setStartAfter(Cargo.Core.ImageGallery.currentEditableGallery.el),r.setEndAfter(Cargo.Core.ImageGallery.currentEditableGallery.el),r.collapse(),CargoEditor.plugins.forcerange.makeRangeForced(r)}else!1===t.metaKey&&(t.preventDefault(),t.stopImmediatePropagation())},"editor-fake-dragstart":function(e,t,i,o){if(i){var n=closest(i,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("image-gallery")});if(n){var a=n.getAttribute("gid"),r=Cargo.Core.ImageGallery.imageGalleryObjects[a];r&&r.enableEditable()}Cargo.Core.ImageGallery.currentEditableGallery&&Cargo.Core.ImageGallery.currentEditableGallery.el.contains(i)&&this.normalizeSelection(null,i)}},"editor-mousedown":function(e,t){if(Cargo.Core.ImageGallery.currentEditableGallery&&t&&Cargo.Core.ImageGallery.currentEditableGallery.el.contains(t.target))if(closest(t.target,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("image-gallery-menu")})||t.target.classList.contains("image-gallery-menu"))t.stopPropagation();else{"IMG"!==t.target.nodeName&&t.preventDefault();var i=Cargo.Core.ImageGallery.currentEditableGallery.el.getBoundingClientRect(),o=!1;if(o=t.clientY<i.top+.5*i.height?"left":"right","IMG"!==t.target.nodeName&&"VIDEO"!==t.target.nodeName&&"IFRAME"!==t.target.nodeName||(o=!1),"left"==o)(n=CargoEditor.rangy.createRange()).setStartBefore(Cargo.Core.ImageGallery.currentEditableGallery.el),n.setEndBefore(Cargo.Core.ImageGallery.currentEditableGallery.el),n.collapse(!1),CargoEditor.plugins.forcerange.makeRangeForced(n);else if("right"==o){var n;(n=CargoEditor.rangy.createRange()).setStartAfter(Cargo.Core.ImageGallery.currentEditableGallery.el),n.setEndAfter(Cargo.Core.ImageGallery.currentEditableGallery.el),n.collapse(!0),CargoEditor.plugins.forcerange.makeRangeForced(n)}else this.normalizeSelection(t)}},"cursor-activity":function(e,t){Cargo.Core.ImageGallery.currentEditableGallery},"editor-paste":function(e,t){Cargo.Core.ImageGallery.currentEditableGallery&&(t.preventDefault(),t.stopImmediatePropagation())},"editor-cut":function(e,t){Cargo.Core.ImageGallery.currentEditableGallery&&(t.preventDefault(),t.stopImmediatePropagation())},"editor-copy":function(e,t){Cargo.Core.ImageGallery.currentEditableGallery&&(t.preventDefault(),t.stopImmediatePropagation())},"editor-before-summary-report":function(e){if(Cargo.Core.ImageGallery.currentEditableGallery){var t=e.generateUnreportedMutationSummaries();if(0!==t.length){var i=!1,o=!1;_.each(t,function(e){_.each(e.removed,function(e){(e.nodeType=Node.ELEMENT_NODE)&&(o=!0)}),_.each(e.added,function(e){(e.nodeType=Node.ELEMENT_NODE)&&(i=!0)})}),(i||o)&&Cargo.Core.ImageGallery.currentEditableGallery.checkForChanges()}}},"history-add":function(e,t){t.modifiedGalleryIDs=[],t.removedNodes.forEach(function(e){e&&e.__galleryInstanceUID__&&t.modifiedGalleryIDs.indexOf(e.__galleryInstanceUID__)&&t.modifiedGalleryIDs.push(e.__galleryInstanceUID__)})},"history-before-undo":function(e,t){_.each(Cargo.Core.ImageGallery.imageGalleryObjects,function(e,i){-1!==t.modifiedGalleryIDs.indexOf(parseInt(i))&&(e.el.innerHTML="")})},"history-undo":function(e,t){var i={},o=!1;for(var n in _.each(t.removedNodes,function(e){$(e).hasClass("image-gallery")&&(e.className="image-gallery",e.setAttribute("data-force-gid",e.getAttribute("gid")),o=!0)}),_.each(t.attributeChanges,function(e){if("data-gallery"==e.attribute&&$(e.element).hasClass("image-gallery")){var t=e.element.getAttribute("gid"),o=Cargo.Core.ImageGallery.imageGalleryObjects[t];if(o){var n=JSON.parse(e.oldValue);o.updateOptions(n,!0),i[n.gallery_instance_id]=o}}}),_.each(Cargo.Core.ImageGallery.imageGalleryObjects,function(e,o){-1!==t.modifiedGalleryIDs.indexOf(parseInt(o))&&(i[o]=e)}),i)i[n].mobileSubviewActive?i[n].images=i[n].MobileSubview.serialize():i[n].images=i[n].Subview.serialize(),i[n].removeViews(!0),i[n].checkMobileAndLoadSubview();o&&_.defer(function(){Cargo.Core.ImageGallery.InitImageGallery({forceReCollectionOfItems:!0,targetElement:e.getElement()})})},"history-before-redo":function(e,t){_.each(Cargo.Core.ImageGallery.imageGalleryObjects,function(e,i){-1!==t.modifiedGalleryIDs.indexOf(parseInt(i))&&(e.el.innerHTML="")})},"history-redo":function(e,t){var i={},o=!1;for(var n in _.each(t.addedNodes,function(e){$(e).hasClass("image-gallery")&&(e.className="image-gallery",e.setAttribute("data-force-gid",e.getAttribute("gid")),o=!0)}),_.each(t.attributeChanges,function(e){if("data-gallery"==e.attribute&&$(e.element).hasClass("image-gallery")){var t=e.element.getAttribute("gid"),o=Cargo.Core.ImageGallery.imageGalleryObjects[t];if(o){var n=JSON.parse(e.newValue);o.updateOptions(n,!0),i[n.gallery_instance_id]=o}}}),_.each(Cargo.Core.ImageGallery.imageGalleryObjects,function(e,o){-1!==t.modifiedGalleryIDs.indexOf(parseInt(o))&&(i[o]=e)}),i)i[n].mobileSubviewActive?i[n].images=i[n].MobileSubview.serialize():i[n].images=i[n].Subview.serialize(),i[n].removeViews(!0),i[n].checkMobileAndLoadSubview();o&&_.defer(function(){Cargo.Core.ImageGallery.InitImageGallery({forceReCollectionOfItems:!0,targetElement:e.getElement()})})}}},Cargo.Core.Embeds={embeds:[],songKickWidgets:{},instagramInitialized:!1,initializeInstagram:function(e){requirejs(["https://platform.instagram.com/en_US/embeds.js"],e)},initializeTwitter:function(e){requirejs(["//platform.twitter.com/widgets.js"],e)},initializeBandsInTown:function(e){requirejs(["https://widget.bandsintown.com/main.min.js"],function(){BIT.widgetInitializer?e():BIT.onReady=e})},findEmbedsIn:function(e){_.each(e.querySelectorAll("cargo-embed, persona-embed"),this.add,this)},add:function(e){if(e&&e.nodeType===Node.ELEMENT_NODE){var t=e.getAttribute("data-type");if(t&&e&&e.nodeType===Node.ELEMENT_NODE&&-1===this.embeds.indexOf(e))switch(t){case"tweet":this.handleTwitterEmbed(e);break;case"twitter-timeline":this.handleTwitterTimelineEmbed(e);break;case"bandsintown":this.handleBandsIntownEmbed(e);break;case"songkick":this.handleSongkickEmbed(e);break;case"instagram":this.handleInstagramEmbed(e)}}},handleBandsIntownEmbed:function(e){this.initializeBandsInTown(_.bind(function(){var t={};_.each(e.attributes,function(e){if(/^data-/.test(e.name)&&"data-type"!==e.name){var i=e.name.substr(5).replace(/-/g,"_");t[i]=e.value}});var i=document.createElement("div");if(i.setAttribute("id","bit-widget-"+_.uniqueId()),i.setAttribute("class","bit-widget-initializer"),_.each(t,function(e,t){i.setAttribute("data-"+t.replace(/_/g,"-"),e)}),e.appendChild(i),Cargo.Helper.IsAdminEdit()){var o=new MutationObserver(function(e){_.each(e,function(e){"childList"==e.type&&e.addedNodes.forEach(function(e){e.setAttribute("contenteditable",!1),e&&e.classList.contains("bit-widget-container")&&(e.style.pointerEvents="none",o.disconnect())})})});o.observe(e,{childList:!0})}BIT.widgetInitializer.append(i,{})},this))},handleSongkickEmbed:function(e){var t={};_.each(e.attributes,function(e){if(/^data-/.test(e.name)&&"data-type"!==e.name){var i=e.name.substr(5).replace(/-/g,"_");t[i]=e.value}});var i=document.createElement("a");i.setAttribute("class","songkick-widget"),i.setAttribute("href","https://www.songkick.com/artists/"+t.id),i.setAttribute("contenteditable","false"),_.each(t,function(e,t){i.setAttribute("data-"+t.replace(/_/g,"-"),e)}),e.appendChild(i),this.embeds.push(e);var o="https://widget.songkick.com/"+t.id+"/widget.js";void 0===this.songKickWidgets[t.id]?this.songKickWidgets[t.id]=0:o=o+"?"+ ++this.songKickWidgets[t.id],require([o])},handleTwitterEmbed:function(e){var t=e.getAttribute("data-id");t&&""!==t&&this.initializeTwitter(_.bind(function(){twttr.widgets.createTweet(t,e).then(function(e){e.setAttribute("contenteditable","false")}),this.embeds.push(e)},this))},handleTwitterTimelineEmbed:function(e){try{var t=JSON.parse(e.getAttribute("data-source"))}catch(e){return}var i;if("number"==typeof t&&(t=e.getAttribute("data-source")),e.hasAttribute("data-options"))try{i=JSON.parse(e.getAttribute("data-options"))}catch(e){}this.initializeTwitter(_.bind(function(){twttr.widgets.createTimeline(t,e,i).then(function(e){e&&e.setAttribute("contenteditable","false")}),this.embeds.push(e)},this))},handleInstagramEmbed:function(e){var t=e.getAttribute("data-url");t&&(t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?"))),$.get("/dispatch/services/getInstagramByUrl?url="+t,_.bind(function(t){"object"==typeof t&&this.initializeInstagram(_.bind(function(){e.innerHTML=t.html,instgrm.Embeds.process()},this))},this)))},remove:function(){}},Cargo.Core.Ecommerce={activeWidgets:[],settingsStorage:{},settingsStorageIndex:0,findWidgets:function(e){if(!0!==Cargo.Model.Site.get("has_shop")&&Cargo.Collection.StripeProducts.productSyncOccurred){var t=Array.prototype.slice.call(document.body.querySelectorAll("shop")),i=[],o=0;e&&e.querySelectorAll&&_.each(e.querySelectorAll("shop"),function(e){-1===t.indexOf(e)&&t.push(e)}),_.each(t,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE){var t=e.getAttribute("product");if(t){var n=Cargo.Collection.StripeProducts.findWhere({id:t.trim()});if(!e.__ecommerce_view__||e.__ecommerce_view__.model!==n){var a=new Cargo.o.view.ProductWidget({model:n});if(e.hasAttribute("sid")){var r=e.getAttribute("sid");this.settingsStorage[r]&&a.updateOptions(this.settingsStorage[r]),e.removeAttribute("sid")}a.setElement(e),a.render(),e.__ecommerce_view__=a,i.push({el:e,view:a,id:o++})}}}},this),this.activeWidgets=i}},updateCartText:function(e,t){if(!0===t||void 0!==Cargo.Model.DisplayOptions.get("ecommerce_options")&&"text"==Cargo.Model.DisplayOptions.get("ecommerce_options").shop_icon){var i=document.getElementById("shop_button");if(e||(e=Cargo.Model.DisplayOptions.get("ecommerce_options").shop_icon_text),i&&e){var o=this.getCartItemCount();i.innerHTML=o?"string"==typeof e&&""!==e?e.replace(/&lt;(.*?)#(.*?)&gt;/gi,"$1"+o+"$2"):"":e.replace(/&lt;(.*?)#(.*?)&gt;/gi,"")}}},updateInlineCartCounters:function(){var e=document.querySelectorAll('a[rel="show_cart"][show-count]');_.each(e,function(e){if(null===e.querySelector("cartcount")){var t=document.createElement("cartcount");t.saveable=!1,t.__template__=" <(#)>";var i,o=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr","meter","progress","input"];if(1===e.children.length&&e.textContent===e.children[0].textContent&&-1===o.indexOf(e.children[0].nodeName.toLowerCase())){for(i=e.children[0];1===i.children.length&&i.textContent===i.children[0].textContent&&-1===o.indexOf(i.children[0].nodeName.toLowerCase());)i=i.children[0];i.appendChild(t)}else e.appendChild(t)}},this);e=document.querySelectorAll("cartcount");var t=this.getCartItemCount();_.each(e,function(e){var i=e.__template__||e.getAttribute("data-template")||"<(#)>";e.innerText=t?"string"==typeof i&&""!==i?i.replace(/<(.*?)#(.*?)>/gi,"$1"+t+"$2"):"":i.replace(/<(.*?)#(.*?)>/gi,"")},this)},getCartItemCount:function(){var e;return Cargo.Model.Site.get("has_shop")?Cargo.Ecommerce&&(e=Cargo.Ecommerce.Collection.cart.getTotalCartItemCount()):e=Cargo.Collection.StripeProducts.cart_count,e},storeSettingsAndSaveReferences:function(){_.each(this.activeWidgets,function(e){var t=this.settingsStorageIndex++;this.settingsStorage[t]=e.view.getOptions(),e.view.el.setAttribute("sid",t)},this)},initialize:function(){!0!==Cargo.Model.Site.get("has_shop")&&(Cargo.Collection.StripeProducts.on("sync error",function(){this.findWidgets()},this),Cargo.Event.on("cargoEditor:before-html-to-projectcontent",function(){this.storeSettingsAndSaveReferences()},this),this.findWidgets())},countryMap:{AF:"Afghanistan",AX:"Åland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia, Plurinational State of",BQ:"Bonaire, Sint Eustatius and Saba",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, the Democratic Republic of the",CK:"Cook Islands",CR:"Costa Rica",CI:"Côte d'Ivoire",HR:"Croatia",CU:"Cuba",CW:"Curaçao",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic of",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia, the former Yugoslav Republic of",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States of",MD:"Moldova, Republic of",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory, Occupied",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Réunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthélemy",SH:"Saint Helena, Ascension and Tristan da Cunha",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin (French part)",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten (Dutch part)",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan, Province of China",TJ:"Tajikistan",TZ:"Tanzania, United Republic of",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela, Bolivarian Republic of",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"}},function(){var e=["   ","   ","   ","   ",".  ",".. ","..."," ..","  ."],t=function(e){e?(e.setAttribute("contenteditable","false"),e.innerHTML='<div class="button"><svg class="play icon" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve"><polygon points="4,2 4,14 15.3,8 "/></svg><svg class="pause icon" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve"><polygon points="3,2 3,14 4,14 7,14 7,2 4,2"/><polygon points="12,2 9,2 9,14 12,14 13,14 13,2"/></svg>\t</div>\t<div class="separator"> </div></div><div class="bar">\t<div class="buffer"> </div>\t<div class="progress"><div class="progress-indicator"></div></div><svg class="note-icon" x="0px" y="0px" viewBox="0 0 42 49.9" style="enable-background:new 0 0 42 49.9;" xml:space="preserve">\t<g>\t\t<g>\t\t\t<path d="M41.5,34.9c0,5.5-3.1,8.2-9.2,8.2c-2.2,0-3.9-0.4-5.2-1.6c-1.3-1-1.9-2.4-1.9-4s0.7-3.1,2.4-4.3c1.6-1.2,3.6-1.8,5.8-1.8 c1.8,0,3.4,0.4,5.2,1.2V9.2L16.8,16v25.1c0,5.5-3.1,8.3-9.3,8.3c-2.2,0-3.9-0.4-5.2-1.5c-1.2-1-1.9-2.4-1.9-4s0.7-3.1,2.2-4.3 s3.4-1.8,5.6-1.8c1.8,0,3.7,0.4,5.6,1V9.2l27.7-8.7L41.5,34.9L41.5,34.9z"/>\t\t</g>\t</g></svg>\t<div class="current-time">0:00</div>\t<div class="stream-anim"><span> </span><span> </span><span> </span></div>\t<div data-title class="title">Play</div>\t<div class="total-time">0:00</div></div><audio preload="metadata"></audio>',this.elements={container:e,play_pause:e.querySelector(".button"),play:e.querySelector(".play"),pause:e.querySelector(".pause"),current_time:e.querySelector(".current-time"),stream_anim:e.querySelector(".stream-anim"),note:e.querySelector(".note-icon"),track_buffer:e.querySelector(".buffer"),progress:e.querySelector(".progress"),progress_ind:e.querySelector(".progress-indicator"),bar:e.querySelector(".bar"),track_length:e.querySelector(".total-time"),play_text:e.querySelector(".title")},this.audio_track=e.querySelector("audio"),this.onMouseInteraction=this.onMouseInteraction.bind(this),this.updatePlayerTime=this.updatePlayerTime.bind(this),this.onError=this.onError.bind(this),this.clearError=this.clearError.bind(this),this.togglePlay=this.togglePlay.bind(this),this.onProgress=this.onProgress.bind(this),this.onTrackEnd=this.onTrackEnd.bind(this),this.onSeekStart=this.onSeekStart.bind(this),this.onSeekEnd=this.onSeekEnd.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.destroy=this.destroy.bind(this),this.removeEl=this.removeEl.bind(this),this.startDrag=this.startDrag.bind(this),this.bindEvents(),this.paused,this.started,this.dragging,this.hasError=!1,this.streaming=!1,this.mouseInteractionDisabled=!1,this.isAdminEdit=Cargo.Helper.IsAdminEdit(),this.elements.container.__cargo_audio_player_=this,this.setLoop(e.hasAttribute("data-loop")),this.setSrc(e.getAttribute("data-src")),this.setTitle(e.getAttribute("data-title"))):console.error("no element passed.")};t.prototype.setLoop=function(e){e?(this.audio_track.setAttribute("loop",""),this.elements.container.setAttribute("data-loop","")):(this.audio_track.removeAttribute("loop"),this.elements.container.removeAttribute("data-loop"))},t.prototype.setSrc=function(e){this.audio_track.getAttribute("src")!==e&&(this.setInitialState(),this.audio_track.src=e,this.elements.container.setAttribute("data-src",e))},t.prototype.startStreamingAnimation=function(t){this.animIndex=0,this.elements.current_time.innerHTML="Streaming",this.animInterval=setInterval(function(){_.each(e[this.animIndex],function(e,t){this.elements.stream_anim.children[t]&&this.elements.stream_anim.children[t].innerText!==e&&(this.elements.stream_anim.children[t].innerText=e)},this),this.animIndex++,this.animIndex>=e.length&&(this.animIndex=0)}.bind(this),175)},t.prototype.stopStreamingAnimation=function(e){clearInterval(this.animInterval)},t.prototype.setTitle=function(e){this.setInitialState(),e&&""!==e||(e="Play"),this.elements.play_text.innerText=e,this.elements.container.setAttribute("data-title",e)},t.prototype.bindEvents=function(){this.audio_track.addEventListener("progress",this.onProgress),this.audio_track.addEventListener("loadedmetadata",this.onProgress),this.audio_track.addEventListener("timeupdate",this.updatePlayerTime),this.audio_track.addEventListener("seeking",this.onSeekStart),this.audio_track.addEventListener("seeked",this.onSeekEnd),this.audio_track.addEventListener("ended",this.onTrackEnd),this.audio_track.addEventListener("error",this.onError),this.audio_track.addEventListener("canplay",this.clearError),this.elements.play_pause.addEventListener("click",this.togglePlay),this.elements.bar.addEventListener("mousedown",this.onMouseDown),this.elements.bar.addEventListener("touchstart",this.onMouseDown),this.elements.bar.addEventListener("touchend",this.onMouseUp),this.elements.container.addEventListener("mousedown",this.startDrag),Cargo.Event.on("css_inspector_activated",this.disableMouseInteraction,this),Cargo.Event.on("css_inspector_deactivated",this.enableMouseInteraction,this),window.addEventListener("mouseup",this.onMouseUp)},t.prototype.destroy=function(){this.audio_track.removeEventListener("progress",this.onProgress),this.audio_track.removeEventListener("loadedmetadata",this.onProgress),this.audio_track.removeEventListener("timeupdate",this.updatePlayerTime),this.audio_track.removeEventListener("seeking",this.onSeekStart),this.audio_track.removeEventListener("seeked",this.onSeekEnd),this.audio_track.removeEventListener("ended",this.onTrackEnd),this.audio_track.removeEventListener("error",this.onError),this.audio_track.removeEventListener("canplay",this.clearError),this.elements.container.removeEventListener("mousedown",this.startDrag),this.elements.play_pause.removeEventListener("click",this.togglePlay),this.elements.bar.removeEventListener("mousedown",this.onMouseDown),this.elements.bar.removeEventListener("touchstart",this.onMouseDown),this.elements.bar.removeEventListener("touchend",this.onMouseUp),Cargo.Event.off("css_inspector_activated",this.disableMouseInteraction),Cargo.Event.off("css_inspector_deactivated",this.enableMouseInteraction),window.removeEventListener("mouseup",this.onMouseUp),this.audio_track.pause(),this.audio_track.src="",delete this.elements.container.__cargo_audio_player_},t.prototype.disableMouseInteraction=function(){this.mouseInteractionDisabled=!0},t.prototype.enableMouseInteraction=function(){this.mouseInteractionDisabled=!1},t.prototype.removeEl=function(){this.elements.container&&this.elements.container&&this.elements.container.parentNode.removeChild(this.elements.container)},t.prototype.setPlayState=function(){this.elements.play.style.display="none",this.elements.pause.style.display="",this.elements.play_text.style.display="none",this.elements.current_time.style.display="",this.elements.stream_anim.style.display="",this.elements.note.style.display="none",this.elements.progress.style.display="",this.elements.track_length.style.display="",this.elements.track_buffer.style.display="",this.paused=!1,this.started=!0,this.dragging=!0,this.streaming&&this.startStreamingAnimation()},t.prototype.setInitialState=function(){this.elements.play.style.display="",this.elements.play_text.style.display="",this.elements.pause.style.display="none",this.elements.note.style.display="",this.elements.progress.style.display="none",this.elements.current_time.style.display="none",this.elements.stream_anim.style.display="none",this.elements.track_length.style.display="none",this.elements.track_buffer.style.display="none",this.elements.progress.style.width="0%",this.elements.track_buffer.style.left="0",this.elements.track_buffer.style.width="0",this.paused=!0,this.dragging=!1,this.started=!1,this.currentPlayerTimestamp=0},t.prototype.setPauseState=function(){this.paused=!0,this.elements.play.style.display="",this.elements.pause.style.display="none",this.elements.container.classList.remove("playing"),this.streaming&&(this.stopStreamingAnimation(),this.setInitialState())},t.prototype.togglePlay=function(){if(!this.mouseInteractionDisabled)if(this.audio_track.paused){var e=this.audio_track.play();_.each(Cargo.Core.AudioPlayer.instances,function(e){e.player===this||e.player.paused||(e.player.audio_track.pause(),e.player.audio_track.currentTime=0,e.player.setInitialState())},this),e?(this.elements.container.classList.add("seeking"),e.then(function(){this.setPlayState()}.bind(this)).catch(this.onError).finally(function(){requestAnimationFrame(function(){this.elements.container.classList.remove("seeking")}.bind(this))}.bind(this))):this.setPlayState()}else this.audio_track.pause(),this.setPauseState()},t.prototype.onError=function(e){if(this.isAdminEdit&&""===this.audio_track.getAttribute("src"))return!0;this.hasError=!0,this.setInitialState(),this.elements.play_text.innerText="Unable to load file",e instanceof DOMException&&console.error(e)},t.prototype.clearError=function(e){this.hasError&&(this.setTitle(this.elements.container.getAttribute("data-title")),this.hasError=!1)},t.prototype.onTrackEnd=function(){!0!==this.dragging&&(this.started=!1,this.setPauseState())},t.prototype.onProgress=function(e){e&&"loadedmetadata"===e.type&&(isFinite(this.audio_track.duration)?(this.elements.track_length.innerText=this.timestampToHumanReadable(this.audio_track.duration),this.streaming=!1,this.elements.container.classList.remove("stream")):(this.elements.track_length.innerText="",this.elements.current_time.textContent="Streaming",this.streaming=!0,this.elements.container.classList.add("stream"))),this.updateBufferSize()},t.prototype.updatePlayerTime=function(){if(this.started&&this.audio_track.readyState!==this.audio_track.HAVE_NOTHING&&!this.streaming){this.currentPlayerTimestamp=this.audio_track.currentTime,this.elements.current_time.textContent=this.timestampToHumanReadable(this.currentPlayerTimestamp);var e=this.currentPlayerTimestamp/this.audio_track.duration*100,t=this.elements.bar.clientWidth,i=parseInt(window.getComputedStyle(this.elements.progress_ind).width);t*(e/100)<i?(e=i/t*(100-e),this.elements.progress.style.transition="none",this.elements.track_buffer.style.transition="none"):(this.elements.progress.style.transition="",this.elements.track_buffer.style.transition=""),this.elements.progress.style.width=e+"%",this.elements.track_buffer.style.left=e+"%",this.updateBufferSize()}},t.prototype.updateBufferSize=function(){for(var e=0,t=0;t<this.audio_track.buffered.length;t++)if(this.currentPlayerTimestamp>=this.audio_track.buffered.start(t)&&this.currentPlayerTimestamp<=this.audio_track.buffered.end(t)){e=Math.max(this.audio_track.buffered.end(t)-this.currentPlayerTimestamp,0)/this.audio_track.duration*100;break}0!==e&&(e+=1),this.elements.track_buffer.style.width=e+"%"},t.prototype.timestampToHumanReadable=function(e){if(isNaN(e))return"0:00";var t=Math.floor(e%60),i=Math.floor(e/60),o=Math.floor(i/60);return t<10&&(t="0"+t),o>0?((i-=60*o)<10&&(i="0"+i),o+":"+i+":"+t):i+":"+t},t.prototype.onMouseInteraction=function(e){if(!this.mouseInteractionDisabled&&!this.streaming&&this.started&&this.audio_track.readyState!==this.audio_track.HAVE_NOTHING&&this.dragging){var t=this.elements.bar.getBoundingClientRect(),i=e.clientX||e.touches[0].clientX;i<t.left?this.audio_track.currentTime=0:i>t.right?this.audio_track.currentTime=this.audio_track.duration:this.audio_track.currentTime=this.audio_track.duration*((i-t.left)/this.elements.bar.clientWidth)}},t.prototype.startDrag=function(e){if(e&&(!e||2!=e.button)&&this.isAdminEdit){var t=CargoEditor.getActiveEditor(),i=document.createElement("style");i.innerText='.audio-player, [contenteditable="false"], .image-gallery, .image-gallery *, .content .image-gallery .gallery_card { pointer-events:none!important; }';var o=setTimeout(function(){document.body.appendChild(i)},200);_.each(Cargo.Core.ImageGallery.imageGalleryObjects,function(e){e.isEditable&&e.disableEditable()});CargoEditor.events.trigger("editor-fake-dragstart",t,e,this.elements.container,{useDragGhost:!0,useDragItemAsGhost:!0,dragGhostStyle:{outline:"1px dashed #698fff",outlineOffset:"4px"}}),CargoEditor.events.once("editor-fake-dragend",function(){clearTimeout(o),document.body.contains(i)&&document.body.removeChild(i)})}},t.prototype.onMouseDown=function(e){e.preventDefault(),this.mouseInteractionDisabled||this.streaming||2===e.button||(!1===this.paused&&this.audio_track.pause(),document.body.classList.add("audio-player-dragging"),this.elements.bar.addEventListener("mousemove",this.onMouseInteraction),window.addEventListener("mousemove",this.onMouseInteraction),this.elements.bar.addEventListener("touchmove",this.onMouseInteraction),this.elements.container.classList.add("seeking"),this.dragging=!0,this.onMouseInteraction(e))},t.prototype.onMouseUp=function(e){1==this.dragging&&(document.body.classList.remove("audio-player-dragging"),this.elements.bar.removeEventListener("mousemove",this.onMouseInteraction),this.elements.bar.removeEventListener("touchmove",this.onMouseInteraction),window.removeEventListener("mousemove",this.onMouseInteraction),this.dragging=!1,!1===this.paused&&!0===this.started&&(this.audio_track.currentTime>=this.audio_track.duration-.001?this.setPauseState():this.audio_track.play())),this.onSeekEnd()},t.prototype.onSeekStart=function(){this.elements.container.classList.add("seeking"),requestAnimationFrame(function(){this.updatePlayerTime()}.bind(this))},t.prototype.onSeekEnd=function(){this.updatePlayerTime(),this.dragging||requestAnimationFrame(function(){this.elements.container.classList.remove("seeking")}.bind(this))},Cargo.Core.AudioPlayer={instances:[],findPlayers:function(e){if(e){var i,o=[];return i=$(e).is("div.audio-player")?[e]:e.querySelectorAll("div.audio-player"),_.each(i,function(i){if(void 0===_.findWhere(this.instances,{el:i})){var n=new t(i);this.instances.push({parent:e,el:i,player:n}),o.push(n)}},this),o}},destroyPlayers:function(e){e&&_.each(this.instances,function(t){t.parent===e&&t.player.destroy()})}}}(),function(){function e(e,t,i,o,n,a,r){var s=Math.acos,l=Math.atan,d=Math.sqrt,c=Math.PI,h={x:n,y:a},u=0,g={x:1,y:1},p={x:0,y:0},m=e*o-t*i;if(r)e?(p={x:l(i/e),y:l(t/e)},g={x:e,y:m/e}):t?(u=.5*c,g={x:t,y:m/t},p.x=l(o/t)):(g={x:i,y:o},p.x=.25*c);else if(e||t){var f=d(e*e+t*t);u=t>0?s(e/f):-s(e/f),g={x:f,y:m/f},p.x=l((e*i+t*o)/(f*f))}else if(i||o){var v=d(i*i+o*o);u=.5*c-(o>0?s(-i/v):-s(i/v)),g={x:m/v,y:v},p.y=l((e*i+t*o)/(v*v))}else g={x:0,y:0};return{scale:g,translate:h,rotation:u,skew:p}}Cargo.Core.Draggables={},Cargo.Core.Draggables.windowSize={h:window.innerHeight,w:document.documentElement.clientWidth},Cargo.Core.Draggables.masterList={},Cargo.Core.Draggables.findShowLinks=function(){var e=document.querySelectorAll('[rel*="show_draggable"]');if(e.length>0){var t=!0;_.each(e,function(e){0===e.childNodes.length&&""===e.innerText.trim()&&(t=!1)}),Cargo.Core.Draggables.showLinkIsPresent=!!t}else Cargo.Core.Draggables.showLinkIsPresent=!1},Cargo.Core.Draggables.cleanup=function(e){e.model&&Cargo.Core.Draggables.masterList.hasOwnProperty(e.model.id)&&delete Cargo.Core.Draggables.masterList[e.model.id]},Cargo.Core.Draggables.DraggablesInstance=Backbone.View.extend({initialize:function(e){if(!Cargo.Helper.IsAdminEdit()&&e.pageView&&(this.pageView=e.pageView,this.insideGallery=this.pageView.el.classList.contains("image-gallery"),!this.insideGallery||!this.pageView.el.classList.contains("slick"))){if(this.pid=0,this.insideGallery){var t=closest(this.pageView.el,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.hasAttribute("data-id")});if(!t)return;this.pid=parseInt(t.getAttribute("data-id"))}else this.pid=this.pageView.model.id;this.draggables=[],this.findDraggables(),this.bindShowHideLinks()}},findDraggables:function(){var e=this.pageView.el.querySelectorAll("[data-draggable]");if(e.length>0){var t=this.pageView.el.querySelectorAll("[grid-col], [image-gallery-col]");_.each(t,function(e){e.querySelectorAll("[data-draggable]").length>0&&(""!==e.style.position&&"static"!==e.style.position||(e.style.position="relative"))})}for(var i=0;i<e.length;i++){var o=e[i],n=o.classList.contains("gallery_card"),a=null;n||(a=closest(o,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("marquee")}));var r=closest(o.parentNode,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.hasAttribute("data-draggable")});if(!(a||!o.parentNode||o.parentNode.classList.contains("image-gallery")&&!n||r||!this.insideGallery&&n)){var s={initial_state_set:!1};o.style.zIndex?s.zIndex=o.style.zIndex:s.zIndex=1;var l=_.uniqueId("draggable_");o.hasAttribute("data-draggable-id")&&(l=o.getAttribute("data-draggable-id")),s.id=l,s.el=o;var d=s.el.querySelector(".draggable_handle");if(s.handle=d,this.insideGallery&&n)s.interiorItem=s.el.querySelector("[data-gallery-item]");else if(this.insideGallery)continue;this.draggables.push(s),Cargo.Core.Draggables.masterList.hasOwnProperty(this.pid)||(Cargo.Core.Draggables.masterList[this.pid]={draggables:[]}),Cargo.Core.Draggables.masterList[this.pid].draggables.push(s)}}if(this.draggables.length>0&&!this.insideGallery){var c=this.pageView.el.querySelector("bodycopy");c&&c.classList.add("preserve-3d")}for(i=0;i<this.draggables.length;i++)this.bindDraggable(this.draggables[i])},bindShowHideLinks:function(){for(var e=this.pageView.el.querySelectorAll('[rel*="toggle_draggable"]'),t=0;t<e.length;t++){e[t].addEventListener("click",this.toggleDraggables)}var i=this.pageView.el.querySelectorAll('[rel*="hide_draggable"]');for(t=0;t<i.length;t++){i[t].addEventListener("click",this.hideDraggables)}var o=this.pageView.el.querySelectorAll('[rel*="show_draggable"]');for(t=0;t<o.length;t++){o[t].addEventListener("click",this.showDraggables)}Cargo.Core.Draggables.masterList[this.pid]||(Cargo.Core.Draggables.masterList[this.pid]={draggables:[]}),Cargo.Core.Draggables.showLinkIsPresent?_.each(Cargo.Core.Draggables.masterList,function(e){_.each(e.draggables,function(e){e.initial_state_set||(e.el.classList.add("draggable_hidden"),e.initial_state_set=!0)})}):_.each(Cargo.Core.Draggables.masterList,function(e){_.each(e.draggables,function(e){e.initial_state_set||e.el.classList.remove("draggable_hidden"),e.initial_state_set=!0})})},hideDraggables:function(e){if(e.preventDefault(),this.hasAttribute("data-draggable-id")){var t=this.getAttribute("data-draggable-id");_.each(Cargo.Core.Draggables.masterList,function(e){var i=_.filter(e.draggables,{id:t});_.each(i,function(e){e.el.classList.add("draggable_hidden")})})}else _.each(Cargo.Core.Draggables.masterList,function(e){_.each(e.draggables,function(e){e.el.classList.add("draggable_hidden")})})},showDraggables:function(e){if(e.preventDefault(),this.hasAttribute("data-draggable-id")){var t=this.getAttribute("data-draggable-id");_.each(Cargo.Core.Draggables.masterList,function(e){var i=_.filter(e.draggables,{id:t});_.each(i,function(e){e.el.classList.remove("draggable_hidden")})})}else _.each(Cargo.Core.Draggables.masterList,function(e){_.each(e.draggables,function(e){e.el.classList.remove("draggable_hidden")})})},toggleDraggables:function(e){if(e.preventDefault(),this.hasAttribute("data-draggable-id")){var t=this.getAttribute("data-draggable-id");_.each(Cargo.Core.Draggables.masterList,function(e){var i=_.filter(e.draggables,{id:t});_.each(i,function(e){e.el.classList.contains("draggable_hidden")?e.el.classList.remove("draggable_hidden"):e.el.classList.add("draggable_hidden")})})}else _.each(Cargo.Core.Draggables.masterList,function(e){_.each(e.draggables,function(e){e.el.classList.contains("draggable_hidden")?e.el.classList.remove("draggable_hidden"):e.el.classList.add("draggable_hidden")})})},bindDraggable:function(t){var i,o=0,n=0,a=0,r=0,s=0,l=0,d=0,c=0,h=0,u=null,g=null,p=!1,m=!1,f=null;if(t.interiorItem&&(t.interiorItem.style.cursor="move"),t.handle?t.handle.style.cursor="move":t.el.style.cursor="move",t.el.setAttribute("data-draggable-id",t.id),t.el.children.length>0){var v=t.el.querySelectorAll('[rel*="show_draggable"]'),b=t.el.querySelectorAll('[rel*="hide_draggable"]'),y=t.el.querySelectorAll('[rel*="toggle_draggable"]');_.each(v,function(e){e.setAttribute("data-draggable-id",t.id)}),_.each(b,function(e){e.setAttribute("data-draggable-id",t.id)}),_.each(y,function(e){e.setAttribute("data-draggable-id",t.id)})}var w=function(e){p?(e.preventDefault(),e.stopPropagation(),m=!1):m=!0,window.removeEventListener("click",w,!0)},C=_.bind(function(v){if(2!=v.button){u=u=t.el.querySelector(".image-zoom"),g=g=t.el.querySelector("a"),"INPUT"!==v.target.tagName&&"TEXTAREA"!==v.target.tagName&&"LABEL"!==v.target.tagName&&"CANVAS"!==v.target.tagName&&(v.preventDefault(),m=!1),f=t.el,p=!1;var b=v.clientX||v.touches&&v.touches[0].clientX,y=v.clientY||v.touches&&v.touches[0].clientY;this.pageView.el.classList.add("dragging-active");var C=t.el.style.transform;t.el.style.transform="",t.el.style.transitionDuration="initial",i=t.el.getBoundingClientRect(),t.el.style.transform=C,t.initial_state_set=!0;var E=window.getComputedStyle(t.el);if(!this.insideGallery){var k=E.getPropertyValue("background-color"),I=!0;if(k.indexOf("rgb(")>0)I=!1;else for(var T=k.replace("rgba(","").replace(")","").split(","),A=0;A<T.length;A++){parseFloat(T[A])>0&&(I=!1)}I&&(t.el.style.backgroundColor="rgba(0,0,0,0.004)")}var M=E.getPropertyValue("transform"),P=M.indexOf("matrix(")>-1,O=M.indexOf("matrix3d(")>-1;if(P){M=M.replace(")","").replace("matrix(","").split(",");for(A=0;A<M.length;A++)M[A]=parseFloat(M[A]);h=e(M[0],M[1],M[2],M[3],M[4],M[5],!1).rotation,r=M[M.length-1],a=M[M.length-2]}else if(O){M=M.replace(")","").replace("matrix3d(","").split(",");for(A=0;A<M.length;A++)M[A]=parseFloat(M[A]);h=e(M[0],M[1],M[4],M[5],M[12],M[13],!1).rotation,r=M[M.length-3],a=M[M.length-4]}else M=[1,0,0,1,0,0],h=0,a=0,r=0;a=Math.floor(100*a)/100,r=Math.floor(100*r)/100,(h=(Math.round(h*(180/Math.PI))+360)%360)>180&&(h-=360),o=b-a,n=y-r,d=i.left,c=i.top,s=b,l=y,window.addEventListener("click",w,!0);var L=0;for(A=0;A<this.draggables.length;A++)L=Math.max(this.draggables[A].zIndex,L);t.zIndex=L+1,t.el.style.zIndex=99,_.defer(function(){t.el.style.zIndex=L+1}),v.touches?(window.addEventListener("touchmove",S),window.addEventListener("touchend",x)):(window.addEventListener("mousemove",S),window.addEventListener("mouseup",x))}},this),S=function(e){var t=e.clientX||e.touches&&e.touches[0].clientX,h=e.clientY||e.touches&&e.touches[0].clientY,u=e.touches?4:2;a=t-o,r=h-n,(Math.abs(s-t)>u||Math.abs(l-h)>u)&&(p=!0),d+a>=Cargo.Core.Draggables.windowSize.w-50?a=Cargo.Core.Draggables.windowSize.w+-d+-50:d+a+i.width<=50&&(a=-d-i.width+50);c+r>=Cargo.Core.Draggables.windowSize.h-50?r=Cargo.Core.Draggables.windowSize.h+-c+-50:c+r+i.height<=50&&(r=-c-i.height+50),E()},x=_.bind(function(e){if(_.defer(function(){t.el.style.transitionDuration=""}),t.el.hasAttribute("data-draggable")&&(t.el.setAttribute("data-transform-z",t.zIndex),t.el.setAttribute("data-transform-x",100*a/i.width),t.el.setAttribute("data-transform-y",100*r/i.height)),this.pageView.el.classList.remove("dragging-active"),t.el.children.length>0&&!this.insideGallery){var o=t.el.querySelectorAll("img, video, iframe");_.each(o,function(e){e._scrollWatcher&&(e._scrollWatcher.recalculateLocation(),e._scrollWatcher.update(),e._scrollWatcher.triggerCallbacks()),e._scrollWatchEnterThreshold&&(e._scrollWatchEnterThreshold.recalculateLocation(),e._scrollWatchEnterThreshold.update(),e._scrollWatchEnterThreshold.triggerCallbacks()),e._referenceScrollWatch&&(e._referenceScrollWatch.recalculateLocation(),e._referenceScrollWatch.update(),e._referenceScrollWatch.triggerCallbacks())})}else this.insideGallery&&t.interiorItem?(t.interiorItem._scrollWatcher&&(t.interiorItem._scrollWatcher.recalculateLocation(),t.interiorItem._scrollWatcher.update(),t.interiorItem._scrollWatcher.triggerCallbacks()),t.interiorItem._scrollWatchEnterThreshold&&(t.interiorItem._scrollWatchEnterThreshold.recalculateLocation(),t.interiorItem._scrollWatchEnterThreshold.update(),t.interiorItem._scrollWatchEnterThreshold.triggerCallbacks()),t.interiorItem._referenceScrollWatch&&(t.interiorItem._referenceScrollWatch.recalculateLocation(),t.interiorItem._referenceScrollWatch.update(),t.interiorItem._referenceScrollWatch.triggerCallbacks())):(t.el._scrollWatcher&&(t.el._scrollWatcher.recalculateLocation(),t.el._scrollWatcher.update(),t.el._scrollWatcher.triggerCallbacks()),t.el._scrollWatchEnterThreshold&&(t.el._scrollWatchEnterThreshold.recalculateLocation(),t.el._scrollWatchEnterThreshold.update(),t.el._scrollWatchEnterThreshold.triggerCallbacks()),t.el._referenceScrollWatch&&(t.el._referenceScrollWatch.recalculateLocation(),t.el._referenceScrollWatch.update(),t.el._referenceScrollWatch.triggerCallbacks()));p||_.defer(function(){if(!m&&f){var e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});u?u.dispatchEvent(e):g?g.dispatchEvent(e):f.dispatchEvent(e)}}),window.removeEventListener("touchmove",S),window.removeEventListener("touchend",x),window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",x)},this),E=function(){t.el.style.transform="translate("+100*a/i.width+"%,"+100*r/i.height+"%) rotate("+h+"deg) translateZ("+t.zIndex+"px)"};t.handle?(t.handle.addEventListener("touchstart",C),t.handle.addEventListener("mousedown",C)):(t.el.addEventListener("touchstart",C),t.el.addEventListener("mousedown",C))},remove:function(){if(this.pageView){for(var e=this.pageView.el.querySelectorAll('[rel*="toggle_draggable"]'),t=0;t<e.length;t++){e[t].removeEventListener("click",this.toggleDraggables)}var i=this.pageView.el.querySelectorAll('[rel*="hide_draggable"]');for(t=0;t<i.length;t++){i[t].removeEventListener("click",this.hideDraggables)}var o=this.pageView.el.querySelectorAll('[rel*="show_draggable"]');for(t=0;t<o.length;t++){o[t].removeEventListener("click",this.showDraggables)}Cargo.Core.Draggables.cleanup(this.pageView)}Backbone.View.prototype.remove.apply(this,arguments)}});var t=_.debounce(function(){Cargo.Core.Draggables.windowSize={h:window.innerHeight,w:document.documentElement.clientWidth}},300);window.addEventListener("resize",t),Cargo.Event.on("image_gallery_rendered",function(e){e.draggableView?Cargo.Helper.IsAdminEdit()||(e.draggableView.draggables=[],e.draggableView.findDraggables(),e.draggableView.bindShowHideLinks()):e.draggableView=new Cargo.Core.Draggables.DraggablesInstance({pageView:e})})}(),function(){var e=Backbone.View.extend({defaults:{speed:-20,behavior:"scroll",direction:"horizontal",offset:0},initialize:function(e){if(e.parentView){if(this.parentView=e.parentView,Cargo.Event.trigger("marquee:before-init",this),this.model.attributes=_.defaults(this.model.attributes,this.defaults),this.getAttributes(),this.setAttributes(),this.contentNodes=[],this.waitingForDragEnd=!1,this.built=!1,this.editing=!1,this.marqueeContentRect=null,this.mRect=null,this.wrapper=null,this.inner=null,this.position=0,this.hasPadding=null,this.translateX=0,this.translateY=0,this.paused=!1,this.onlyContainsScalableItems=!1,this.updateContent(),this.buildOut(!0),this.updateSize(),this.dragEnter=_.bind(this.dragEnter,this),this.handleUndoRedoChanges=_.bind(this.handleUndoRedoChanges,this),Cargo.Helper.IsAdminEdit()&&(this.el.addEventListener("dragenter",this.dragEnter),"undefined"!=typeof CargoEditor&&CargoEditor.events)){var t={childList:!0,subtree:!0},i=new MutationObserver(this.handleUndoRedoChanges);CargoEditor.events.on("history-before-redo history-before-undo",function(){i.observe(this.el,t)},this),CargoEditor.events.on("history-redo history-undo",function(){this.handleUndoRedoChanges(i.takeRecords()),i.disconnect()},this),CargoEditor.events.on("editor-drop",function(){var e=this;_.defer(function(){e.built||!e.waitingForDragEnd||e.editing||(e.updateContent(),e.buildOut())})},this),CargoEditor.events.on("editor-dragend",function(){this.built||!this.waitingForDragEnd||this.editing||(this.updateContent(),this.buildOut())},this)}Cargo.Event.trigger("marquee:after-init",this)}},events:{mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},onMouseEnter:function(e){this.built&&this.el.setAttribute("contenteditable",!1)},onMouseLeave:function(e){this.el.blur(),this.el.removeAttribute("contenteditable")},handleUndoRedoChanges:function(e){var t=!1;if(_.each(e,function(e){e.target.classList.contains("marquee")&&e.target.classList.contains("torn-down")&&(t=!0)}),e.length>0){var i=!1,o=this.el.querySelector(".marquee_contents");if(o){var n=o.querySelector(".marquee_inner");if(n){for(i=!0;n.childNodes.length>0;)this.el.appendChild(n.childNodes[0]);o.parentNode.removeChild(o)}}this.contentNodes=this.el.childNodes,i&&t?(this.built=!1,this.buildOut()):(this.built=!0,this.tearDown(),Cargo.Event.trigger("marquee:requires-modal",this))}},pause:function(){this.paused=!0},resume:function(){this.paused=!1},setAttributes:function(){this.el.setAttribute("direction",this.model.get("direction")),this.el.setAttribute("speed",this.model.get("speed")),this.el.setAttribute("behavior",this.model.get("behavior")),this.el.setAttribute("behavior",this.model.get("behavior")),this.el.setAttribute("offset",Math.floor(100*this.model.get("offset"))+"%")},dragEnter:function(e){this.waitingForDragEnd=!0,this.tearDown()},getAttributes:function(){this.el.hasAttribute("speed")&&this.model.set("speed",parseFloat(this.el.getAttribute("speed"))),this.el.hasAttribute("direction")&&this.model.set("direction",this.el.getAttribute("direction")),this.el.hasAttribute("behavior")&&this.model.set("behavior",this.el.getAttribute("behavior")),this.el.hasAttribute("offset")&&this.model.set("offset",.01*parseInt(this.el.getAttribute("offset")))},handleUpdate:function(e,t){"offset"===e&&(t*=.01);var i=this.model.get(e);this.model.set(e,t),this.setAttributes(),"behavior"===e&&i!==t?(this.setAttributes(),this.built?(this.tearDown(),this.buildOut()):this.buildOut()):i===t||this.built||this.buildOut()},removeMarqueeContent:function(){if(this.updateContent(),this.el.parentNode)for(;this.contentNodes.length>0;)this.el.parentNode.insertBefore(this.contentNodes[0],this.el);this.destroy()},updateSize:function(){if(this.el||this.destroy(),this.built){var e=this.wrapper.getBoundingClientRect(),t=this.el.getBoundingClientRect(),i=0,o=0,n=0,a=0;if(null===this.hasPadding||this.hasPadding){var r=window.getComputedStyle(this.el,null);n=parseFloat(r.paddingLeft),o=parseFloat(r.paddingTop),a=parseFloat(r.paddingBottom),i=parseFloat(r.paddingRight),null===this.hasPadding&&(this.hasPadding=n||o||a||i)}var s=t.left+-(e.left+-this.translateX);this.marqueeContentRect={width:e.width,height:e.height},this.mRect={overHangX:s,padTop:o,padLeft:n,padRight:i,padBottom:a,width:t.width,height:t.height}}},draw:function(){if(this.el&&this.el.parentNode||this.destroy(),this.built&&this.mRect&&this.marqueeContentRect){var e=this.paused?0:.001*this.model.get("speed")*60,t=1;if(this.onlyContainsScalableItems)t=baseUnit.cache.window.w/1e3;else{var i=((f=Math.min(1e3,Math.max(320,baseUnit.cache.window.w)))-320)/680;t=1*i+.72*(1-i)}e*=t;var o=this.model.get("offset"),n="vertical"===this.model.get("direction"),a="horizontal"===this.model.get("direction");if(e*=1.5,this.position=e+this.position,"bounce"===this.model.get("behavior")){var r=Math.abs(this.position),s=this.mRect.width-(this.mRect.padLeft+this.mRect.padRight),l=this.mRect.height-(this.mRect.padTop+this.mRect.padBottom),d=s-(f=this.marqueeContentRect.width),c=l-(v=.5*this.marqueeContentRect.height),h=0,u=0;f>=s&&(h=-(d=f-s)),v>=l&&(u=-(c=v-l));var g=a?d+o*d:o*d,p=n?c+o*c:o*c,m=c-Math.abs((r+p)%(2*c)-c)||0;b=((b=d-Math.abs((r+g)%(2*d)-d)||0)+d)%d+h,m=(m+c)%c+u,a?(this.wrapper.style.transform="translateX("+b+"px)",this.translateX=b,this.translateY=0):n?(this.wrapper.style.transform="translateY("+m+"px)",this.translateY=m,this.translateX=0):(this.wrapper.style.transform="translate("+b+"px, "+m+"px)",this.translateY=m,this.translateX=b),this.inner.style.transform=""}else{var f=Math.max(this.marqueeContentRect.width,this.mRect.width),v=Math.max(this.marqueeContentRect.height,this.mRect.height),b=(this.position+o*this.marqueeContentRect.width)%f||this.translateX;m=(this.position+o*this.marqueeContentRect.height)%v||this.translateX;b>0&&(b+=-f),b+=this.mRect.overHangX,m>0&&(m-=f),a?(this.translateY=0,this.translateX=b,this.inner.style.transform="translateX("+f+"px)",this.wrapper.style.transform="translateX("+b+"px)"):n&&(this.translateY=m,this.translateX=0,this.inner.style.transform="translateY("+v+"px)",this.wrapper.style.transform="translateY("+m+"px)")}}},startEditing:function(){this.editing?this.tearDown():(this.el.classList.add("editing"),this.editing=!0,CargoEditor&&CargoEditor.hasOwnProperty("rangy")&&setTimeout(_.bind(function(){var e=CargoEditor.rangy.createRange();e.selectNodeContents(this.el),e.collapse(!0),CargoEditor.helpers.setActiveRange(e)},this),50),this.tearDown())},stopEditing:function(){this.editing?(this.el.classList.remove("editing"),this.editing=!1,Cargo.Event.trigger("handleAdminUIChange"),this.buildOut()):this.buildOut()},updateContent:function(){this.built?this.contentNodes=this.inner.childNodes:this.contentNodes=this.el.childNodes,this.onlyContainsScalableItems=!0;for(var e=0;e<this.contentNodes.length;){var t=this.contentNodes[e];if(t.nodeType===Node.ELEMENT_NODE)if("IMG"===t.nodeName&&"VIDEO"===t.nodeName&&"IFRAME"===t.nodeName||(this.onlyContainsScalableItems=!1),t.classList.contains("marquee")||t.classList.contains("image-gallery")){if(t.hasAttribute("data-marquee-id"))this.parentView.marquee[t.getAttribute("data-marquee-id")].removeMarqueeContent();else for(;t.childNodes.length>0;)t.parentNode.insertBefore(t.childNodes[0],t);t.parentNode.removeChild(t)}else e++;else e++}},buildOut:function(e){if(!this.built)if(this.el.classList.remove("torn-down"),0!=this.contentNodes.length){var t=document.createElement("div");t.className="marquee_contents";var i=document.createElement("div");for(i.className="marquee_inner";this.contentNodes.length>0;)i.appendChild(this.contentNodes[0]);t.appendChild(i),this.inner=i;var o=i.cloneNode(!0);o.classList.add("cloned_marquee_inner"),this.innerClone=o,"scroll"!==this.model.get("behavior")&&"up"!==this.model.get("direction")&&"down"!==this.model.get("direction")&&"diagonal"!==this.model.get("direction")||t.appendChild(o);var n=i.querySelectorAll("img"),a=o.querySelectorAll("img");_.each(n,function(e,t){e.classList.contains("image-zoom")&&(a[t].classList.add("image-zoom"),$(a[t]).on("click.lightbox",function(){$(e).click()}))});var r=i.querySelectorAll("video"),s=o.querySelectorAll("video");_.each(r,function(e,t){!function(e,t,i){var o;t.addEventListener("play",function(){e.currentTime=t.currentTime,e.play()}),t.addEventListener("pause",function(){e.currentTime=t.currentTime,e.pause()}),e.addEventListener("play",function(){t.currentTime=e.currentTime,t.play(),o=setTimeout(n,500)}),e.addEventListener("pause",function(){t.currentTime=e.currentTime,t.pause(),clearTimeout(o)});var n=function(){t.currentTime=e.currentTime,o=setTimeout(n,500)}}(r[t],s[t])}),this.el.innerHTML="",this.el.setAttribute("data-marquee-id",this.id),this.el.appendChild(t),this.wrapper=t,Cargo.Event.trigger("handleAdminUIChange"),e||this.parentView.refresh(),this.built=!0,this.updateContent()}else this.destroy()},destroy:function(){this.parentView.removeView(this.id)},tearDown:function(){if(this.built){if(this.el.classList.add("torn-down"),this.contentNodes.length>0&&this.contentNodes[0].parentNode!==this.el)for(;this.contentNodes.length>0;)this.el.appendChild(this.contentNodes[0]);this.wrapper&&this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper),this.el.removeAttribute("contenteditable");var e=this.el.querySelector(".marquee_contents");e&&e.parentNode.removeChild(e),this.wrapper=null,this.innerClone=null,this.inner=null,this.built=!1,this.updateContent(),this.parentView.refresh()}},remove:function(){Cargo.Event.trigger("marquee:before-remove",this),this.stopListening(),this.undelegateEvents(),Cargo.Helper.IsAdminEdit()&&this.el.removeEventListener("dragenter",this.dragEnter),this.built=!1,this.contentNodes=[],Backbone.View.prototype.remove.apply(this,arguments),Cargo.Event.trigger("marquee:after-remove",this)}});Cargo.Core.MarqueeInstance=Backbone.View.extend({initialize:function(e){e&&e.parentView&&(this.parentView=e.parentView,this.isAdmin=Cargo.Helper.IsAdminEdit(),this.marquees={},this.ticking=!1,this.idleWaiting=!1,this.hasRequestIdle="requestIdleCallback"in window,this.draw=_.bind(this.draw,this),this.requestTick=_.bind(this.requestTick,this),this.findMarquees=_.bind(this.findMarquees,this),this.listenTo(Cargo.Event,"elementresizer_update_complete",this.requestTick),"undefined"!=typeof CargoEditor&&CargoEditor.events&&this.listenTo(CargoEditor.events,"editor-content-change",this.requestTick))},findMarquees:function(){var e=this.parentView.el.querySelectorAll(".marquee");_.each(e,function(e){e.classList.length>4||this.addView(e)},this),cancelAnimationFrame(this.drawFrame),_.isEmpty(this.marquees)||this.draw()},draw:function(){this.ticking&&(this.hasRequestIdle&&!this.idleWaiting?(this.idleWaiting=!0,requestIdleCallback(_.bind(function(){this.updateSizes(),this.idleWaiting=!1},this),{timeout:500})):this.hasRequestIdle||this.updateSizes(),this.ticking=!1),_.each(this.marquees,function(e){e.draw()}),this.drawFrame=requestAnimationFrame(this.draw)},addView:function(t,i){if(!(t.classList.length>4)){var o=_.uniqueId("marquee_");if(t.hasAttribute("data-marquee-id")&&(o=t.getAttribute("data-marquee-id")),t.setAttribute("data-marquee-id",o),this.marquees[o])return this.marquees[o];var n=_.extend({},i),a=new e({el:t,id:o,parentView:this,model:new Backbone.Model(n)});return this.marquees[o]=a,cancelAnimationFrame(this.drawFrame),this.draw(),a}},requestTick:function(){this.ticking||(this.ticking=!0)},updateSizes:function(){_.each(this.marquees,function(e){e.updateSize()})},removeView:function(e){this.marquees[e]&&(this.marquees[e].remove(),delete this.marquees[e])},removeViews:function(){var e=this;_.each(this.marquees,function(t,i){t.remove(),delete e.marquees[i]})},refresh:_.debounce(function(){Cargo&&Cargo.Plugins&&Cargo.Plugins.elementResizer.requestRefreshTick()}.bind(this),100),remove:function(){cancelAnimationFrame(this.drawFrame),this.stopListening(),Backbone.View.prototype.remove.apply(this,arguments)}})}(),Cargo.Core=window.Cargo.Core||{},Cargo.Core.Handlebars={Render:function(e,t){var i=Handlebars.compile(e);return Handlebars.registerPartial("loading_animation",$("#loading_animation").html()),Handlebars.registerPartial("images",$('[type="text/x-handlebars-template"]#images').html()),Handlebars.registerPartial("page_master",this.ParseScriptTags($("#page_master").html())),Handlebars.registerPartial("page",this.ParseScriptTags($("#page").html())),Handlebars.registerPartial("pin",this.ParseScriptTags($("#pin").html())),Handlebars.registerPartial("content",this.ParseScriptTags($("#content").html())),Handlebars.registerPartial("sitemenu_item",this.ParseScriptTags($("#sitemenu_item").html())),this.RegisterHelper_Print(),this.RegisterHelper_IfAny(),this.RegisterHelper_IfAll(),this.RegisterHelper_IfEqual(),this.RegisterHelper_UnlessAny(),this.RegisterHelper_UnlessAll(),this.RegisterHelper_IfOption(),this.RegisterHelper_UnlessOption(),this.RegisterHelper_DisplayOptions(),this.RegisterHelper_Truncate(),this.RegisterHelper_Image(),this.RegisterHelper_Var(),this.RegisterHelper_Stringify(),this.RegisterHelper_IsAdmin(),this.RegisterHelper_FillDefaultThumbnailCrop(),i(t)},ParseScriptTags:function(e){if(e)return e.replace(/\[script/g,"<script").replace(/\[\/script/g,"</script")},RegisterHelper_Print:function(){Handlebars.registerHelper("print",function(e,t){var i=wrapper_tail="";"project.content"!=e&&"content"!=e||(i="<projectcontent>",wrapper_tail="</projectcontent>"),e=e.replace("project.","");var o="object"==typeof this.project?this.project:this;return new Handlebars.SafeString(i+o[e]+wrapper_tail)})},RegisterHelper_IfAny:function(){Handlebars.registerHelper("if_any",function(){for(var e=!1,t=arguments[arguments.length-1],i=arguments.length-2;i>=0;i--)if(arguments[i]){e=!0;break}return e?t.fn(this):t.inverse(this)})},RegisterHelper_IfAll:function(){Handlebars.registerHelper("if_all",function(){for(var e=!0,t=arguments[arguments.length-1],i=arguments.length-2;i>=0;i--)if(!arguments[i]){e=!1;break}return e?t.fn(this):t.inverse(this)})},RegisterHelper_IfEqual:function(){Handlebars.registerHelper("if_equal",function(e,t,i){return 3!=arguments.length?"":e==t?i.fn(this):i.inverse(this)})},RegisterHelper_UnlessAny:function(){Handlebars.registerHelper("unless_any",function(){for(var e=!1,t=arguments[arguments.length-1],i=arguments.length-2;i>=0;i--)if(!arguments[i]){e=!0;break}return e?t.fn(this):t.inverse(this)})},RegisterHelper_UnlessAll:function(){Handlebars.registerHelper("unless_all",function(){for(var e=!0,t=arguments[arguments.length-1],i=arguments.length-2;i>=0;i--)if(arguments[i]){e=!1;break}return e?t.fn(this):t.inverse(this)})},RegisterHelper_DisplayOptions:function(){Handlebars.registerHelper("displayoptions",function(e,t){var i=e.replace("display_options.","").split("."),o=i.length;return(1==o?Cargo.Model.DisplayOptions.get(i[0]):2==o?Cargo.Model.DisplayOptions.get(i[0])[i[1]]:3==o?Cargo.Model.DisplayOptions.get(i[0])[i[1]][i[2]]:Cargo.Model.DisplayOptions.get(i[0]))?t.fn(this):t.inverse(this)})},RegisterHelper_IfOption:function(){Handlebars.registerHelper("if_option",function(e,t){var i=e.replace("display_options.","").split("."),o=i.length;return(1==o?Cargo.Model.DisplayOptions.get(i[0]):2==o?Cargo.Model.DisplayOptions.get(i[0])[i[1]]:3==o?Cargo.Model.DisplayOptions.get(i[0])[i[1]][i[2]]:Cargo.Model.DisplayOptions.get(i[0]))?t.fn(this):t.inverse(this)})},RegisterHelper_UnlessOption:function(){Handlebars.registerHelper("unless_option",function(e,t){var i=e.replace("display_options.","").split("."),o=i.length;return(1==o?Cargo.Model.DisplayOptions.get(i[0]):2==o?Cargo.Model.DisplayOptions.get(i[0])[i[1]]:3==o?Cargo.Model.DisplayOptions.get(i[0])[i[1]][i[2]]:Cargo.Model.DisplayOptions.get(i[0]))?t.inverse(this):t.fn(this)})},RegisterHelper_Truncate:function(){Handlebars.registerHelper("truncate",function(e,t){if(e.length>t&&e.length>0){var i=e+" ";return i=e.substr(0,t),i=(i=e.substr(0,i.lastIndexOf(" "))).length>0?i:e.substr(0,t),new Handlebars.SafeString(i+"...")}return e})},RegisterHelper_Image:function(){Handlebars.registerHelper("image",function(e,t){return new Cargo.o.model.image(e).getImageByWidth(t)})},RegisterHelper_Var:function(){Handlebars.registerHelper("var",function(e,t){this[e]=t})},RegisterHelper_Stringify:function(){Handlebars.registerHelper("stringify",function(e){return JSON.stringify(e)})},RegisterHelper_IsAdmin:function(){Handlebars.registerHelper("is_admin",function(e){var t=arguments[arguments.length-1];return Cargo.Helper.IsAdminEdit()?t.fn(this):t.inverse(this)})},RegisterHelper_FillDefaultThumbnailCrop:function(){Handlebars.registerHelper("fill_default_thumbnail_crop",function(e,t){var i,o,n,a=t.split(/x/),r=a[0]/a[1],s=e.imageModel.width/e.imageModel.height;return s<=r?(i=100,o=0,n=(1/s-1/r)/2*-100):(i=s/r*100,o=50*(1-s/r),n=0),"width: "+i+"%; margin-left: "+o+"%; margin-top: "+n+"%; height: auto;"})}},Cargo=Cargo||{},Cargo.utils=Cargo.utils||{},Cargo.utils.CargoXHR=function(e){var t=this;if($.extend(this.options={},this.defaultOptions,e),void 0===this.options.context&&(this.options.context=this),void 0===this.options.url)throw'no URL given, define "url" in the contructor\'s options object';this.retries=0,this.xhr=new XMLHttpRequest,this.xhr.addEventListener("abort",function(){t.options.abort.apply(t.options.context,arguments)},!1),this.xhr.addEventListener("error",function(){t.options.error.apply(t.options.context,arguments)},!1),this.xhr.addEventListener("load",function(){t.options.success.apply(t.options.context,arguments)},!1),this.xhr.addEventListener("loadend",function(){t.options.always.apply(t.options.context,arguments)},!1),this.xhr.upload.addEventListener("progress",function(e){t.options.progress.apply(t.options.context,arguments)},!1),this.send()},Cargo.utils.CargoXHR.prototype.send=function(){for(var e in this.xhr.open(this.options.type,this.options.url,this.options.async),this.options.headers)this.xhr.setRequestHeader(e,this.options.headers[e]);this.xhr.responseType=this.options.dataType,this.options.beforeSend.call(this,this.xhr),this.xhr.send(this.options.data)},Cargo.utils.CargoXHR.prototype.retry=function(){if(!(this.retries++<this.options.maxRetries))return this.abort(),!1;Cargo.utils.CargoXHR.prototype.send.apply(this,arguments)},Cargo.utils.CargoXHR.prototype.abort=function(){"object"==typeof this.xhr&&this.xhr.abort()},Cargo.utils.CargoXHR.prototype.defaultOptions={async:!0,beforeSend:function(e){},always:function(e){},success:function(e){},progress:function(e){},error:function(e){},abort:function(e){},type:"GET",url:void 0,dataType:"text",headers:{},data:null,context:void 0,maxRetries:5},Cargo=Cargo||{},Cargo.utils=Cargo.utils||{},function(){var e=function(){};e.prototype.start=function(e){if(!e.key&&!e.targetUrl&&!e.customReportingFunction)throw new Error("Cannot initialize: No API key, target url or custom reporting function provided.");if(!e.projectId&&!e.targetUrl&&!e.customReportingFunction)throw new Error("Cannot initialize: No project ID, target url or custom reporting function provided.");var t;this.customReportingFunction=e.customReportingFunction,this.apiKey=e.key,this.projectId=e.projectId,this.targetUrl=e.targetUrl,this.context=e.context||{},this.serviceContext={service:e.service||"web"},e.version&&(this.serviceContext.version=e.version),this.reportUncaughtExceptions=!1!==e.reportUncaughtExceptions,this.reportUnhandledPromiseRejections=!1!==e.reportUnhandledPromiseRejections,this.disabled=!!e.disabled,(t=this).reportUncaughtExceptions&&window.addEventListener("error",function(e){if(e.error){if(e.filename&&e.filename===window.location.href)return void console.info("Not reporting error originating from Custom HTML");t.report(e.error).catch(function(e){console.warn("unable to report error",e)})}})},e.prototype.report=function(e,t){if(this.disabled)return Promise.resolve(null);if(!e)return Promise.reject(new Error("no error to report"));t=t||{};var i={};i.serviceContext=this.serviceContext,i.context=this.context,i.context.httpRequest={userAgent:window.navigator.userAgent,url:window.location.href};if("string"==typeof e||e instanceof String){try{throw new Error(e)}catch(t){e=t}t.skipLocalFrames||1}var o=this.targetUrl||"https://clouderrorreporting.googleapis.com/v1beta1/projects/"+this.projectId+"/events:report?key="+this.apiKey,n=this.customReportingFunction;return i.message=function(e,t){if(e.stack)return e.stack;e.toString()}(e),n?n(i):function(e,t){var i=new XMLHttpRequest;return i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json; charset=UTF-8"),new Promise(function(e,o){i.onreadystatechange=function(){if(4===i.readyState){var n=i.status;n>=200&&n<300?e({message:t.message}):o(new Error((n?n+" http response":"network error")+" on stackdriver report"))}},i.send(JSON.stringify(t))})}(o,i)},e.prototype.setUser=function(e){this.context.user=e},Cargo.utils.errorHandler=new e,Cargo.utils.errorHandler.start({key:"AIzaSyDW2mS9nBXWtG8Nbfz-PQjFvSJFXHN2lq8",projectId:"cargo-error-reporting",service:__cargo_context__})}(),function(){var e=null;Cargo.Core.MarkerInstance=function(e){this.resizedSVGOffsetX=0,this.resizedSVGOffsetY=0,this.pageView=e,this.addSVGElementHoverOutline=_.bind(this.addSVGElementHoverOutline,this),this.removeSVGElementHoverOutline=_.bind(this.removeSVGElementHoverOutline,this),e.listenTo(e,"initial-setup",_.bind(this.setupPage,this)),e.listenTo(Cargo.Event,"elementresizer_update_complete",_.bind(this.positionTetheredNodes,this)),this.loadSVGWebfonts()},Cargo.Core.MarkerInstance.prototype.hoverStatesEnabled=!1,Cargo.Core.MarkerInstance.prototype.setupPage=function(){this.findTetherTargets(),this.positionTetheredNodes(),this.pageView.listenTo(Cargo.Event,"image_gallery_rendered",_.bind(function(){this.findTetherTargets(),this.positionTetheredNodes()},this)),this.pageView.listenTo(Cargo.Event,"image_gallery_init_complete",_.bind(function(){this.positionTetheredNodes()},this))},Cargo.Core.MarkerInstance.prototype.enableSVGHoverStates=function(){if(null===e){var t=document.createElement("div");e=document.createElement("div"),t.className="marker-outline-layer",e.className="marker-outline-box",t.appendChild(e),document.body.appendChild(t)}this.svg_overlay&&(this.svg_overlay.addEventListener("mouseover",this.addSVGElementHoverOutline),this.svg_overlay.addEventListener("mouseout",this.removeSVGElementHoverOutline)),this.hoverStatesEnabled=!0},Cargo.Core.MarkerInstance.prototype.disableSVGHoverStates=function(t){this.svg_overlay&&(this.svg_overlay.removeEventListener("mouseover",this.addSVGElementHoverOutline),this.svg_overlay.removeEventListener("mouseout",this.removeSVGElementHoverOutline)),t||(null!==e&&this.removeSVGElementHoverOutline(),this.hoverStatesEnabled=!1)},Cargo.Core.MarkerInstance.prototype.addSVGElementHoverOutline=function(t){var i=t.target;"a"===i.parentNode.nodeName&&(i=i.parentNode);var o=i.getAttribute("stroke-width"),n=1;"none"===i.getAttribute("stroke")||isNaN(o)||(n+=o/2);var a=i.getBoundingClientRect();e.style.left=a.left-n+"px",e.style.top=a.top-n+document.scrollingElement.scrollTop+"px",e.style.width=a.width+2*n+"px",e.style.height=a.height+2*n+"px",e.style.display="block"},Cargo.Core.MarkerInstance.prototype.resizeSVGToFitContent=function(e){if(this.svg_overlay&&this.svg_content_layer&&1!==this.svg_content_layer.children.length){var t=this.pageView.isAdminEdit?200:0,i=offsetY=0;try{var o=this.svg_content_layer.getBBox()}catch(e){return void console.warn("unable to retrieve bbox")}i=-1*(o.x-t),offsetY=-1*(o.y-t),this.svg_overlay.style.transform="translate("+-1*i+"px, "+-1*offsetY+"px)",this.svg_overlay.style.webkitTransform="translate("+-1*i+"px, "+-1*offsetY+"px)",this.svg_content_layer.setAttribute("transform","translate("+i+", "+offsetY+")"),this.svg_selector_layer&&this.svg_selector_layer.setAttribute("transform","translate("+i+", "+offsetY+")"),this.resizedSVGOffsetX=i,this.resizedSVGOffsetY=offsetY,this.svg_overlay.style.width=o.width+2*t,this.svg_overlay.style.height=o.height+2*t}},Cargo.Core.MarkerInstance.prototype.removeSVGElementHoverOutline=function(){e.style.display="none"},Cargo.Core.MarkerInstance.prototype.loadSVGWebfonts=function(){var e=_.clone(this.pageView.model.getPageOption("svg_fonts"));e&&(e.fontactive=_.bind(function(){this.positionTetheredNodes()},this),WebFont.load(e))},Cargo.Core.MarkerInstance.prototype.findTetherTargets=function(e){if(!e&&this.pageView.el.querySelector("#svgroot")&&(e=this.pageView.el.querySelector("#svgroot")),e||(e=this.pageView.el.querySelector(".marker-overlay")))return this.svg_overlay!==e&&(this.disableSVGHoverStates(!0),this.svg_overlay=e,this.svg_position_layer=this.svg_overlay,this.svg_overlay.querySelector(".marker-overlay")&&(this.svg_position_layer=this.svg_overlay.querySelector(".marker-overlay")),this.svg_content_layer=this.svg_overlay.querySelector("g.layer"),this.svg_selector_layer=this.svg_overlay.parentNode.querySelector("#selectorParentGroup"),this.resizeSVGToFitContent(),this.pageView.isAdminEdit?this.svg_overlay.addEventListener("click",function(e){Cargo.Event.trigger("marker-overlay-click",e)}):(_.each(this.svg_overlay.querySelectorAll("disabled-title"),function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","title");t.textContent="",e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e)}),this.svg_overlay.addEventListener("click",function(e){e.preventDefault();var t=e.target;if("a"===t.parentNode.nodeName&&(t=t.parentNode),"a"===t.nodeName&&t.hasAttribute("href")&&!t.hasAttribute("rel"))if(t.hasAttribute("target"))window.open(t.getAttribute("href"),t.getAttribute("target"));else document.location.href=t.getAttribute("href")})),this.hoverStatesEnabled&&this.enableSVGHoverStates()),this.tetherPairs={},this.tetherPairs[-1]={el:document.body,svgs:[]},this.tetherPairs[0]={el:this.pageView.el.querySelector(".page_content"),svgs:[]},_.each(this.pageView.el.querySelectorAll(".page_content [data-marker-id]"),function(e){var t=parseInt(e.getAttribute("data-marker-id"));if(!isNaN(t)&&e instanceof HTMLElement&&null==this.tetherPairs[t]){this.tetherPairs[t]={el:e,svgs:[]};var i=$(e).closest(".image-gallery")[0];i&&("slideshow"!==i.getAttribute("image-gallery")&&(this.tetherPairs[t].el=this.tetherPairs[t].el.parentNode),i.classList.contains("initialized")||(this.tetherPairs[t].galleryInitInProgress=!0))}},this),_.each(e.querySelectorAll("*"),function(e){if(!0===e.hasAttribute("data-marker-id")){var t=parseInt(e.getAttribute("data-marker-id"));!isNaN(t)&&e instanceof SVGElement&&this.tetherPairs.hasOwnProperty(t)&&(e.style.willChange="transform",this.tetherPairs[t].galleryInitInProgress?e.style.visibility="hidden":e.style.visibility="",this.tetherPairs[t].svgs.push({el:e,positionData:JSON.parse(e.getAttribute("data-position"))}))}},this),this.tetherPairs},Cargo.Core.MarkerInstance.prototype.positionTetheredNodes=function(){if(this.svg_overlay){var e,t,i,o,n,a,r,s,l,d,c,h,u,g,p,m,f,v=getComputedStyle(this.svg_overlay),b=this.svg_overlay.getBoundingClientRect(),y=b.left+this.resizedSVGOffsetX+parseFloat(v.paddingLeft),w=b.top+this.resizedSVGOffsetY+parseFloat(v.paddingTop);_.each(this.tetherPairs,function(v,b){if(v.svgs.length>0&&v.el){var _,C=v.el.getBoundingClientRect();for(_=0;_<v.svgs.length;_++){e=v.svgs[_];try{t=e.el.getBBox()}catch(e){return void console.warn("unable to retrieve bbox")}if(i=0,o=t.x,n=t.y,a=o+y+this.resizedSVGOffsetX,r=n+w+this.resizedSVGOffsetY,s=e.positionData.left*C.width,l=e.positionData.top*C.height,d=e.positionData.width*C.width,c=e.positionData.height*C.height,h=d/t.width,u=c/t.height,h<0&&(s-=d),u<0&&(l-=c),g=C.left+s,p=C.top+l,m=g-a,f=p-r,!isNaN(h)&&isFinite(h)&&0!==h||(h=1),!isNaN(u)&&isFinite(u)&&0!==u||(u=1),0!=b&&-1!=b||"text"!==e.el.nodeName&&(u=h),e.el.hasAttribute("data-rotation")&&(i=parseFloat(e.el.getAttribute("data-rotation")),isNaN(i)&&(i=0)),!isNaN(m)&&!isNaN(f)){if(e.el.__marker_scale__=h,this.svg_content_layer){var S=this.svg_content_layer.transform.baseVal.consolidate().matrix.translate(o+m,n+f).scale(h,u).translate(-1*o,-1*n),x="";0!==i&&(x="rotate("+i+" "+(o+m+t.width*h/2+this.resizedSVGOffsetX)+" "+(n+f+t.height*u/2+this.resizedSVGOffsetY)+") "),x+="matrix("+S.a+", "+S.b+", "+S.c+", "+S.d+", "+S.e+", "+S.f+")",e.el.setAttribute("transform",x)}if("object"==typeof svgedit){var E=svgedit.transformlist.getTransformList(e.el);E&&E.reload&&E.reload()}}}}},this),this.resizeSVGToFitContent(),this.pageView.trigger("marker-tether-position-update",this)}},Cargo.Event.on("pageview-initialized",function(e){e.markerInstance=new Cargo.Core.MarkerInstance(e)})}(),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),o=1;o<arguments.length;o++){var n=arguments[o];if(null!=n)for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])}return i},writable:!0,configurable:!0}),window.partial=function(e,t){return _.template(e)(t)},String.prototype.toCamel=function(e){var t=this.replace(/((\_|\-)[a-z])/g,function(e){return e.toUpperCase().replace(/(\_|\-)/g,"")});return e?t.substr(0,1).toUpperCase()+t.substr(1):t};var lastT=0,timer=null;function doscroll(e,t,i){var o=e-t;return i+=(i+o/36)/o,newY=1==i?t+o:t+o*(1-Math.pow(2,-20*i/1)),i&&window.scrollTo(0,newY),i>=1||lastT==i||!i?clearTimeout(timer):timer=setTimeout("doscroll("+e+","+t+","+i+")",1),lastT=i,!1}function number_format(e,t,i,o){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var n=isFinite(+e)?+e:0,a=isFinite(+t)?Math.abs(t):0,r=void 0===o?",":o,s=void 0===i?".":i,l="";return(l=(a?function(e,t){var i=Math.pow(10,t);return""+(Math.round(e*i)/i).toFixed(t)}(n,a):""+Math.round(n)).split("."))[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,r)),(l[1]||"").length<a&&(l[1]=l[1]||"",l[1]+=new Array(a-l[1].length+1).join("0")),l.join(s)}function getQueryStringParam(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}$.fn.toggleInputError=function(e){return this.parent().toggleClass("error",e),this},window.loading_animation=function(e){return _.template($("#loading_animation").html())({extra_class:e}).replace("{{ extra_class }}","")},Cargo.o.model.css=Backbone.Model.extend({initialize:function(){},url:function(){var e=Cargo.API.Config;return e.api_path+"/"+e.Version+"/css/"+e.cargo_url}}),Cargo.o.model.set=Backbone.Model.extend({constructor:function(){Backbone.Model.prototype.constructor.apply(this,arguments)},name:"Set",url:function(){return Cargo.API.GetSingleContentPath(this.id)},initialize:function(){if(this.type="set",this.attributes.pages){this.attributes.pages=new Cargo.o.collection.content(this.attributes.pages),this.attributes.pages.server_page_count=this.get("page_count"),this.attributes.pages.each(function e(t){t&&t.attributes.pages&&!t.attributes.pages instanceof Backbone.Collection&&(t.attributes.pages=new Cargo.o.collection.content(t.attributes.pages),t.attributes.pages.server_page_count=t.get("page_count"),t.attributes.pages.each(e))})}},getModelAtIndex:function(e){return _.filter(this.get("pages").filter(Cargo.Helper.IsIndexableModel),function(t){return t.get("index")==e})[0]},recursivelyFindMissingIndexesInSet:function(e,t){var i={};if(!e||isNaN(e))return i;return t||(t={}),function o(n,a){for(var r=n.get("pages"),s=r.getMissingIndexes().reverse(),l=[],d=0;d<r.models.length;d++)if("set"===r.models[d].type){if(t.limit&&t.limit.set===n.get("id")&&r.models[d].get("index")>t.limit.index)break;for(var c=r.models[d].get("index"),h=s.length-1;h>=0&&s[h]<c&&e>0;h--)l.push(s[h]),s.splice(h,1),e--;if(!1===o.call(this,r.models[d],a+1)){if(a>0)return!1;e=0;break}}if(e>0){var u=s.reverse().slice(0,e);t.limit&&t.limit.set===n.get("id")&&(u=u.filter(function(e){return e<=t.limit.index})),e-=u.length,l=l.concat(u)}if(l.length>0&&(i[n.get("id")]={indexes:l,model:n}),t.limit&&t.limit.set===n.get("id"))return!1}.call(this,this,0),i},paginate:function(e){if(e||(e={}),!this.paginating){if(_.extend(e,{render_changes:!0}),this.get("__tag__"))return this.paginating=!0,void Cargo.View.Content.activeContentModel.get("pages").fetch(_.extend(e,{render_changes:!0,remove:!1,from_pagination:!0,success:_.bind(function(e,t,i){this.paginating=!1,Cargo.Event.trigger("tag_pagination_complete",e,t,i),this.trigger("tag_pagination_complete",e,t,i),Cargo.View.Content.checkActiveLinks()},this)}));var t=this.recursivelyFindMissingIndexesInSet(!isNaN(parseInt(e.pagination_count))&&e.pagination_count>=0?parseInt(e.pagination_count):5);this.paginateWithMissingIndexObject(t,e)}},paginateWithMissingIndexObject:function(e,t){t||(t={}),_.extend(t,{from_pagination:!0});var i=0,o=[];this.paginating=!0,_.each(e,function(e){var n=e.model.loadIndexes(e.indexes,t);n&&(i++,n.always(_.bind(function(e){o=o.concat(e),0===--i&&(this.paginating=!1,t.done&&t.done(o),$('[data-loading="page"]').hide(),Cargo.Event.trigger("pagination_complete",this,o,t))},this)))},this),0===i?this.paginating=!1:($('[data-loading="page"]').show(),Cargo.Event.trigger("pagination_start"))},loadIndexes:function(e,t){if(t||(t={}),_.extend(t,{remove:!1,merge:!1}),e.length>0){var i=!1;if(Cargo.Helper.IsAdminProjectListSorting()&&top&&top.Cargo&&top.Cargo.Collection.AdminList){i=!0;var o,n=[];if(_.each(e,function(e){(o=top.Cargo.Collection.AdminList.filter(function(t){return Cargo.Helper.IsIndexableModel(t)&&t.get("index")===e&&t.get("set_id")===this.get("id")},this)[0])&&n.push(o.get("id"))},this),n.length>0){var a=$.ajax({method:"GET",url:Cargo.API.GetPagesPath()+"?pid_list="+n.join(","),dataType:"json"});return a.done(function(e){_.each(e,function(e){(o=top.Cargo.Collection.AdminList.findWhere({id:e.id}))&&(e.sort=o.get("sort"),e.index=o.get("index"),e.set_id=o.get("set_id"),e.display=o.get("display"),e.reverse_index=o.get("reverse_index")),Cargo.Collection.Scaffolding.insertModel(e,this,t)})}),a}}if(!i)return this.get("pages").url=Cargo.API.GetContentCollectionPath()+"?set_id="+this.get("id")+"&index="+e.join(","),this.get("pages").fetch(t)}},fetchModelAtIndex:function(e,t){if(!0===isNaN(e=parseInt(e)))return!1;if(t||(t={}),!0!==t.ignore_cache){var i=this.getModelAtIndex(e);if(i)return void(t.done&&t.done(i,t))}return _.extend(t,{remove:!1,merge:!1,success:_.bind(function(e,t,i){if(t&&t[0]&&t[0].id){var o=e.get(t[0].id);o&&(Cargo.Collection.Scaffolding.insertModel(o,e,i),i.done&&i.done(o,i))}else i.error&&i.error()},this)}),this.get("pages").url=Cargo.API.GetContentCollectionPath()+"?set_id="+this.get("id")+"&index="+e,this.get("pages").fetch(t)},toJSON:function(e){var t=_.clone(this.attributes);return function e(t){t.pages&&(void 0!==t.pages.models&&(t.pages=t.pages.toJSON()),_.each(t.pages,e))}(t),t}}),Cargo.o.model.page=Backbone.Model.extend({constructor:function(){Backbone.Model.prototype.constructor.apply(this,arguments)},initialize:function(){this.type="page",this.busySendingValues=!1,this.saveValueQueue=[],null!=this.get("page_options")&&"object"==typeof this.get("page_options")||(this.attributes.page_options={}),this.on("change:images",this.addImagesToGlobalCollection,this),this.addImagesToGlobalCollection(),this.on("change:title",function(){void 0!==Cargo.contentWindow&&Cargo.contentWindow.Cargo.Event.trigger("page_model_change:title",this.get("id"),this.get("title"))})},addImagesToGlobalCollection:function(){if(Cargo.Collection.Images&&this.get("images")){var e=Cargo.Collection.Images.add(this.get("images"));this.attributes.images=e}},toJSON:function(e){var t=_.clone(this.attributes);return function e(t){t.pages&&(void 0!==t.pages.models&&(t.pages=t.pages.toJSON()),_.each(t.pages,e))}(t),t},url:function(){return Cargo.API.GetSinglePagePath(this.id)},saveValue:function(e,t,i){if(!0!==i&&this.set(e),this.busySendingValues){console.info("saveValue, still handling previous request. Queuing.",e);var o=_.where(this.saveValueQueue,{keys:_.keys(e).join(",")})[0];return o?(o.data=e,o.callback=t,!1):(this.saveValueQueue.push({data:e,callback:t,keys:_.keys(e).join(",")}),!0)}return this.busySendingValues=!0,this.save(e,{patch:!0,success:_.bind(function(){t&&t.call(),this.busySendingValues=!1,this.saveValueQueue.length>0&&(this.saveValue(this.saveValueQueue[0].data,this.saveValueQueue[0].callback,!0),this.saveValueQueue.shift()),e.hasOwnProperty("title")&&this.fetch()},this)}),!0},GetThumbnailCropData:function(){var e=this.get("thumb_meta");return e?e.thumbnail_crop:null},SetThumbnailCropData:function(e){var t=this.get("thumb_meta")||{};t.thumbnail_crop=e,this.set("thumb_meta",t)},GetId:function(){return this.get("id")},GetProjectUrl:function(){return this.get("project_url")},GetType:function(){return!(!this.get("type")||0==this.get("id"))&&this.get("type")},GetBgColor:function(){return!!this.get("bgcolor")&&"#"+this.get("bgcolor")},setPageOption:function(e,t,i){return null!=this.get("page_options")&&"object"==typeof this.get("page_options")||(this.attributes.page_options={}),this.get("page_options")[e]=t,this.set("page_options",this.get("page_options"),i)},getPageOption:function(e){if(null!=this.get("page_options")&&"object"==typeof this.get("page_options"))return this.get("page_options")[e]},setPinOptions:function(e,t){var i;(i=this.getPageOption("pin_options"))||(i={}),i[e]=t,this.setPageOption("pin_options",i),(i=this.get("pin_options"))||(i={}),i[e]=t,this.set("pin_options",i),this.set("pin_changed",!0),this.trigger("pin_option_change",e,t)},getPinOption:function(e){if(null!=this.get("pin_options")&&"object"==typeof this.get("pin_options"))return this.get("pin_options")[e]},getLayoutOption:function(e){var t=this.getPageOption("local_layout_options");return t&&e in t?t[e]:t},setLayoutOption:function(e,t,i){var o=this.getPageOption("local_layout_options");return o||(o={}),o[e]=t,this.setPageOption("local_layout_options",o,i)},getThumbnailOption:function(e){var t=this.getPageOption("thumbnail_options");if(t&&e in t)return t[e]},setThumbnailOption:function(e,t){var i=this.getPageOption("thumbnail_options");if(i||(i={}),i[e]!==t){i[e]=t,this.setPageOption("thumbnail_options",i);var o={changing:e,value:t,mobile:!1};this.trigger("change",this,o)}},isFullyPopulated:function(){return this.attributes.hasOwnProperty("thumb")}}),Cargo.o.model.pin=Backbone.Model.extend({constructor:function(){Backbone.Model.prototype.constructor.apply(this,arguments)},initialize:function(){var e=this.get("pageView").model,t=this.getDepth(e),i=e.get("pin_options").fixed;this.set({pageModel:e,depth:i?0:t,sort:e.get("sort"),page_padding:0}),this.addEventListeners()},getPinOptions:function(){return this.get("pageModel").get("pin_options")},getDepth:function(e){var t=0;if(e&&e.get("set_id"))for(;e&&0!=e.get("set_id");)e=Cargo.Collection.Scaffolding.getModel({id:e.get("set_id")}),t++;return t},addEventListeners:function(){var e=this.get("pageView"),t=this.get("pageModel"),i=this.collection;e.listenTo(t,"change:pin",function(){!1===this.model.get("pin")&&this.remove()}),e.listenTo(t,"pin_option_change",_.bind(function(o,n,a){var r=t.getPageOption("pin_options");if(e.$el.removeClass("overlay accommodate fixed exclude_mobile exclude_desktop"),r){r.overlay&&e.$el.addClass("overlay"),r.accommodate&&e.$el.addClass("accommodate"),r.exclude_mobile&&e.$el.addClass("exclude_mobile"),r.exclude_desktop&&e.$el.addClass("exclude_desktop"),r.fixed&&e.$el.addClass("fixed");var s=this.getDepth(t),l=this.getPinOptions().fixed;this.set("depth",l?0:s)}i.trigger("update"),this.trigger("formatting_update_required")},this)),e.listenTo(e,"remove",function(){!0!==this.__prevent_model_removal__&&i.remove(this.model.get("id"),{from_pageview_removal:!0})}),this.on("remove",function(e,t,i){i&&!0!==i.from_pageview_removal&&(e.get("pageView").__prevent_model_removal__=!0,e.get("pageView").remove(),delete e.get("pageView").__prevent_model_removal__)}),e.listenTo(t,"change:set_id",_.bind(function(){var e=this.getDepth(t),i=this.getPinOptions().fixed;this.set("depth",i?0:e)},this)),e.listenTo(t,"change:sort",_.bind(function(e,t,i){this.set("sort",t)},this))}}),Cargo.o.model.display_options=Backbone.Model.extend({fetch:function(e){$("script[data-set='DisplayOptions']").html()?this.set($.parseJSON($("script[data-set='DisplayOptions']").html()),e):Backbone.Model.prototype.fetch.apply(this,arguments)},url:function(){return Cargo.API.GetDisplayOptionsPath()},GetPaginationCount:function(){return this.get("pagination_count")},GetDisableProjectScroll:function(){return this.get("disable_project_scroll")},GetImageWidth:function(){return this.get("image_width")},GetIndexRouteUrl:function(){return this.get("index_route_url")},GetIndexRouteName:function(){return this.get("index_route_name")}}),Cargo.o.model.site=Backbone.Model.extend({fetch:function(e){!0!==(e=e||{}).force_admin_fetch&&$("script[data-set='Site']").html()?this.set($.parseJSON($("script[data-set='Site']").html()),e):Backbone.Model.prototype.fetch.apply(this,arguments)},parse:function(e){return Cargo.Helper.IsAdminEdit()||(e.is_editor=Cargo.Helper.GetIsEditor()),e},url:function(){var e=Cargo.API.GetSitePath();return""!=Cargo.API.Config.filter&&(e+="?filter="+encodeURIComponent(Cargo.API.Config.filter)),e},GetId:function(){return this.get("id")},GetPresetPreviewLink:function(e){return"//"+this.get("site_url")+"."+Cargo.Helper.GetBaseCargoDomain()+"/presetpreview/"+e},GetWebsiteTitle:function(){return this.get("website_title")},GetHomepageId:function(){return this.get("homepage_id")},GetIsEditor:function(){return this.get("is_editor")},GetUseHiRes:function(){var e=this.get("use_hi_res");return null==e&&(e=window.devicePixelRatio>1),e}}),Cargo.o.model.image=Backbone.Model.extend({initialize:function(){_.bindAll(this,"getImageByWidth")},urlRoot:function(){return"/_api/v0/image"},getImageByWidth:function(e){var t={};return e>this.get("width")&&(e=this.get("width")),t.w=e,this.getImageWithOptions(t).url},getImageByWidth2x:function(e){return this.getImageByWidth(2*e)},getImageWithOptions:function(e){var t={retina:!!window.devicePixelRatio&&window.devicePixelRatio>=1.2,square:!1,url:"",webgl:e.hasOwnProperty("t")&&"webgl"==e.t};if(_.extend(t,e),"original"===t.t&&(t.retina=!1),!0!==t.retina||t.webgl||(null==t.q&&(t.q=75),t.hasOwnProperty("w")&&(t.w=Math.min(2*t.w,this.get("width"))),t.hasOwnProperty("h")&&(t.h=Math.min(2*t.h,this.get("height")))),t.w&&t.w>this.get("width")&&(t.webgl?t.w=this.getValidWebGLSize(t.w):t.w=this.get("width")),t.h&&t.h>this.get("height")&&(t.h=this.get("height")),!0===t.square){var i=this.getSquareCrop();t.c={x:i.x,y:i.y,w:i.w,h:i.h}}var o=["t","w","h","q","c"],n=[],a=!1,r=!1;_.each(t,function(e,t){-1!==o.indexOf(t)&&""!==e&&("c"===t?n.push("c/"+e.x+"/"+e.y+"/"+e.w+"/"+e.h):n.push(t+"/"+e),a="w"==t?e:"c"==t&&e.w?e.w:a,r="h"==t?e:"c"==t&&e.h?e.h:r)},this);var s=this.getScaleSize(a,r);return t.w=s.w,t.h=s.h,void 0!==this.get("hash")&&void 0!==this.get("name")?t.url="//freight.cargo.site/"+n.join("/")+"/i/"+this.get("hash")+"/"+this.get("name"):t.url="",t},getSquareCrop:function(){var e=y=w=h=diff=0;return this.get("height")>this.get("width")?(w=h=this.get("width"),diff=this.get("height")-this.get("width"),y=Math.floor(diff/2),e=0):this.get("width")>this.get("height")?(w=h=this.get("height"),diff=this.get("width")-this.get("height"),e=Math.floor(diff/2),y=0):(w=this.get("width"),h=this.get("height"),e=y=0),{w:w,h:h,x:e,y:y}},getOriginalImage:function(){return this.getImageWithOptions({t:"original",retina:!1})},urlBelongsToImage:function(e){return"string"==typeof e&&-1!==e.indexOf(this.get("hash")+"/"+this.get("name"))},getValidWebGLSize:function(e){return e>this.get("width")&&_.each([128,256,512,1024,2048,4096],function(t){t<1e3&&(e=t)}),e},getScaleSize:function(e,t){var i=e,o=t;if(og_w=parseInt(this.get("width")),og_h=parseInt(this.get("height")),e&&t);else if(og_w==og_h)o=i=e||(t||og_w);else if(e){var n=og_w/e;o=Math.floor(og_h/n),i=e}else if(t)n=og_h/t,i=Math.floor(og_w/n),o=t;return{w:i,h:o}},getFitSize:function(e,t,i,o){if(e=parseInt(e),(t=parseInt(t))>e)var n=e/i,a=Math.floor(t/n),r=i;else if(e>t)n=t/o,r=Math.floor(e/n),a=o;else r=e,a=t;return[r,a]}}),Cargo.o.model.localImage=Cargo.o.model.image.extend({blob_references:{},canvas:null,initialize:function(){this.blob_references={},this.canvas=document.createElement("canvas"),_.bindAll(this,"getImageByWidth")},urlRoot:function(){return""},getImageWithOptions:function(e){var t=Cargo.o.model.image.prototype.getImageWithOptions.apply(this,arguments),i=["t","w","h","q","c"],o=[],n=!1,a=!1;_.each(t,function(e,t){-1!==i.indexOf(t)&&""!==e&&("c"===t?o.push("c_"+e.x+"_"+e.y+"_"+e.w+"_"+e.h):o.push(t+"_"+e),n="w"==t?e:"c"==t&&e.w?e.w:n,a="h"==t?e:"c"==t&&e.h?e.h:a)},this);var r=o.join("_");if(this.blob_references.hasOwnProperty(r))t.url=this.blob_references[r];else{if("original"==t.t)this.canvas.setAttribute("width",this.get("width")),this.canvas.setAttribute("height",this.get("height")),this.canvas.getContext("2d").drawImage(this.get("img"),0,0,this.get("width"),this.get("height"));else if(t.hasOwnProperty("c")){var s=Math.max(Math.min(t.c.w,this.get("width")-t.c.x),0),l=Math.max(Math.min(t.c.w,this.get("height")-t.c.y),0);this.canvas.setAttribute("width",s),this.canvas.setAttribute("height",l),this.canvas.getContext("2d").drawImage(this.get("img"),-t.c.x,-t.c.y,this.get("width"),this.get("height"))}else t.webgl?(this.canvas.setAttribute("width",t.webgl),this.canvas.setAttribute("height",t.webgl),this.canvas.getContext("2d").drawImage(this.get("img"),0,0,t.webgl,t.webgl),this.canvas.setAttribute("width",t.w),this.canvas.setAttribute("height",t.h),this.canvas.getContext("2d").drawImage(this.get("img"),0,0,t.w,t.h)):(this.canvas.setAttribute("width",t.w),this.canvas.setAttribute("height",t.h),this.canvas.getContext("2d").drawImage(this.get("img"),0,0,t.w,t.h));this.canvas.toBlob(_.bind(function(e){this.blob_references[r]=URL.createObjectURL(e)},this)),t.url=this.canvas.toDataURL()}return t},urlBelongsToImage:function(e){if("string"!=typeof e)return!1;var t=!1;return _.each(this.blob_references,function(i,o){i!=e||(t=!0)},this),t}}),Cargo.o.model.tag=Backbone.Model.extend({initialize:function(){this.responseCache={},this.isAdmin=Cargo.Helper.IsAdminEdit()},tag_url:"",url:function(){return Cargo.API.GetSitePath()+"/tags/"+this.tag_url},fetch:function(e){e=e||{},_.defaults(e,{});var t=this.url();if(this.responseCache.hasOwnProperty(t))return this.set(this.responseCache[t]),this.trigger("sync"),void("function"==typeof e.success&&e.success.call(e.context,this,this.responseCache[t],e));e.success=_.wrap(e.success,_.bind(function(i,o,n){!0!==this.isAdmin&&(this.responseCache[t]=n);var a=Array.prototype.slice.call(arguments);a.shift(),i&&i.apply(e.context,a)},this)),Backbone.Model.prototype.fetch.apply(this,arguments)}}),Cargo.o.model.thumbnailsettings=Backbone.Model.extend({page_id:null,mode_id:null,iterator:null,initialize:function(e){this.page_id=e&&e.page_id?e.page_id:this.page_id,this.mode_id=e&&e.mode_id?e.mode_id:this.mode_id,this.iterator=e&&e.iterator?e.iterator:this.iterator},fetch:function(e){$("script[data-set='ThumbnailSettings']").html()?(this.set($.parseJSON($("script[data-set='ThumbnailSettings']").html()),e),$("script[data-set='ThumbnailSettings']").remove()):Backbone.Model.prototype.fetch.apply(this,arguments)},url:function(){return Cargo.API.GetActiveThumbnailSettingsPath(this.page_id,this.mode_id,this.iterator,this.id)},getTemplatePath:function(e){return"/_jsapps/thumbnails/"+(e=e||this.get("path"))+"/thumbnail.handlebars"},setThumbMeta:function(e,t){window.parent.Cargo.Event.trigger("thumbnail:add_meta_data",e,t)}}),Cargo.o.collection.content=Backbone.Collection.extend({name:"Content",constructor:function(){this.server_page_count=0,this.on("add",function(e,t,i){i.from_admin_sort&&Cargo.Helper.IsIndexableModel(e)&&this.server_page_count++},this),this.on("remove",function(e,t,i){i.from_admin_sort&&Cargo.Helper.IsIndexableModel(e)&&this.server_page_count--},this),Backbone.Collection.prototype.constructor.apply(this,arguments)},initialize:function(){},comparator:"sort",model:function(e,t){return new Cargo.o.model[e.pages?"set":"page"](e,t)},isGlobal:!0,CollectionData:{},url:function(){return Cargo.API.GetPagesPath()},LoadCollection:function(e){if(!1!==Cargo.Helper.isFeed()&&(!0!==this.isGlobal||"global"!=e))if(e&&this.CollectionData[e])this.set(this.CollectionData[e]),!1===this.isGlobal&&"global"!=e?(this.trigger("sync"),this.isGlobal=!0):!0===this.isGlobal&&"global"!=e&&(this.trigger("sync"),this.isGlobal=!1);else if(e)this.tags=e,this.fetch(),this.tags=null,this.isGlobal=!1;else{if(!0===this.isGlobal)return;this.set(this.CollectionData.global),this.trigger("sync"),this.isGlobal=!0}},getLoadedIndexes:function(){return _.without(this.map(function(e){if(Cargo.Helper.IsIndexableModel(e))return e.get("index")},this),void 0)},getMissingIndexes:function(e){for(var t=this.getLoadedIndexes(),i=[],o=0;o<this.server_page_count;){if(e&&o>e)return i;-1==t.indexOf(o)&&i.push(o),o++}return i},missingNumInSequence:function(e,t,i){if(void 0!==e&&void 0!==e.length){if(void 0===t&&(t=0),void 0===i&&(i=e.length),t>=i)return t;var o=Math.floor((t+i)/2);return e[o]===o?this.missingNumInSequence(e,o+1,i):this.missingNumInSequence(e,t,o)}},getFirstIndexGap:function(){var e=_.uniq(this.getLoadedIndexes(),!0);return this.missingNumInSequence(e)},each:function(e,t,i){if(!i)return Backbone.Collection.prototype.find.apply(this,arguments);(function i(o){o.each(e,t);for(var n=0;n<o.models.length;n++)"set"===o.models[n].type&&i(o.models[n].get("pages"))})(this)},getContentOrPageModelByPid:function(e,t){var i=this.getModel({id:e});return i&&t&&i.parent_model&&i.parent_model.get("stack")&&(i=i.parent_model),i},getContentOrPageModelByPurl:function(e,t){var i=this.getModel({project_url:e});if(!i){var o=this.getModel({project_url:e});o&&t&&o.parent_model&&o.parent_model.get("stack")&&(i=o.parent_model)}return i},getModel:function(e){return this.findWhere(e,!0)},getHomePageModel:function(){return this.getContentOrPageModelByPid(Cargo.Helper.GetHomepageId())},getAllContentPageIds:function(){var e=this.reject(function(e){if(e.get("pin")||0==e.get("pages").length)return e});return _.pluck(e,"id")},fetchPageModel:function(e){var t=this;return new Cargo.o.model.set({id:e}).fetch({error:function(i,o){try{if("no pid found"===$.parseJSON(o.responseText).message.toLowerCase()){var n=Cargo.Collection.Tags.findTagByUrl(e);n?(t.LoadCollection(n.get("url")),Cargo.Event.trigger("thumbnails:load_tag",n.get("url")),Cargo.View.Content.hideActiveView()):(Cargo.Modal.Alert({message:"Page Not Found",confirm:function(){window.history.back()}}),Cargo.Helper.HideLoadingAnimation())}}catch(e){console.error("unable to fetch",i)}},success:function(e,i,o){"set"===e.type&&void 0===e.get("pages")&&(e=new Cargo.o.model.page(e.toJSON())),t.insertModel(e,i,o)}})},insertModel:function(e,t,i){if(e.get("set_id")){var o=this.getModel({id:e.get("set_id")});if(o)return o.get("pages").add(e),o.get("pages").sort(),this.trigger("add",e,t,i),void this.trigger("offline_model_loaded",e)}this.add(e),this.trigger("offline_model_loaded",e)},removeNonVisiblePages:function(){var e=_.filter(this.getAllPages(),function(e){return!1===e.get("display")&&!1===e.get("pin")});_.each(_.pluck(e,"id"),_.bind(function(e){var t=this.findWhere({id:e});if(t&&!t.get("is_set"))this.remove(t,{silent:!0});else{var i=this.findWhere({id:e},!0);i&&(1==i.parent_model.get("pages").length?this.remove(i.parent_model,{silent:!0}):i.parent_model.get("pages").remove(i,{silent:!0}))}},this))},findWhere:function(e,t){return t=t||!1,this.where(e,!0,t)},where:function(e,t,i){return(i=i||!1)?this[t?"find":"filter"](e,i):Backbone.Collection.prototype.where.call(this,e,t)},find:function(e,t){if(t=t||!1){var i,o;return function t(n){if(i=n.findWhere(e))(o=i).parent_model=n;else for(var a=0;a<n.models.length;a++)if("set"===n.models[a].type){if(i=n.models[a].get("pages").findWhere(e)){(o=i).parent_model=n.models[a];break}"set"===n.models[a].type&&t(n.models[a].get("pages"))}}(this),o}return Backbone.Collection.prototype.find.call(this,e)},getAllPages:function(e){var t=[];return function i(o){for(var n=0;n<o.models.length;n++)"page"!==o.models[n].type?o.models[n].get("pages")&&o.models[n].get("pages").models&&(e&&"set"===o.models[n].type&&t.push(o.models[n]),i(o.models[n].get("pages"))):t.push(o.models[n])}(this),t},filter:function(e,t){if(t=t||!1){var i=[];return function t(o){i=_.union(i,o.filter(e));for(var n=0;n<o.models.length;n++)"set"===o.models[n].type&&t(o.models[n].get("pages"))}(this),i}return Backbone.Collection.prototype.filter.call(this,e)}}),Cargo.o.collection.scaffolding=Backbone.Collection.extend({name:"Scaffolding",constructor:function(){Backbone.Collection.prototype.constructor.apply(this,arguments)},comparator:"sort",model:function(e,t){return new Cargo.o.model[e.pages?"set":"page"](e,t)},url:function(){return Cargo.API.GetPagesPath()},initialize:function(){this.fetchPageModelCache={},this.isAdmin=Cargo.Helper.IsAdminEdit()},applyAdminlistChangeMap:function(e,t){var i,o={};this.each(function(t){void 0!==e[t.get("id")]&&(void 0!==(i=e[t.get("id")]).sort&&t.set("sort",i.sort,{from_admin_sort:!0}),void 0!==i.index&&t.set("index",i.index,{from_admin_sort:!0}),void 0!==i.reparented&&(o[t.get("id")]={new_set:i.reparented.to,model:t}),delete e[t.get("id")])},this,!0),_.each(o,function(e,t){var i=e.model,o=this.getModel({id:i.get("set_id")}),n=this.getModel({id:e.new_set});void 0!==o&&void 0!==n&&(o.get("pages").remove(i,{from_admin_sort:!0}),i.set("set_id",n.get("id")),this.insertModel(i,this,{from_admin_sort:!0,render_changes:!0}))},this),_.each(e,function(e){if(void 0!==e.reparented&&e.reparented.indexable){var t=this.getModel({id:e.reparented.from}),i=this.getModel({id:e.reparented.to});t&&t.get("pages").server_page_count--,i&&i.get("pages").server_page_count++}},this),Cargo.View.Content.currentSet&&(_.each(_.union([Cargo.View.Content.currentSet],Cargo.View.Content.currentSet.getAllSetViews()),function(e){e.sortPagesAndUpdateDOM()}),_.each(Cargo.View.Content.currentSet.getAllPageViews(),function(e){e.addBackdrop()}),"display_state"!==t&&Cargo.View.Content.fillGapsInCurrentSet()),Cargo.Event.trigger("refresh_pins")},fetch:function(e){if($("[data-set='ScaffoldingData']").length>0){var t=JSON.parse($("[data-set='ScaffoldingData']").html());this.set(t),$("[data-set='ScaffoldingData']").remove()}else Backbone.Collection.prototype.fetch.apply(this,arguments)},parse:function(e,t){return _.each(e,function(e){var i=this._prepareModel(e,t);i&&this.insertModel(i,this,t)},this),[]},LoadTagCollection:function(e){var t=new Cargo.o.model.set({id:e.get("url"),pages:[],project_url:e.get("url"),__tag__:e.get("url"),title:e.get("tag")});!1===Cargo.Helper.isFeed()?(t.get("pages").url="",t.get("pages").fetch=function(){console.info("no paginate for non-feed tags")},Cargo.View.Content.render(t),Cargo.Event.trigger("thumbnails:load_tag",e.get("url")),Cargo.View.Main.SetWindowTitle()):(t.__offset=0,t.__increment=5,t.get("pages").url=function(){var e=Cargo.API.GetPagesPath(t.get("__tag__"),t.__offset,t.__increment);return t.__offset+=t.__increment,e},t.get("pages").on("add",function(e){this.insertModel(e,this,{render_changes:!1})},this),t.attributes.pages.fetch({success:function(e){Cargo.View.Content.render(t),Cargo.View.Main.SetWindowTitle()}}))},getSetOrPageModel:function(e,t){var i=this.getModel(e);return i&&t&&i.parent_model&&i.parent_model.get("stack")&&(i=i.parent_model),i},getContentOrPageModelByPid:function(e,t){var i=this.getModel({id:e});return i&&t&&i.parent_model&&i.parent_model.get("stack")&&(i=i.parent_model),i},getModelByPurl:function(e,t){if(void 0!==e){var i=this.filter(function(t){return"string"==typeof t.get("project_url")&&t.get("project_url").toLowerCase()===(e+"").toLowerCase()},!0)[0];return i&&t&&i.parent_model&&i.parent_model.get("stack")&&(i=i.parent_model),i}},getModel:function(e){return this.findWhere(e,!0)},getHomePageModel:function(){return this.getContentOrPageModelByPid(Cargo.Helper.GetHomepageId())},getAllContentPageIds:function(){var e=this.reject(function(e){if(e.get("pin")||0==e.get("pages").length)return e});return _.pluck(e,"id")},getPinsByPositionSetId:function(e,t){if(Number(t)){var i=[];if(!(o=this.getModel({id:t})))return;if("page"===o.type){if(0===o.get("set_id"))return;if(!(o=this.getModel({id:o.get("set_id")})))return}for(i=i.concat(o.get("pages").models);o&&0!=o.get("set_id")&&0!=o.get("id");)(o=this.getModel({id:o.get("set_id")}))&&o.get("pages")&&(i=i.concat(o.get("pages").models));return _.filter(i,function(t){return t.get("pin")&&t.get("pin_options")&&t.get("pin_options").position==e})}if(!1===t){var o;i=[];return(o=this.getModel({id:0})).get("pages").filter(function(t){return t.get("pin")&&t.get("pin_options")&&t.get("pin_options").position==e})}},fetchPageModel:function(e,t){var i=this.fetchPageModelCache[e];if(i)return this.insertModel(i,this,t),void(t.done&&t.done(i,t));var o,n=this;o=new Cargo.o.model.set({id:e}),t||(t={});var a=t.error;return _.extend(t,{error:function(i,o){try{if(404==o.status){var r=Cargo.View.Content.getActiveContentModel();r&&r.get("is_set")&&r.get("id");var s=Cargo.Collection.Tags.findTagByUrl(e);s?n.LoadTagCollection(s):(!0!==t.silent&&Cargo.Modal.Alert({message:"Page Not Found",confirm:function(){window.event&&27===window.event.keyCode||window.history.back()}}),Cargo.Helper.HideLoadingAnimation(),"function"==typeof a&&a.apply(this,arguments))}else 401==o.status&&(!1!==t.render_changes&&window.location.replace(window.location.href),"function"==typeof a&&a.apply(this,arguments))}catch(e){console.error(e),console.warn("unable to fetch",i)}},success:function(t,i,o){if(Cargo.Helper.IsAdminProjectListSorting()&&top&&top.Cargo&&top.Cargo.Collection.AdminList){var a=top.Cargo.Collection.AdminList.findWhere({id:t.get("id")});a&&(t.attributes.sort=a.get("sort"),t.attributes.index=a.get("index"),t.attributes.set_id=a.get("set_id"),t.attributes.display=a.get("display"))}"set"===t.type&&void 0===t.get("pages")&&(t=new Cargo.o.model.page(t.toJSON()),n.isAdmin||(n.fetchPageModelCache[e]=t)),n.insertModel(t,n,o),o.done&&o.done(t,o)}}),o.fetch(t)},insertModel:function(e,t,i){if(!1!==(i=i||{}).insert){var o=e;if("function"==typeof e.get&&(o=e.attributes),void 0!==o.set_id){var n=this.getModel({id:o.set_id});if(n){var a=n.get("pages");if(a.get(e))return;return a.add(e,i),a.sort(),e.collection=a,void this.trigger("add",e,a,i)}}this.add(e)}},removeNonVisiblePages:function(){non_visible=_.filter(this.getAllPages(),function(e){return!1===e.get("display")&&!1===e.get("pin")&&!1===e.get("is_homepage")}),_.each(non_visible,function(e){this.getModel({id:e.get("set_id")}).get("pages").remove(e)},this)},changeDisplayStateForPID:function(e,t){var i=this.getModel({id:e});i?(i.set("display",t),!1===t&&this.getModel({id:i.get("set_id")}).get("pages").remove(i)):this.fetchPageModel(e,{render_changes:!0})},findWhere:function(e,t){return t=t||!1,this.where(e,!0,t)},where:function(e,t,i){return(i=i||!1)?this[t?"find":"filter"](e,i):Backbone.Collection.prototype.where.call(this,e,t)},logIndexStructure:function(){console.log("\n----\n\n"),function e(t,i){t.getMissingIndexes;for(var o=0;o<t.models.length;o++)Cargo.Helper.IsIndexableModel(t.models[o])&&(console.log("---".repeat(i)+"index:",t.models[o].get("index"),"sort:",t.models[o].get("sort"),"-",t.models[o].type+":",t.models[o].get("title").substring(0,70)),"set"===t.models[o].type&&e(t.models[o].get("pages"),i+1))}(this,0)},getSetStructure:function(e){var t={tree:void 0,_byId:{}},i=function(o,n){for(var a=0;a<o.length;a++)o[a].pages&&(e&&!0!==e(o[a])||(t._byId[o[a].id]=o[a]),o[a].depth=n,o[a].pages=_.where(o[a].pages,{is_set:!0}),i(o[a].pages,n+1))};return i(this.toJSON(),0),t.tree=t._byId[0],t},each:function(e,t,i){if(!i)return Backbone.Collection.prototype.find.apply(this,arguments);(function i(o){o.each(e,t);for(var n=0;n<o.models.length;n++)"set"===o.models[n].type&&i(o.models[n].get("pages"))})(this)},find:function(e,t){if(t=t||!1){var i,o;return function t(n){if(i=n.findWhere(e))(o=i).parent_model=n;else for(var a=0;a<n.models.length;a++)if("set"===n.models[a].type){if(i=n.models[a].get("pages").findWhere(e)){(o=i).parent_model=n.models[a];break}"set"===n.models[a].type&&t(n.models[a].get("pages"))}}(this),o}return Backbone.Collection.prototype.find.call(this,e)},getAllPages:function(e){var t=[];return function i(o){for(var n=0;n<o.models.length;n++)"page"!==o.models[n].type?o.models[n].get("pages")&&o.models[n].get("pages").models&&(e&&"set"===o.models[n].type&&t.push(o.models[n]),i(o.models[n].get("pages"))):t.push(o.models[n])}(this),t},filter:function(e,t){if(t=t||!1){var i=[];return function t(o){i=_.union(i,o.filter(e));for(var n=0;n<o.models.length;n++)"set"===o.models[n].type&&t(o.models[n].get("pages"))}(this),i}return Backbone.Collection.prototype.filter.call(this,e)}}),Cargo.o.collection.images=Backbone.Collection.extend({model:function(e,t){return e&&"local"===e.type?new Cargo.o.model.localImage(e,t):new Cargo.o.model.image(e,t)},responseCache:{},initialize:function(){},url:function(){var e=!!this.options&&this.options.sort;return Cargo.API.GetImagesPath(e,!0,!0)},fetchNextPage:function(e){var t=this.url+"-"+this.length;this.fetch({remove:!1,data:{offset:this.length},success:_.bind(function(i,o,n){this.responseCache[t]=o,"function"==typeof e&&e(i,o,n)},this)})},fetch:function(e){var t=e&&e.data&&e.data.offset?e.data.offset:0,i=this.url+"-"+t;return this.responseCache.hasOwnProperty(i)?(0==t?this.set(this.responseCache[i]):this.add(this.responseCache[i]),"function"==typeof e.success&&e.success.call(e.context,this,this.responseCache[i],e),void this.trigger("sync",this,this.responseCache[i])):Backbone.Collection.prototype.fetch.apply(this,arguments)},getImagesWithoutDuplications:function(){var e=[];return this.filter(function(t){return-1===e.indexOf(t.get("hash"))&&(e.push(t.get("hash")),!0)})},fetchImage:function(e,t){var i=this.findWhere({id:parseInt(e)});if(i)return i.getImageWithOptions({w:t})},fetchWebGLImage:function(e,t){var i=this.findWhere({id:parseInt(e)});if(i)return i.getImageWithOptions({t:"webgl",w:t})},fetchOriginalImage:function(e){var t=this.findWhere({id:parseInt(e)});if(t)return t.getOriginalImage()}}),Cargo.o.collection.pins=Backbone.Collection.extend({model:Cargo.o.model.pin,comparator:function(e,t){var i=e.getPinOptions(),o=t.getPinOptions(),n=e.get("pageModel").get("sort"),a=t.get("pageModel").get("sort");if(e.get("depth")!==t.get("depth"))if("bottom"===this.position){if(e.get("depth")>t.get("depth"))return-1;if(e.get("depth")<t.get("depth"))return 1}else{if(e.get("depth")>t.get("depth"))return 1;if(e.get("depth")<t.get("depth"))return-1}else if(n!==a){if(i.overlay&&(this.position===this.reversedSide?n+=9e5:n-=9e5),o.overlay&&(this.position===this.reversedSide?a+=9e5:a-=9e5),n>a)return 1;if(n<a)return-1}return 0},initialize:function(e,t){this.position=t.position,this.reversedSide="bottom",this.pid_list=[],this.debouncedSort=_.debounce(this.sort,0),this.on("reset",this.onReset),this.on("add",this.onAdd),this.on("remove",this.onRemove),this.on("update reset change:sort change:depth",this.onChange)},sort:function(){Backbone.Collection.prototype.sort.apply(this,arguments)},onReset:function(e,t){_.each(t.previousModels,function(e){e.trigger("remove")})},onChange:function(e,t){this.sort(),this.pid_list=this.pluck("id"),this.levels={},this.deepestLevel=0,this.each(function(e){void 0===this.levels[e.get("depth")]&&(this.levels[e.get("depth")]={models:[]}),e.get("depth")>this.deepestLevel&&(this.deepestLevel=e.get("depth")),this.levels[e.get("depth")].models.push(e)},this)},onAdd:function(e,t,i){e.get("pageView").listenTo(e.get("pageModel"),"change:sort",_.bind(this.debouncedSort,this))},onRemove:function(e,t,i){}}),Cargo.o.collection.tags=Backbone.Collection.extend({initialize:function(){},url:function(){return Cargo.API.GetSitePath()+"/tags"},findTagByUrl:function(e){if("string"!=typeof e||""==e||0===e.indexOf("search/"))return!1;if(/(\s|,|\+|\~)/.test(e))return Cargo.Model.Tag.set("url",e),Cargo.Model.Tag;var t=!1;return Cargo.Model.Tag.tag_url=e,Cargo.Model.Tag.fetch({async:!1,success:function(e,i){t=0!==_.keys(i).length&&e}}),t},fetch:function(){if($("[data-set='TagsCollection']").length>0){var e=JSON.parse($("[data-set='TagsCollection']").html());this.set(e),$("[data-set='TagsCollection']").remove()}else Backbone.Collection.prototype.fetch.apply(this,arguments)}}),Cargo.o.collection.sitemenu=Backbone.Collection.extend({initialize:function(){Cargo.Event.on("page_model_change:title",_.bind(function(e,t){this.updatePageTitle(e,t)},this))},url:function(){var e=Cargo.Helper.IsAdminEdit()?"/inadmin":"";return Cargo.API.GetSitePath()+"/sitemenu"+e},fetch:function(e){if(!$("script[data-set='SiteMenu']").html())return Backbone.Collection.prototype.fetch.apply(this,arguments);this.set($.parseJSON($("script[data-set='SiteMenu']").html()),e),$("script[data-set='SiteMenu']").remove()},getAllPages:function(){var e=[];return void 0!==this.models[0]&&function t(i){_.each(i,function(i){i.hasOwnProperty("pages")?(e.push(i),t(i.pages)):e.push(i)})}(this.models[0].get("pages")),e},updatePageTitle:function(e,t){var i=_.filter(this.getAllPages(),function(t){return t.id==e});void 0!==i[0]&&(i[0].project_url=t,i[0].title=t)}}),Cargo.o.collection.thumbnailmodes=Backbone.Collection.extend({initialize:function(){},url:function(){return Cargo.API.GetThumbnailModesPath()},fetch:function(e){$("script[data-set='ThumbnailModes']").html()?this.set($.parseJSON($("script[data-set='ThumbnailModes']").html()),e):Backbone.Collection.prototype.fetch.apply(this,arguments)}}),Cargo.o.collection.thumbnails=Backbone.Collection.extend({initialize:function(e){this.paginating=!1,this.responseCache={},this.currentParams={},this.paginationIncrement=50,this.paginationComplete=!1,Cargo.Event.on("admin_page_update",_.bind(function(e,t){var i=this.findWhere({id:e});i&&i.set(JSON.parse(JSON.stringify(t)))},this)),Cargo.Event.on("thumbnails:clear_cache",function(){this.url=void 0,this.responseCache={}},this);var t=$("[data-set='FirstloadThumbnails']");if(t.length>0){var i=JSON.parse(t.html()),o={page_id:t.attr("data-page_id"),force_all:"all"===t.attr("data-filter_type")||void 0,tags:t.attr("data-tags"),set_id:t.attr("data-set_id"),random_limit:t.attr("data-random_limit"),offset:0,limit:this.paginationIncrement};void 0!==o.random_limit&&isNaN(parseInt(o.random_limit))&&(o.random_limit=10),i&&i.length?(this.url=Cargo.API.GetThumbnailsPath(o.page_id,o.force_all,o.tags,o.set_id,void 0,void 0,o.random_limit),this.responseCache[this.url]={data:i,offset:i.length,paginationComplete:i.length<this.paginationIncrement},this.currentParams=o):console.warn("Initial thumb data is invalid, not setting."),t.remove()}},paginate:function(){this.paginating||this.paginationComplete||void 0===this.currentParams.random_limit&&(this.paginating=!0,this.currentParams.offset+=this.paginationIncrement,$('[data-loading="page"]').show(),this.fetch({params:this.currentParams,remove:!1,from_pagination:!0,success:_.bind(function(e,t,i){$('[data-loading="page"]').hide(),this.paginating=!1,Cargo.Event.trigger("thumbnail_pagination_complete",e,t,i)},this),error:_.bind(function(){$('[data-loading="page"]').hide()},this)}))},applyAdminlistChangeMap:function(e,t,i){this.currentParams&&(this.currentParams&&void 0!==this.currentParams.random_limit||(void 0!==this.currentParams.set_id&&_.each(e,function(e,t){t=parseInt(t);var i=parseInt(this.currentParams.set_id);if(e.hasOwnProperty("reparented"))if(e.reparented.from==i)this.remove(t);else if(e.reparented.to==i&&top&&top.Cargo&&top.Cargo.Collection.AdminList){var o=top.Cargo.Collection.AdminList.findWhere({id:t});!0===o.get("display")&&!0===o.get("thumb_is_visible")&&this.add(o.toJSON())}},this),this.models.sort(function(e,t){return i.indexOf(e.id)-i.indexOf(t.id)}),Cargo.View.Thumbnail&&Cargo.View.Thumbnail.Subview&&Cargo.View.Thumbnail.Subview.render()))},fetch:function(e){e=e||{},_.defaults(e,{params:{}}),this.currentParams=e.params;var t,i=Cargo.API.GetThumbnailsPath(e.params.page_id,e.params.force_all,e.params.tags,e.params.set_id,void 0,void 0,e.params.random_limit);if(this.responseCache.hasOwnProperty(i)){if((t=this.responseCache[i]).paginationComplete||!0!==e.from_pagination)return this.paginationComplete=t.paginationComplete,this.set(this.responseCache[i].data),this.trigger("sync",this,this.responseCache[i].data,e),void("function"==typeof e.success&&e.success.call(e.context,this,this.responseCache[i].data,e));this.url=Cargo.API.GetThumbnailsPath(e.params.page_id,e.params.force_all,e.params.tags,e.params.set_id,t.offset,this.paginationIncrement)}if(this.url!==i)return t||(this.url=i),e.success=_.wrap(e.success,_.bind(function(o,n,a){void 0!==e.params.random_limit?this.paginationComplete=!0:this.paginationComplete=a.length<this.paginationIncrement,t?(t.data=_.union(t.data,a),t.paginationComplete=this.paginationComplete,t.offset+=a.length,this.set(t.data)):this.responseCache[i]={data:a,offset:0,paginationComplete:this.paginationComplete};var r=Array.prototype.slice.call(arguments);r.shift(),o&&o.apply(e.context,r)},this)),Backbone.Collection.prototype.fetch.apply(this,arguments)}}),Cargo.o.collection.thumbnailsettings=Backbone.Collection.extend({pid:null,model:Cargo.o.model.thumbnailsettings,initialize:function(e){e&&e.pid&&(this.pid=e.pid)},url:function(){return Cargo.API.GetAllThumbnailSettingsPath(this.pid)},fetch:function(e){$("script[data-set='AllThumbnailSettings']").html()?this.set($.parseJSON($("script[data-set='AllThumbnailSettings']").html()),e):Backbone.Collection.prototype.fetch.apply(this,arguments)}}),Cargo.o.view.Main=Backbone.View.extend({el:"body",initialize:function(){this.resolveFontTest=_.bind(this.resolveFontTest,this),this.drawTextCanvas=_.bind(this.drawTextCanvas,this),this.testIconFont(),this.loadingRandomPage=!1,this.collection.bind("change",this.render,this),"html"==Cargo.API.Config.preview?this.WriteCustomHtmlPreview():"css"==Cargo.API.Config.preview&&this.WriteCustomCSSPreview();var e=document.querySelector(".main_container");if(e&&e.addEventListener("scroll",function(){this.scrollTop=0},{passive:!0}),window.matchMedia){var t=Cargo.Helper.GetMobileWindowBreakPoint(),i=window.matchMedia("(min-width: "+t+"px)");i.addListener(function(e){setTimeout(function(){Cargo.Event.trigger("mobile_breakpoint_triggered",i.matches)})})}Cargo.Helper.IsAdminEdit()&&this.$el.attr("data-adminview","true")},events:{"click [rel='history']":"HistoryPush","click [rel='load_admin']":"loadAdmin","click [rel='home_page']":"ShowHome","click [rel='next_page']":"NextPage","click [rel='prev_page']":"PrevPage","click [rel='add_to_cart']":"AddToCart","click [rel='show_cart']":"ShowCart","click [rel='random_page']":"RandomPage","click [rel='site_menu']":"ShowSiteMenu","click a":"preventExtLinks"},render:function(){this.collection},loadAdmin:function(e){e.preventDefault(),Cargo.Helper.IsOnHomepage()?Cargo.Helper.GoToUrl("admin"):Cargo.Core.loadAdminForActivePage()},AddToCart:function(e){if(e.preventDefault(),!Cargo.Helper.IsAdminEdit()||"click"!=e.type)if(e.currentTarget.getAttribute("data-variant")){var t=e.currentTarget.getAttribute("data-product"),i=e.currentTarget.getAttribute("data-variant");Cargo.Ecommerce.Collection.products.fetchMultiple([t],{always:function(){var e=Cargo.Ecommerce.Collection.products.get(t);if(e){var o=e.variantCollection.get(i);o?e.get("is_available")&&o.get("is_available")?void 0!==Cargo.Ecommerce.Collection.cart.add(o)&&Cargo.Event.trigger("add_history","cart"):Cargo.Modal.Alert({selector:"html",message:"This product is unavailable"}):Cargo.Modal.Alert({selector:"html",message:"Product not found"})}else Cargo.Modal.Alert({selector:"html",message:"Product not found"})}.bind(this)})}else Cargo.View.Following.triggerEventInFrame("add-sku-to-cart",{sku:e.currentTarget.getAttribute("data-sku"),product:e.currentTarget.getAttribute("data-product")})},ShowCart:function(e){if(e.preventDefault(),!Cargo.Helper.IsAdminEdit()||"click"!=e.type||$(e.currentTarget).is("#shop_button")){try{var t=Cargo.View.Following.contentWindow.Following.View.Main.lastCartRoute;if(t)return Cargo.Router.is_first_route=!1,Cargo.View.Following.enable(),void Cargo.Router.navigate(t,{trigger:!1,replace:!0})}catch(e){}Cargo.Event.trigger("add_history","cart")}},isClickInEditor:function(e){if("undefined"==typeof CargoEditor||void 0===CargoEditor.events)return!1;if(void 0===e)return!1;if(e&&"dblclick"===e.type)try{if(!1===top.editor.editorInstance.inspectorOverlay.disabled)return!1}catch(e){}for(var t=e.target;null!==(t=t.parentNode);)if(t.nodeType===Node.ELEMENT_NODE){if("true"===t.contentEditable)return!0;if(t.hasAttribute("data-ce-model-id")&&t.getAttribute("data-ce-model-id")!=Backbone.history.fragment)return!0;if("svg"===t.nodeName&&"marker-overlay"===t.className.baseVal)return!0}return!1},preventExtLinks:function(e){this.isClickInEditor(e)&&e.preventDefault()},testIconFont:function(){this.el.classList.add("iconfont-loading");var e=document.createElement("canvas");e.width=150,e.height=150,this.textCtx=e.getContext("2d"),this.textCtx.font="150px Icons, Verdana",this.textCtx.textAlign="center",this.textCtx.fillStyle="black",this.drawTextCanvas(),this.fontTimer=setTimeout(this.resolveFontTest,3e3)},drawTextCanvas:function(){this.textCtx.fillStyle="white",this.textCtx.fillRect(0,0,150,150),this.textCtx.fillStyle="black",this.textCtx.fillText("︎",75,120);for(var e=[[10,10],[120,10],[120,120],[10,120],[95,75],[55,75],[75,75]],t=this.textCtx.getImageData(0,0,150,150),i=!1,o=0;o<e.length;o++){var n=e[o],a=600*n[1]+4*n[0];if(i=255==t.data[a])break}if(t=null,i){this.drawFrameID=window.requestAnimationFrame(this.drawTextCanvas)}else this.resolveFontTest()},resolveFontTest:function(){window.cancelAnimationFrame(this.drawFrameID),clearTimeout(this.fontTimer),this.textCanvas=null,this.textCtx=null,this.el.classList.remove("iconfont-loading")},HistoryPush:function(e,t){if(!this.isClickInEditor(e)){e&&(e.preventDefault(),t=e.currentTarget);var i=$(t).attr("href")?$(t).attr("href"):$(t).data("href"),o=$(t).attr("data-id")?$(t).attr("data-id"):$(t).data("id"),n=!(!$(t).attr("target")||"_blank"!=$(t).attr("target"));e.metaKey||n?window.open(i):Cargo.Event.trigger("add_history",i,o)}},ShowHome:function(e,t){this.isClickInEditor(e)||(e&&e.preventDefault(),""===Backbone.history.getFragment()&&Cargo.View.Content.activeContentModel&&Cargo.View.Content.activeContentModel.get("id")!=Cargo.Helper.GetHomepageId()?Cargo.View.Content.RenderHomepage():Cargo.Event.trigger("add_history",""))},NextPage:function(e){if(!this.isClickInEditor(e)){e&&e.preventDefault();var t=Cargo.View.Content.getActiveContentModel();if(t&&(!t.get("is_set")||t.get("stack")))if(!1!==t.get("display")){var i=Cargo.Collection.Scaffolding.getModel({id:t.get("set_id")});if(i&&void 0!==i.get("page_count")&&!(i.get("page_count")<=1)){var o,n,a=_.without(i.get("pages").map(function(e){return e.get("is_set")&&!e.get("stack")||0==e.get("page_count")?e.get("index"):void 0}),void 0),r=i.get("page_count"),s=t.get("index");for(n=0;n<r&&(++s>=r&&(s=0),-1!==a.indexOf(s));n++);(o=i.getModelAtIndex(s))?Cargo.Event.trigger("add_history",o.get("project_url"),o.get("id")):i.fetchModelAtIndex(s,{done:function(e){Cargo.Event.trigger("add_history",e.get("project_url"),e.get("id"))}})}}else $.get(Cargo.API.GetBasePath()+"/page/next/"+t.get("id"),function(e){if(e){var t=Cargo.Collection.Scaffolding.model(e);Cargo.Collection.Scaffolding.insertModel(t,Cargo.Collection.Scaffolding,{}),Cargo.Event.trigger("add_history",t.get("project_url"),t.get("id"))}},"json")}},PrevPage:function(e){if(!this.isClickInEditor(e)){e&&e.preventDefault();var t=Cargo.View.Content.getActiveContentModel();if(t&&(!t.get("is_set")||t.get("stack")))if(!1!==t.get("display")){var i=Cargo.Collection.Scaffolding.getModel({id:t.get("set_id")});if(i&&void 0!==i.get("page_count")&&!(i.get("page_count")<=1)){var o,n,a=_.without(i.get("pages").map(function(e){return e.get("is_set")&&!e.get("stack")||0==e.get("page_count")?e.get("index"):void 0}),void 0),r=i.get("page_count"),s=t.get("index");for(n=0;n<r&&(--s<0&&(s=r-1),-1!==a.indexOf(s));n++);(o=i.getModelAtIndex(s))?Cargo.Event.trigger("add_history",o.get("project_url"),o.get("id")):i.fetchModelAtIndex(s,{done:function(e){Cargo.Event.trigger("add_history",e.get("project_url"),e.get("id"))}})}}else $.get(Cargo.API.GetBasePath()+"/page/prev/"+t.get("id"),function(e){if(e){var t=Cargo.Collection.Scaffolding.model(e);Cargo.Collection.Scaffolding.insertModel(t,Cargo.Collection.Scaffolding,{}),Cargo.Event.trigger("add_history",t.get("project_url"),t.get("id"))}},"json")}},RandomPage:function(e){if(!this.isClickInEditor(e)&&(e&&e.preventDefault(),!0!==this.loadingRandomPage)){this.loadingRandomPage=!0;var t,i,o,n,a=[];if(Cargo.View.Content.activeContentModel&&(t=Cargo.View.Content.activeContentModel.get("id")),Cargo.Collection.Scaffolding.each(function(e){if("set"===e.type)if(e.get("stack"))e.get("page_count")>0&&t!==e.get("id")&&a.push([e.get("id")]);else if((i=e.get("page_count"))&&!isNaN(i))for(n=0;n<i;n++)(!(o=e.getModelAtIndex(n))||"set"!==o.type&&o.get("id")!==t)&&a.push([e.get("id"),n])},void 0,!0),0!==a.length){var r=a[Math.floor(Math.random()*a.length)],s=Cargo.Collection.Scaffolding.getModel({id:r[0]});2===r.length?s.fetchModelAtIndex(r[1],{done:_.bind(function(e){Cargo.Event.trigger("add_history",e.get("project_url"),e.get("id")),this.loadingRandomPage=!1},this),error:_.bind(function(){this.loadingRandomPage=!1},this)}):1===r.length?(Cargo.Event.trigger("add_history",s.get("project_url"),s.get("id")),this.loadingRandomPage=!1):this.loadingRandomPage=!1}else this.loadingRandomPage=!1}},ShowSiteMenu:function(e){Cargo.View.SiteMenu.show(e)},WriteCustomHtmlPreview:function(){if(void 0!==parent.editframe){var e=parent.editframe.document.getElementById("syntax_highlight").value;$("customhtml").html(e)}else if(void 0!==parent.Cargo&&parent.Cargo.hasOwnProperty("Editor")&&void 0!==parent.Cargo.Editor.previewCustomHTML){e=parent.Cargo.Editor.previewCustomHTML;$("customhtml").html(e)}},WriteCustomCSSPreview:function(){var e=parent.editframe.document.getElementById("syntax_highlight").value;$("body").append("<style>"+e+"</style>"),$("head link[rel='stylesheet']").remove()},SetWindowTitle:function(e){if(e||Cargo.Helper.IsOnHomepage())document.title=Cargo.Model.Site.GetWebsiteTitle();else{var t=Cargo.View.Content.getActiveContentModel(),i=t&&"all"!==t?t.get("title"):"";i?document.title=i+" - "+Cargo.Model.Site.GetWebsiteTitle():""===i&&(document.title=Cargo.Model.Site.GetWebsiteTitle())}},SetHomepageClass:function(){(Cargo.Model.Site.get("homepage_id")||0==Cargo.Model.Site.get("homepage_id"))&&this.$el.addClass("homepage")},SetFeedClass:function(){Cargo.Helper.isFeed()&&this.$el.addClass("feed")},RemoveHomepageClass:function(){this.$el.removeClass("homepage")},RemoveFeedClass:function(){this.$el.removeClass("feed")},SetPageId:function(e){this.$el.attr("data-page-id",e)}}),Cargo.o.view.Backdrop=Backbone.View.extend({template:"",has_webgl:null,pages:[],plugins:[],Subviews:{},ticking:!1,initialize:function(){return requirejs.config({waitSeconds:30,baseUrl:"/_jsapps/backdrop",paths:{text:"//static.cargo.site/libs/require/text.2.0.16.min",css:"//static.cargo.site/libs/require/css.min",three:"_libs/three.min","three.extends":"_libs/three.extends"},shim:{three:{exports:"THREE"}},urlArgs:"undefined"!=typeof __cargo_js_ver__?__cargo_js_ver__:void 0}),Backdrop.Data.require_loaded=!0,this.measuringStick=null,this.fullScreenHeight=null,this.addEventListeners(),this.requestTick(),this},addEventListeners:function(){this.requestTickCallback=this.requestTick.bind(this),this.updateScrollMonitorsCallback=this.updateScrollMonitors.bind(this),this.throttledRequestTick=_.throttle(this.requestTickCallback,150),this.resetIOSChromeCache=_.bind(this.resetIOSChromeCache,this),this.resetIOSChromeCache=_.debounce(this.resetIOSChromeCache,150),this.checkSplitResponsive=_.bind(this.checkSplitResponsive,this),this.checkSplitResponsive=_.debounce(this.checkSplitResponsive,30),this.listenTo(Cargo.Event,"design:ready backbone-route",this.setup),this.listenTo(Cargo.Event,"handleAdminUIChange",this.requestTickCallback),this.listenTo(Cargo.Event,"pin_format_complete",this.updateScrollMonitorsCallback),window.addEventListener("scroll",this.requestTickCallback,{passive:!0}),window.addEventListener("resize",this.requestTickCallback,{passive:!0}),window.addEventListener("gestureend",this.resetIOSChromeCache),window.addEventListener("pointerup",this.resetIOSChromeCache),window.addEventListener("onpointercancel",this.resetIOSChromeCache),window.addEventListener("onpointerout",this.resetIOSChromeCache),window.addEventListener("onpointerleave",this.resetIOSChromeCache),this.listenTo(Cargo.Event,"handleAdminUIChange",this.checkSplitResponsive),Cargo.Event.on("projectlist_sort",function(){_.each(this.Subviews,function(e){e._pageScrollMonitor&&(e._pageScrollMonitor.recalculateLocation(),e._pageScrollMonitor.update(),e._pageScrollMonitor.triggerCallbacks())})},this),CargoEditor&&CargoEditor.hasOwnProperty("events")&&CargoEditor.events.on("editor-content-change",this.requestTickCallback);try{parent.document,parent.hasOwnProperty("Cargo")&&parent.Cargo.hasOwnProperty("Event")&&(parent.Cargo.Event.on("applied-presets",this.requestTickCallback),parent.Cargo.Event.on("mobile-preview",_.debounce(_.bind(this.requestTickCallback,this),50)),parent.Cargo.Event.on("image_upload_complete",_.bind(this.addImage,this)),parent.Cargo.Event.on("image_delete_complete",_.bind(this.removeImage,this)))}catch(e){}return this},checkSplitResponsive:function(e,t){var i=!1;"split_layout"!==e&&"pagerender"!==e&&"split_responsive"!==e||_.each(this.Subviews,function(e){var t=e.el;if(t){var o=closest(t,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("page_container")});if(o){var n=o.hasAttribute("split-responsive");e._split_responsive!==n&&(i=!0),e._split_responsive=n;var a=o.hasAttribute("data-padding-top");e._has_accommodation!==a&&(i=!0),e._has_accommodation=a}}}),i&&this.updateBackdropScrollPosition(!0)},resetIOSChromeCache:function(){this.cacheChromeHeight=0,this.requestTick()},setup:function(){var e=$(".backdrop");if(!e.length&&_.isEmpty(this.pages))return this;var t=e.siblings(".page").map(function(){return $(this).data("id")});t=_.map(t,function(e){return parseInt(e,10)});var i=_.difference(this.pages,t),o=_.difference(t,this.pages);return _.each(o,function(e){this.add(e)},this),_.each(i,function(e){this.remove(e)},this),this},reset:function(){_.each(this.Subviews,function(e,t){this.remove(t,!0)},this),this.pages=[]},remove:function(e,t){if(!(e in this.Subviews))return this.pages=_.without(this.pages,e),this;var i=this.Subviews[e],o=_.clone(i.model);return i.prevent_removal?void 0:("function"==typeof i.destroy&&i.destroy(),"object"==typeof i._pageScrollMonitor&&i._pageScrollMonitor.destroy(),i.undelegateEvents(),i.$el.removeData().unbind(),!0===t&&void 0!==i.model.get("originalDataElement")&&null!==i.model.get("originalDataElement")&&null!==i.el.parentNode&&i.el.parentNode.appendChild(i.model.get("originalDataElement")),i.remove(),this.Subviews[e]=void 0,delete this.Subviews[e],this.pages=_.without(this.pages,e),this.markPluginInactive(o),this)},removeImage:function(e){if(e)for(var t in this.Subviews)this.Subviews.hasOwnProperty(t)&&"function"==typeof this.Subviews[t].Update&&this.Subviews[t].Update("image_delete",e)},addImage:function(e){if(e)for(var t in this.Subviews)this.Subviews.hasOwnProperty(t)&&"function"==typeof this.Subviews[t].Update&&this.Subviews[t].Update("image_upload",e)},add:function(e,t,i,o){var n=this.getRenderTargetForPID(e),a=null==n?null:n.parentNode.querySelector('[data-set="backdrop_data"]');if(void 0===o&&null!==a&&(o=a.innerHTML),this.pages.push(e),this.pages=_.uniq(this.pages),n||this.createBackdropEl(e),!o)return(r=new Backdrop.o.model.Settings({page_id:e,backdrop_id:t,backdrop_path:i})).fetch({success:$.proxy(this.loadBackdrop,this)}),this;var r=new Backdrop.o.model.Settings;return"string"==typeof o?r.set(JSON.parse(o)):r.set(o),r.set("originalDataElement",a),this.loadBackdrop(r),this},change:function(e,t,i){return this.remove(e).add(e,t,i)},get:function(e){if(void 0!==this.Subviews[e])return this.Subviews[e]},enableOrDisableBackdropForPID:function(e,t){if(e=parseInt(e),isNaN(e))console.warn("enableOrDisableBackdropForPID: no valid PID given.");else if(!1!==t&&(t=!0),t){var i=Cargo.Collection.Scaffolding.getModel({id:e});if(void 0!==i){var o=i.get("backdrop");o&&(o=o||{},o=_.defaults(o,{backdrop_id:void 0,backdrop_path:void 0}),this.add(e,o.backdrop_id,o.backdrop_path)),this.requestTick()}else console.warn("enableOrDisableBackdropForPID: Unable to enable backdrop. No page model found.")}else this.remove(e)},createBackdropEl:function(e){var t=$('.page[data-id="'+e+'"]').closest(".page_container");return $("<div />").addClass("backdrop").attr("data-view","Backdrop").appendTo(t),this},loadBackdrop:function(e){return e.get("requires_webgl")&&!this.testWebGl()?(this.makeFallback(e),this):Backdrop.Data.require_loaded?void 0!==this.getRenderTargetForPID(e.get("page_id"))?("undefined"!=typeof __cargo_context__&&"live"===__cargo_context__?require(["_dist/"+e.get("backdrop_path")],_.bind(function(t){require([e.get("backdrop_path")+"/main"],_.bind(function(t){this.markPluginActive(e),this.loadSubview(e,t),this.requestTick()},this))},this)):require([e.get("backdrop_path")+"/main"],_.bind(function(t){this.markPluginActive(e),this.loadSubview(e,t),this.requestTick()},this)),this):void console.error("no render target for backdrop"):(setTimeout($.proxy(function(){this.loadBackdrop(e)},this),150),this)},getRenderTargetForPID:function(e){return $('.page[data-id="'+e+'"]').siblings(".backdrop")[0]},loadSubview:function(e,t){var i=e.get("page_id");if(void 0!==this.Subviews[i])return this;var o=this.getRenderTargetForPID(i);if(o){var n=Cargo.Collection.Scaffolding.getModel({id:i}),a=new t({model:e});a.deferredLoadEventName&&(a.deferredLoadEventName+="_"+_.uniqueId()),o.setAttribute("data-backdrop",e.get("backdrop_path")),o.innerHTML="",o.appendChild(a.el),a.render(),"function"==typeof a.Init&&a.Init(),n&&(a._viewport_lock=a.model.get("data").backdrop_viewport_lock||!1);var r=$(o).closest(".page_container").get(0),s=$(o).closest('[data-view="pinned_bottom"] .fixed, [data-view="pinned_top"] .fixed'),l=$(o).closest("#site_menu_panel_container");return r&&0==s.length?(r.hasAttribute("split-responsive")?(a._split_responsive=!0,r.hasAttribute("data-padding-top")?a._has_accommodation=!0:a._has_accommodation=!1):a._split_responsive=!1,a._scroll_tracking=!0,l.length>0?(a._site_menu_overlay=!0,a._trackable=!0,a.in_viewport=!0):(a._positionChangeTracker=scrollMonitor.create(r,screen.height),a._positionChangeTracker.enterViewport(function(){a._trackable=!0}),a._positionChangeTracker.exitViewport(function(){a._trackable=!1}),a._pageScrollMonitor=scrollMonitor.create(r),a._pageScrollMonitor.enterViewport(function(){a.in_viewport=!0,a.Resume&&a.paused&&a.Resume()}),a._pageScrollMonitor.exitViewport(function(){a.in_viewport=!1,a.Pause&&!a.paused&&a.Pause()})),void 0!==a._containerMonitor&&a._containerMonitor.update()):a.in_viewport=!0,a._cached_size={left:0,top:0,width:0,height:0},this.Subviews[i]=a,Cargo.Event.trigger("plugin_render",a),setTimeout(function(){a._positionChangeTracker&&(a._positionChangeTracker.recalculateLocation(),a._positionChangeTracker.update(),a._positionChangeTracker.triggerCallbacks()),a._pageScrollMonitor&&(a._pageScrollMonitor.recalculateLocation(),a._pageScrollMonitor.update(),a._pageScrollMonitor.triggerCallbacks())},100),this}console.error("no render target for backdrop")},markPluginActive:function(e){var t=e.get("backdrop_id"),i=e.get("backdrop_path"),o=_.findWhere(this.plugins,{path:i});return o||(o={count:0,id:t,path:i},this.plugins.push(o)),o.count++,this},markPluginInactive:function(e){e.get("backdrop_id");var t=e.get("backdrop_path"),i=_.findWhere(this.plugins,{path:t});return i&&i.count--,0===i.count&&(this.plugins=_.without(this.plugins,i)),this},is_ios:null,testIOS:function(){return null!==this.is_ios?this.is_ios:(this.is_ios=Cargo.Helper.isIOS(),this.is_ios)},cacheChromeHeight:0,cache_window_data:{height:0,width:0,scrollY:0,scrollX:0},updateScrollMonitors:function(){for(var e in this.Subviews)if(this.Subviews.hasOwnProperty(e)){var t=this.Subviews[e];t.hasOwnProperty("_pageScrollMonitor")&&(t._pageScrollMonitor.recalculateLocation(),t._pageScrollMonitor.update())}this.requestTick()},updateBackdropScrollPosition:function(e){if(0!=_.keys(this.Subviews).length){var t=this.testIOS(),i=window.scrollY,o=window.innerHeight,n=document.documentElement.clientWidth,a=window.scrollX,r=!1,s=Math.min(0,i),l=Math.max(0,document.scrollingElement.scrollTop+o-document.scrollingElement.scrollHeight);if(o==this.cache_window_data.height&&n==this.cache_window_data.width&&(r=!0),t&&(!this.fullScreenHeight||!r||e)){if(!this.measuringStick){var d=document.createElement("div");d.style.position="fixed",d.style.height="100vh",d.style.width="1px",d.style.zIndex="-10",d.style.pointerEvents="none",this.measuringStick=d,document.body.appendChild(this.measuringStick)}for(var c=0;window.matchMedia.call(window,"(min-height:"+(c+=1)+"px)").matches;);this.smallestHeight=c-1,this.fullScreenHeight=this.measuringStick.offsetHeight}this.cache_window_data={width:n,height:o,scrollY:i,scrollX:a};var h=Cargo.Helper.IsMobileWindowSize(n);for(var u in this.Subviews)if(this.Subviews.hasOwnProperty(u)){var g=this.Subviews[u];if(g){var p=g._split_responsive&&h,m=g._viewport_lock;if(g._site_menu_overlay||(g._trackable||g._scroll_tracking)&&g.hasOwnProperty("_positionChangeTracker"))if(g.el.parentElement&&g.el.parentElement.parentElement){N=g.el.parentElement.getBoundingClientRect();var f=g.el.parentElement.parentElement.getBoundingClientRect();if(N.left!=g._cached_size.left||N.top!=g._cached_size.top||N.width!=g._cached_size.width||N.height!=g._cached_size.height||!r||e)if(g._cached_size=N,g.el.parentElement.__cached_size=N,g.el.parentElement.__cached_page_size=f,!(f.height<=o||p)||m){g._scroll_tracking&&!g._trackable?g._scroll_tracking=!1:g._scroll_tracking=!0;var v=f.bottom>=0&&f.top<0,b=f.top<=o&&f.bottom>o,y=f.top>o,w=f.bottom<0,C=f.top<=0&&f.bottom>=o,S=0,x=0,E="absolute",k=(P=.5*Math.ceil(2*o),Math.ceil(N.width));if(b&&!C||y?(S=0,x=0,g._site_menu_overlay?(E="fixed",x=Math.round(N.left)):m?(x=Math.round(N.left),E="fixed"):E="absolute"):v&&!C||w?(x=0,g._site_menu_overlay?(E="fixed",x=Math.round(N.left),S=0):m?(x=Math.round(N.left),S=0,E="fixed"):(E="absolute",S=Math.round(f.height)+-o)):(S=0,E="fixed",x=Math.round(N.left)),m){var I,T;if(p){var A=Math.min(0,f.top);I=Math.round(Math.max(f.top,0)+s+l),T=Math.round(Math.min(N.height+A,o))}else I=Math.round(Math.max(f.top,0)+s+l),T=Math.round(Math.min(Math.min(0,f.top)+f.height,o));g.hasOwnProperty("auxiliary_container")&&(g.auxiliary_container._el.style.webkitClipPath="polygon(0px "+I+"px, "+N.width+"px "+I+"px, "+N.width+"px "+(T+I)+"px, 0px "+(T+I)+"px)",g.auxiliary_container._el.style.clipPath="polygon(0px "+I+"px, "+N.width+"px "+I+"px, "+N.width+"px "+(T+I)+"px, 0px "+(T+I)+"px)"),g.el.style.webkitClipPath="polygon(0px "+I+"px, "+N.width+"px "+I+"px, "+N.width+"px "+(T+I)+"px, 0px "+(T+I)+"px)",g.el.style.clipPath="polygon(0px "+I+"px, "+N.width+"px "+I+"px, "+N.width+"px "+(T+I)+"px, 0px "+(T+I)+"px)"}g.el.style.position=E,g.el.style.willChange="transform, width, height, position, clip-path",g.el.style.width=k+"px",g.el.style.height=P+"px",x+=-f.left,g.el.style.transform=0==x&&0==S&&0==i?"":"translate("+x+"px, "+S+"px)",g.el.parentElement&&(g.el.parentElement.__backdropData={position:E,width:k,height:P,xPos:x,yPos:S}),g.hasOwnProperty("auxiliary_container")&&(g.auxiliary_container._el.style.height=P,g.auxiliary_container._el.style.width=k+"px",g.auxiliary_container._el.style.position=E,g.auxiliary_container._el.style.transform=0==x&&0==S&&0==i?"":"translate("+x+"px, "+S+"px)"),g.hasOwnProperty("SetSizeFromMainView")&&g.SetSizeFromMainView(N.width,o)}else{var M=0;if(g._scroll_tracking){var P,O;if(g._has_accommodation){var L=Cargo.View.PinnedTop.pinCollection.findWhere({content_accommodate_page:!0});M=L?L.get("page_height"):0,p?(P="calc(50vh + "+M+"px)",O="translate(0, "+-M+"px)"):(P="calc(100% + "+M+"px)",O="translate(0, "+-M+"px)"),g._scroll_tracking=!0}else P="",O="",g._scroll_tracking=!1;g.el.style.transform=O,g.el.style.height=P,g.el.style.width="",g.el.style.position="",g.hasOwnProperty("auxiliary_container")&&(g.auxiliary_container._el.style.transform="",g.auxiliary_container._el.style.height=P,g.auxiliary_container._el.style.width="",g.auxiliary_container._el.style.position=""),g.el.style.willChange="initial"}else g.el.style.width&&g.el.style.height&&(g.el.style.position="",g.el.style.willChange="",g.el.style.width="",g.el.style.height="",g.el.style.transform="",g.hasOwnProperty("auxiliary_container")&&(g.auxiliary_container._el.style.height="",g.auxiliary_container._el.style.width="",g.auxiliary_container._el.style.position="",g.auxiliary_container._el.style.transform=""));g.hasOwnProperty("SetSizeFromMainView")&&(t&&p?g.SetSizeFromMainView(N.width,.5*this.fullScreenHeight+M):p?g.SetSizeFromMainView(N.width,.5*o+M):g.SetSizeFromMainView(N.width,N.height+M))}}else console.warn("No valid render target for backdrop");else if(m||(g._scroll_tracking=!1,g.el.style.willChange="initial"),g.hasOwnProperty("SetSizeFromMainView")){var N=g.el.parentElement.getBoundingClientRect();g.SetSizeFromMainView(N.width,N.height)}}}}},requestTick:function(e){if(!this.ticking){var t=this;requestAnimationFrame(function(){t.updateBackdropScrollPosition(),Cargo.Event.trigger("backdrop_position_update"),t.ticking=!1})}this.ticking=!0},makeFallback:function(e){var t=e.get("page_id"),i=$('[data-id="'+t+'"]').css("color"),o=i.split(","),n=[],a=0;/rgb\(/.test(i)?(o[0]=o[0].replace("rgb(",""),n[0]=parseInt(o[0]),n[1]=parseInt(o[1]),n[2]=parseInt(o[2]),a=(299*n[0]+587*n[1]+114*n[2])/1e3):/rgba\(/.test(i)?(o[0]=o[0].replace("rgb(",""),n[0]=parseInt(o[0]),n[1]=parseInt(o[1]),n[2]=parseInt(o[2]),a=(299*n[0]+587*n[1]+114*n[2])/1e3):/#/.test(i)?(n[0]=parseInt(o[0],16),n[1]=parseInt(o[1],16),n[2]=parseInt(o[2],16),a=(299*n[0]+587*n[1]+114*n[2])/1e3):a=255;var r=a>125?"#333":"#fff";return $('.page[data-id="'+t+'"]').siblings(".backdrop").css("background-color",r),this},testWebGl:function(){if(null!==this.has_webgl)return this.has_webgl;var e,t,i;if(this.has_webgl=!1,window.WebGLRenderingContext){e=document.createElement("canvas"),t=["webgl","experimental-webgl","moz-webgl","webkit-3d"],i=!1;for(var o=0;o<4;o++)try{if((i=e.getContext(t[o]))&&"function"==typeof i.getParameter)return e=void 0,this.has_webgl=!0,this.has_webgl}catch(e){}return e=void 0,this.has_webgl=!1,this.has_webgl}return this.has_webgl=!1,this.has_webgl},initAndRenderPlugin:$.noop,initPlugin:$.noop,loadActivePlugin:$.noop,render:$.noop,unloadMainPlugin:$.noop}),Cargo.o.view.Content=Backbone.View.extend({template:$('[type="text/x-handlebars-template"]#content').html(),initialize:function(){this.currentSet=null,this.activeContentModel=null,$(_.bind(function(){var e=2*screen.height,t=$("[data-autopaginate]")[0],i=!0;t&&(t.style.pointerEvents="none",t.style.height="1px",t.style.marginTop="-1px",t.style.width="100%",Cargo.Helper.isMobile()&&(e=.75*screen.height),this.paginationObserver=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting?(this.requestPagination({prevent_pagination_recheck:!0,pagination_attempts:0}),i=!0):i=!1}.bind(this))}.bind(this),{root:null,rootMargin:e+"px",threshold:0}),this.paginationObserver.observe(t),Cargo.Event.on("set_render_complete",function(e,t){t.from_pagination||!0!==t.prevent_pagination_recheck&&i&&this.requestPagination({prevent_pagination_recheck:!0,pagination_attempts:0})},this),Cargo.Event.on("set_load_complete",function(){i&&this.requestPagination({prevent_pagination_recheck:!0,pagination_attempts:0})},this),Cargo.Event.on("pagination_complete tag_pagination_complete",function(e,t,o){setTimeout(_.bind(function(){var e=o.pagination_attempts;if(isNaN(e)&&(e=!1),!(e&&e>10)&&t.length>0&&i){var n={};isNaN(e)||(n.pagination_attempts=++e),this.requestPagination(n)}},this),100)},this))},this)),this.activeLinks=[],Cargo.Event.on("content_load_complete",this.checkActiveLinks,this),Cargo.Event.once("init_complete",function(){this.initializePreRenderedSet()},this)},requestPagination:function(e){this.currentSet&&this.activeContentModel&&"set"===this.activeContentModel.type&&this.activeContentModel.paginate(e)},fillGapsInCurrentSet:function(){if(this.currentSet&&this.activeContentModel&&"set"===this.activeContentModel.type){var e,t,i=_.union([this.currentSet],this.currentSet.getAllSetViews()),o=[],n=[];if(i.sort(function(e,t){return e.model.get("sort")-t.model.get("sort")}),_.each(i,function(i){n.push(i),i.pageViews.length>0&&(e=i,t=i.pageViews[i.pageViews.length-1],o=_.union(o,n),n=[])}),!e||!t)return;var a=0,r=this.activeContentModel.recursivelyFindMissingIndexesInSet(16,{limit:{set:e.model.get("id"),index:t.model.get("index")}});if(_.isEmpty(r))return;if(_.each(r,function(e){a+=e.indexes.length}),a>15){var s=this.activeContentModel.recursivelyFindMissingIndexesInSet(15,{limit:{set:e.model.get("id"),index:t.model.get("index")}});this.activeContentModel.paginateWithMissingIndexObject(s,{render_changes:!0,done:_.bind(function(e){var t=e[e.length-1];_.each(Cargo.Collection.Scaffolding.getAllPages(!0),function(e){if("set"===e.type){var i=[];e.get("pages").each(function(e){"page"===e.type&&Cargo.Helper.IsIndexableModel(e)&&e.get("sort")>t.sort&&i.push(e)}),e.get("pages").remove(i)}})},this)})}else this.activeContentModel.paginateWithMissingIndexObject(r,{render_changes:!0})}},checkActiveLinks:function(e){var t=Cargo.Helper.GetHomepageId(),i=Cargo.Collection.Scaffolding.getModel({id:e}),o="";i?o=i.get("project_url")+"":this.activeContentModel&&void 0!==this.activeContentModel.get("__tag__")&&(o=this.activeContentModel.get("__tag__"));var n,a=_.filter(document.querySelectorAll(".page_container a, #site_menu > a"),function(i){return e!=t&&("string"==typeof i.getAttribute("href")&&i.getAttribute("href").replace(/\//g,"").toLowerCase()==o.replace(/\//g,"").toLowerCase()||void(i.classList.contains("active")&&-1===this.activeLinks.indexOf(i)&&this.activeLinks.push(i)))},this),r=_.difference(this.activeLinks,a),s=_.difference(a,this.activeLinks);if(0!==s.length||0!==r.length){for(n=0;n<s.length;n++)s[n].classList.add("active"),this.activeLinks.push(s[n]);for(n=0;n<r.length;n++)r[n].classList.remove("active"),0===r[n].classList.length&&r[n].removeAttribute("class");this.activeLinks=_.difference(this.activeLinks,r),this.activeLinkPID=e}else this.activeLinkPID=e},retrieveActivePageViewForPID:function(e,t,i){i=i||{};var o=Cargo.Helper.GetPageViewById(e);if(o&&o.model.get("pin"));else if(Cargo.Helper.isFeed()||void 0===o)return void this.RenderPidOrPurl(e,!0,{complete:_.bind(function(){if(o=Cargo.Helper.GetPageViewById(e),unableToLoad=!1,void 0!==o)t&&t(o);else{unableToLoad=!0;var n=Cargo.Collection.Scaffolding.getModel({id:e});if(n){var a=Cargo.Collection.Scaffolding.getModel({id:n.get("set_id")});if(a&&a.get("stack")){var r=_.filter(a.get("pages").getMissingIndexes(),function(e){return e<=n.get("index")}),s=a.loadIndexes(r,{render_changes:!0});s&&(unableToLoad=!1,s.always(_.bind(function(){void 0!==(o=Cargo.Helper.GetPageViewById(e))?t&&t(o):!0!==i.silent&&Cargo.Modal.Alert({message:"Unable to load Page"})},this)))}}}unableToLoad&&!0!==i.silent&&Cargo.Modal.Alert({message:"Unable to load Page"})},this)});o&&t&&t(o)},render:function(e,t){if(t=t||{},_.defaults(t,{silent:!1,initial_render:!0,complete:function(){}}),this.removeCurrentView(),"set"===e.type)!0!==e.get("stack")||Cargo.Helper.IsAdminEdit()||this.collection.removeNonVisiblePages(),this.currentSet=Cargo.Core.SetViewFactory.constructSetView({model:e}),this.activeContentModel=e,this.currentSet.el.setAttribute("data-container","set"),this.currentSet.el.setAttribute("data-id",e.get("id")),this.el.appendChild(this.currentSet.el),this.currentSet.render(void 0,t),t.silent?this.checkActiveLinks(e.get("id")):(Cargo.Event.trigger("set_load_complete",e.get("id")),Cargo.Event.trigger("content_load_complete",e.get("id"))),e.get("__tag__")&&(Cargo.Event.trigger("tag_load_complete",e.get("__tag__")),Cargo.View.Main&&Cargo.View.Main.SetFeedClass()),Cargo.API.Config.is_direct_link&&(Cargo.API.Config.is_direct_link=!1),t.complete(e,t);else if("page"===e.type){var i=this.collection.getModel({id:e.get("set_id")}),o=e;this.activeContentModel=o,e=new Cargo.o.model.set({id:i.get("id"),pages:[o],stack:!1,is_set:!0,page_count:1}),this.currentSet=Cargo.Core.SetViewFactory.constructSetView({model:e}),this.currentSet.el.setAttribute("data-container","set"),this.currentSet.el.setAttribute("data-id",i.get("id")),this.el.appendChild(this.currentSet.el),this.currentSet.render(void 0,t),t.silent?this.checkActiveLinks(o.get("id")):(Cargo.Event.trigger("page_load_complete",o.get("id")),Cargo.Event.trigger("content_load_complete",o.get("id"))),Cargo.API.Config.is_direct_link&&(Cargo.API.Config.is_direct_link=!1),t.complete(o,t)}},RenderHomepage:function(e,t){if(t=t||{},_.defaults(t,{silent:!1,complete:function(){},force_single:!0}),this.activeContentModel&&this.activeContentModel.get("id")===Cargo.Helper.GetHomepageId()&&!0===Cargo.Router.is_first_route&&!e)return t.complete(this.activeContentModel,t),void Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId());Cargo.Helper.isFeed()?(!0!==Cargo.Router.is_first_route||e)&&(this.RenderFeed(!0,t),!0!==t.silent&&Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId())):(this.collection.removeNonVisiblePages(),0===Cargo.Helper.GetHomepageId()?(this.removeCurrentView(),this.activeContentModel=this.collection.getModel({id:0}),!0!==t.silent&&Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId()),t.complete(this.activeContentModel,t)):(t.complete=_.wrap(t.complete,_.bind(function(e){!0!==t.silent&&Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId());var i=Array.prototype.slice.call(arguments);i.shift(),e&&e.apply(t.context,i)},this)),this.RenderPidOrPurl(Cargo.Helper.GetHomepageId(),e,t)))},RenderFeed:function(e,t){t=t||{},_.defaults(t,{silent:!1}),this.collection.removeNonVisiblePages(),this.RenderPidOrPurl(0,e,t)},RenderPidOrPurl:function(e,t,i){if(i=i||{},_.defaults(i,{silent:!1,force_single:!1,force_set_render:!1,complete:function(){}}),!0!==Cargo.Router.is_first_route||t){var o;if(isNaN(Number(e))||"string"==typeof e&&0===Number(e)||(o=this.collection.getSetOrPageModel({id:Number(e)},Cargo.Helper.IsAdminEdit()&&!i.force_single)),o||(o=this.collection.getModelByPurl(e,Cargo.Helper.IsAdminEdit()&&!i.force_single)),o)return i.force_set_render||Cargo.Helper.isFeed()||!0!==o.get("is_set")||!1!==o.get("stack")?void this.render(o,i):(this.hideActiveView(i),this.activeContentModel=o,i.silent||(Cargo.Event.trigger("content_load_complete",o.get("id")),Cargo.Event.trigger("set_load_complete",o.get("id"))),void i.complete(o,i));i.from_async?(Cargo.Modal.Alert({message:"Page Not Found"}),Cargo.Helper.HideLoadingAnimation()):this.loadSinglePage(e,_.bind(function(o){i.from_async=!0,this.RenderPidOrPurl.call(this,e,t,i)},this))}else Cargo.Router.is_first_route=!1},loadSinglePage:function(e,t){this.collection.fetchPageModel(e,{done:_.bind(function(i){i.get("id")!=e&&(i.get("project_url")+"").toLowerCase()!=(e+"").toLowerCase()||t&&t(i)},this)})},ToggleFeed:function(e){e?this.RenderFeed(!0,{force_set_render:!0}):0===Cargo.Helper.GetHomepageId()?this.removeCurrentView():this.RenderPidOrPurl(Cargo.Helper.GetHomepageId(),!0)},removeCurrentView:function(){if(this.currentSet){this.activeContentModel=null;var e=this.currentSet;this.currentSet=null,e.remove(),this.checkActiveLinks(),Cargo.View.Main.SetWindowTitle(),Cargo.Event.trigger("content_view_removed")}this.el.innerHTML=""},hideActiveView:function(e){e=e||{},_.defaults(e,{silent:!1}),this.removeCurrentView(),Cargo.Helper.HideLoadingAnimation(),e.silent||Cargo.Event.trigger("content_view_closed")},initializePreRenderedSet:function(){var e=Cargo.Collection.Tags.findTagByUrl(Cargo.Helper.GetCurrentRoute().replace(window.location.search,""));if(_.each(this.el.children,function(t){var i=parseInt(t.getAttribute("data-id"),10),o=this.collection.getSetOrPageModel({id:Number(i)});if(""===t.getAttribute("data-id")&&null!==t.parentNode){var n=t.querySelector("projectcontent");n&&""===n.textContent&&t.parentNode.removeChild(t)}if(!isNaN(i))if("set"===t.getAttribute("data-container")){var a=!!o&&o.get("stack");e&&!1===a?Cargo.Collection.Scaffolding.LoadTagCollection(e):o&&(this.activeContentModel=o,this.currentSet=Cargo.Core.SetViewFactory.constructSetView({el:t,model:o}),this.currentSet.render(!0),Cargo.Event.trigger("set_load_complete",o.get("id")),Cargo.Event.trigger("content_load_complete",o.get("id")),o.get("id")===Cargo.Helper.GetHomepageId()&&Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId()),Cargo.Helper.isFeed()&&e&&Cargo.Event.trigger("thumbnails:load_tag",e.get("url"))),Cargo.API.Config.is_direct_link&&(Cargo.API.Config.is_direct_link=!1)}else if("page"===t.getAttribute("data-container")){if(!o)return void this.loadSinglePage(i,_.bind(function(e){this.initializePreRenderedSet()},this));var r=this.collection.getModel({id:o.get("set_id")}),s=o;o=new Cargo.o.model.set({id:r.get("id"),pages:[s],stack:!1,is_set:!0,page_count:1}),this.activeContentModel=s,this.currentSet=Cargo.Core.SetViewFactory.constructSetView({model:o}),this.currentSet.el.setAttribute("data-container","set"),this.currentSet.el.setAttribute("data-id",r.get("id")),t.parentNode.insertBefore(this.currentSet.el,t),this.currentSet.el.appendChild(t),this.currentSet.findAndInitializePrerenderedContent(),Cargo.Event.trigger("page_load_complete",s.get("id")),Cargo.Event.trigger("content_load_complete",s.get("id")),s.get("id")===Cargo.Helper.GetHomepageId()&&Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId()),Cargo.API.Config.is_direct_link&&(Cargo.API.Config.is_direct_link=!1)}},this),null===this.activeContentModel)if(Cargo.API.Config.direct_link_pid){var t=this.collection.getModel({id:Cargo.API.Config.direct_link_pid});t&&"set"===t.type?(this.activeContentModel=t,Cargo.Event.trigger("content_load_complete",t.get("id")),Cargo.Event.trigger("set_load_complete",t.get("id"))):t&&"page"===t.type&&t.get("pin")&&(this.activeContentModel=t)}else e?Cargo.Collection.Scaffolding.LoadTagCollection(e):Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId());Cargo.API.Config.direct_link_pid=void 0},getPageViewById:function(e){if(this.currentSet)return _.filter(this.currentSet.getAllPageViews(),function(t){return t.model.get("id")==e})[0]},getFirstPageView:function(){if(this.currentSet)return _.filter(this.currentSet.getAllPageViews(),function(e){return!e.model.get("pin")})[0]},getLastPageView:function(){if(this.currentSet){var e=_.filter(this.currentSet.getAllPageViews(),function(e){return!e.model.get("pin")});return e[e.length-1]}},getActiveContentModel:function(){return this.activeContentModel},getActivePageViews:function(){return this.currentSet?this.currentSet.getAllPageViews():[]}}),Cargo.o.view.Page=Backbone.View.extend({parentView:null,template:$('[type="text/x-handlebars-template"]#page').html(),constructor:function(){Backbone.View.prototype.constructor.apply(this,arguments)},initialize:function(e){e&&e.parentView&&(this.parentView=e.parentView),e&&e.template&&(this.template=e.template),this.isAdminEdit=Cargo.Helper.IsAdminEdit(),this.finishGallerySetup=_.bind(this.finishGallerySetup,this),void 0!==this.model?(this.listenTo(this.model,"change:backdrop_enabled",function(){this.model.get("backdrop_enabled")?this.addBackdrop():this.removeBackdrop(!1)}),Cargo.Event.trigger("pageview-initialized",this),Cargo.Event.on("image_gallery_rendered",this.finishGallerySetup),this.initialSetup()):console.warn("no model for page")},events:{dragstart:"dragstart"},embedLibrary:[{name:"youtube",testURL:function(e){return/youtu\.?be/.test(e)},oembed_template:_.template("/_api/v2/proxy/url?url=http://www.youtube.com/oembed?url=<%= url %>")},{name:"vimeo",testURL:function(e){return/vimeo.com/.test(e)},oembed_template:_.template("https://vimeo.com/api/oembed.json?url=<%= url %>&width=<%= width %>")},{name:"img",testURL:function(e){var t=e.split(".");if(0==t.length)return!1;var i=t.pop();return _.contains(["jpg","png","gif","jpeg","webp"],i.toLowerCase())},getDimensions:function(e){return new Promise(function(t,i){var o=document.createElement("img");o.onload=function(){t({width:o.naturalWidth,height:o.naturalHeight}),o.onload=null,o.src="",o=null},o.src=e})},html_template:_.template('<img src="<%= url %>" width="<%= width %>" height="<%= height %>"/>')},{name:"mp4Embed",testURL:function(e){var t;return e.indexOf("?")>-1&&(e=e.split(/[?]+/)[0]),0!=(t=e.split(".")).length&&"mp4"===t.pop().toLowerCase()},getDimensions:function(e){return new Promise(function(t,i){var o=document.createElement("video");o.setAttribute("type","video/mp4"),o.setAttribute("preload","metadata"),o.onloadedmetadata=function(){t({width:o.videoWidth,height:o.videoHeight}),o.onloadedmetadata=null,o.setAttribute("src",""),o.load()},o.setAttribute("src",e),o.load()})},html_template:_.template('<video src="<%= url %>" width="<%= width %>" height="<%= height %>" <%= options.loop ? "loop" : ""%> <%= options.controls ? "controls" : "" %> type="video/mp4" playsinline ></video>')},{name:"htmlCode",testURL:function(e){var t=document.createElement("div");return t.innerHTML=decodeURIComponent(e),t.childElementCount>0},html_template:_.template("<%= url %>")},{name:"pdf",testURL:function(e){var t=e.split(".");return 0!=t.length&&(t.pop().indexOf("pdf")>-1||void 0)},html_template:_.template('<iframe frameborder="0" src="<%= options.requiresGDocsEmbed ? "https://docs.google.com/gview?url="+url+"&embedded=true" : url %>" width="3140" height="3140"></iframe>')},{name:"default",testURL:function(e){return!0},html_template:_.template('<iframe frameborder="0" src="<%= url %>" width="3140" height="3140"></iframe>')}],dragstart:function(e){if(Cargo.API.Config.cookie_url&&e.target.nodeType===Node.ELEMENT_NODE&&"IMG"===e.target.nodeName&&e.target.hasAttribute("data-mid")){var t=_.findWhere(this.model.get("images"),{id:parseInt(e.target.getAttribute("data-mid"))});if(t&&0==/(.*?)\.(svg)$/g.test(t.getOriginalImage().url)){var i={drag_image_src:e.target.getAttribute("src"),image_url:t.getOriginalImage().url,source_url:this.model.get("direct_link"),source_title:this.model.get("title")+" - "+Cargo.Model.Site.GetWebsiteTitle(),tags:""===this.model.get("tags")?[]:this.model.get("tags").split(", "),excerpt:this.model.get("excerpt")};e.dataTransfer.setData("cargo/imageselection",JSON.stringify(i))}}},removeBackdrop:function(e){!1!==e&&(e=!0),Backdrop.View.Backdrop.remove(this.model.get("id"),e)},addBackdrop:function(){this.model.get("backdrop")&&this.model.get("backdrop_enabled")&&Backdrop.View.Backdrop.add(this.model.get("id"),this.model.get("backdrop").backdrop_id,this.model.get("backdrop").backdrop_path)},initialSetup:function(){this.markNodesAsOriginal(),this.removeEmptyPagePadding(),Cargo.Core.Embeds.findEmbedsIn(this.el),Cargo.Core.Ecommerce.findWidgets(this.el),Cargo.Core.AudioPlayer.findPlayers(this.el),Cargo.Core.Ecommerce.updateInlineCartCounters(),Cargo.Ecommerce&&(Cargo.Ecommerce.initWidgets,1)&&Cargo.Ecommerce.initWidgets(this.el),Cargo.Core.Draggables.findShowLinks(),this.draggableView=new Cargo.Core.Draggables.DraggablesInstance({pageView:this}),Cargo.Core.ImageGallery.InitImageGallery({targetElement:this.el,forceReCollectionOfItems:!0}),this.setupPageLightbox(),this.marqueeInstance||(this.marqueeInstance=new Cargo.Core.MarqueeInstance({parentView:this})),this.marqueeInstance.findMarquees(),this.trigger("initial-setup")},render:function(){if(this.preventRender)console.info("Prevented rendering of page",this.model.id);else{if(void 0!==this.model){var e=Cargo.Core.Handlebars.ParseScriptTags(this.template),t=Cargo.API.GetDataPackage();_.extend(t,this.model.toJSON());var i,o=Cargo.Core.Handlebars.Render(e,t),n=document.createRange(),a=[];for(n.selectNode(document.body),i=n.createContextualFragment(o),_.each(i.querySelectorAll("script"),function(e){a.push({node:e,parentNode:e.parentNode,nextSibling:e.nextSibling}),e.parentNode.removeChild(e)}),this.el.innerHTML="";i.childNodes.length>0;)this.el.appendChild(i.childNodes[0]);var r=!1,s=function(e){r=!0};if(window.addEventListener("error",s,!1),_.each(a,function(e){r=!1;var t=$;$(e.node).on("load",function(){if($!==t){Cargo.Modal.Alert({message:"<em>External versions of jQuery are not supported. Please use the built-in version of jQuery</em>"});var e=this.ownerDocument.createComment(this.outerHTML);e.setSaveable(!0),this.parentNode.insertBefore(e,this),this.parentNode.removeChild(this),jQuery.noConflict(!0)}}),e.nextSibling&&e.nextSibling.parentNode===e.parentNode?e.parentNode.insertBefore(e.node,e.nextSibling):e.parentNode.appendChild(e.node),r&&(r=!1,e.node.parentNode.insertBefore(document.createComment(e.node.outerHTML),e.node),e.node.parentNode.removeChild(e.node),this.isAdminEdit&&Cargo.Modal.Alert({message:"<em>One or more scripts on this page are broken and were disabled.</em>"}))}),window.removeEventListener("error",s),1===this.el.children.length)if(null!==this.el.parentNode){var l=this.el.children[0];this.el.parentNode.insertBefore(l,this.el),this.el.parentNode.removeChild(this.el),this.setElement(l)}else this.setElement(this.el.children[0]);return this.$el.closest("[local-style]").attr("local-style",this.model.get("id")),this.initialSetup(),this.addBackdrop(),Cargo.Event.trigger("page_render_complete",this),this}console.warn("no model for page")}},finishGallerySetup:function(e){var t=!1,i=!1,o=closest(e.el,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("page")});o?(parseInt(o.getAttribute("data-id"))==this.model.get("id")&&(!this.isAdminEdit&&Cargo.Model.DisplayOptions.get("layout_options").image_zoom&&(t=!0),i=!0),t&&this.setupGalleryLightbox(e),i&&this.autoplayVideos()):Cargo.Event.off("image_gallery_rendered",this.finishGallerySetup)},setupGalleryLightbox:function(e){if(Cargo.Model.DisplayOptions.get("layout_options")&&Cargo.Model.DisplayOptions.get("layout_options").image_zoom){var t=$('img, a[rel="quick-view"]',e.el),i=$("a img",e.el);zoomItems=_.difference(t,_.difference(i,t))}else zoomItems=$('a[rel="quick-view"]',e.el);if("montessori"!=e.galleryOptions.path||e.mobile_active)zoomItems=_.sortBy(zoomItems,function(e){return parseInt(e.getAttribute("data-gallery-item-index"))});else{var o=e.serialize();zoomItems=_.sortBy(zoomItems,function(e){var t=0;if(e.hasAttribute("data-gallery-item-id"))t=parseInt(e.getAttribute("data-gallery-item-id"));else{var i=closest(e,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.hasAttribute("data-gallery-item-id")});i&&(t=parseInt(i.getAttribute("data-gallery-item-id")))}return _.findWhere(o,{index:t}).meta.montessori.y})}this.bindLightboxArray(zoomItems)},setupPageLightbox:function(e){var t=this;if(!this.isAdminEdit){var i,o=[];if(Cargo.Model.DisplayOptions.get("layout_options")&&Cargo.Model.DisplayOptions.get("layout_options").image_zoom){var n=$('img, a[rel="quick-view"]',this.el),a=$("a img",this.el);i=_.difference(n,_.difference(a,n))}else i=$('a[rel="quick-view"]',this.el);for(var r=[],s=0;s<i.length;s++){var l=i[s].hasAttribute("data-gallery-item-index")||i[s].parentNode.classList.contains("image-gallery");l&&r.length>0?(o.push(r),r=[]):l||r.push(i[s])}r.length>0&&o.push(r),_.each(o,function(e){t.bindLightboxArray(e)})}},bindLightboxArray:function(e){var t=this.model.get("images"),i=[],o=/Mobi/i.test(navigator.userAgent),n=Cargo.Model.DisplayOptions.get("layout_options")&&!Cargo.Model.DisplayOptions.get("layout_options").image_full_zoom;_.each(e,function(e){if("A"===e.tagName){if(e.hasAttribute("href")&&!e._lightboxHTML){var a=e.getAttribute("href"),r=_.find(this.embedLibrary,function(e){return e.testURL(a)}),s={};s.requiresGDocsEmbed=Cargo.Helper.isMobile()||Cargo.Helper.isIOS()||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;var l=e.search||!1;if(l){var d=l.split(/[&?]+/);_.each(d,function(e){var t=e.split("=");t.length>1&&(s[t[0]]="true"===t[1]||1==t[1]||1==t[1])})}if(s.hasOwnProperty("loop")||(s.loop=!0),r){var c=e.getAttribute("width")||"100%",h=e.getAttribute("height")||"100%";if(r.oembed_template){var u=new XMLHttpRequest;u.onreadystatechange=function(){if(4===u.readyState){var t;try{t=JSON.parse(u.response)}catch(e){}t&&(e._lightboxHTML=t.html,t.width&&(t.height?e._lightboxWidth=50*t.width:e._lightboxWidth=t.width),t.height&&(t.width?e._lightboxHeight=50*t.height:e._lightboxHeight=t.height))}},e._lightboxWidth=c,e._lightboxHeight=h;var g=r.oembed_template({width:c,height:h,url:encodeURIComponent(a),options:s});u.open("GET",g),u.send()}else r.html_template&&(r.getDimensions?r.getDimensions(a).then(function(t){e._lightboxWidth=t.width,e._lightboxHeight=t.height,e._lightboxHTML=r.html_template({width:t.width,height:t.height,url:a,options:s})}):e._lightboxHTML=r.html_template({width:c,height:h,url:a,options:s}),e._lightboxWidth=c,e._lightboxHeight=h)}}}else{if(!e.hasAttribute("data-src")||null!==closest(e,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("slick-cloned")||e.classList.contains("cloned_marquee_inner")||"A"===e.tagName})||e.hasAttribute("data-no-zoom")||e.hasAttribute("no-zoom"))return;if(o){var p,m=_.findWhere(t,{id:parseInt(e.getAttribute("data-mid"))});if(m){p=Math.floor(Math.min(250*Math.ceil(2*screen.width/250),m.get("width")));var f=m.getImageWithOptions({w:p,q:94});e._lightboxSrc=f.url,e._lightboxWidth=f.w,e._lightboxHeight=f.h}}e.classList.add("image-zoom")}i.push(e),$(e).on("click.zoom",function(e){if("A"===e.currentTarget.tagName){if(e.metaKey)return;if(!this._lightboxHTML)return void e.currentTarget.setAttribute("target","_blank");e.preventDefault(),e.stopPropagation()}if(lightbox.activeGallery){var t=_.indexOf(lightbox.activeGallery.imageArray,this);if(t>-1)lightbox.activeGallery.goTo(t);else{var o=this;lightbox.activeGallery.listen("destroy",function(){$(o).trigger("click.zoom")}),lightbox.activeGallery.close()}}else{var a=closest(this,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("marquee_inner")});lightbox.openImageArray(i,this,{disableZoom:n,preventAnimation:null!==a}),lightbox.activeGallery.listen("destroy",function(){$("body").off("click.close-zoom")}),_.defer(function(){$("body").on("click.close-zoom",function(e){lightbox.activeGallery&&(closest(e.target,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("pswp")||e.hasAttribute("rel")&&e.getAttribute("rel").indexOf("quick-view")>-1||e.classList.contains("image-zoom")})||lightbox.activeGallery.isMainScrollAnimating()||lightbox.activeGallery.close())})})}})},this)},autoplayVideos:function(){var e=this.$el.find(".page_content").get(0);if(void 0!==e&&!Cargo.Helper.IsAdminEdit()){var t=Cargo.Helper.isMobile();_.each(e.querySelectorAll("video[autoplay]"),function(e){if(!e._bound_by_pageView){e.hasAttribute("muted")&&(e.muted=!0),t&&!e.hasAttribute("playsinline")&&e.setAttribute("playsinline","");var i=e.hasAttribute("controls"),o=function(){i||e.removeAttribute("controls"),e.removeEventListener("play",o)};e.addEventListener("play",o);var n=e.play();void 0!==n&&n.then(function(){}).catch(function(t){e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2||e.play().catch(function(t){e.muted=!0,e.setAttribute("muted",""),e.play().catch(function(t){e.setAttribute("controls","")})})}),e._bound_by_pageView=!0}})}},getModel:function(){return this.model},markNodesAsOriginal:function(){var e=this.$el.find("projectcontent")[0];if(void 0!==e){Node.prototype.hasOwnProperty("setSaveable")&&this.getAllDescendants(e,function(e){e.setSaveable(!0)});var t=e.parentNode;for(t.setAttribute("data-ce-host","true"),t.setAttribute("data-ce-model-id",this.model.get("id"));e.childNodes.length>0;)t.insertBefore(e.childNodes[0],e);t.removeChild(e),0==t.querySelectorAll(".image-gallery").length&&this.autoplayVideos()}},getAllDescendants:function(e,t){for(var i=0;i<e.childNodes.length;i++){var o=e.childNodes[i],n=t(o);if(!1===n)return!1;"continue"!==n&&this.getAllDescendants(o,t)}},removeEmptyPagePadding:function(){if((!Cargo.Helper.IsAdminEdit()||top.Backbone.history.fragment!=this.model.get("id"))&&$(".page_content",this.$el).length>0){var e=""==$(".page_content",this.$el).html().trim(),t=this.$el.find("[data-backdrop]").length>0;e&&!t&&$("bodycopy",this.$el).removeClass("content_padding")}},getLocalCSSElement:function(){return this.el.querySelector(".local-css")},remove:function(){if(!this.preventRemove){window.__pin_preview_pageview__===this&&(delete window.__pin_preview_pageview__.preventRemove,delete window.__pin_preview_pageview__.preventRender,delete window.__pin_preview_pageview__);var e=$(".page_content",this.$el)[0];e&&Cargo.Helper.isMobile()&&_.each(e.querySelectorAll("video"),function(e){e.pause(),e.src="",e.innerHTML="",e.load()}),Cargo.Core.AudioPlayer.destroyPlayers(this.el),void 0!==Cargo.Helper.throttledScrollMonitorUpdate&&Cargo.Helper.throttledScrollMonitorUpdate(),this.removeBackdrop(),this.draggableView&&this.draggableView.remove(),this.__removed__=!0,Cargo.Event.trigger("pageview_removed",this),Backbone.View.prototype.remove.apply(this,arguments)}}}),Cargo.o.view.Set=Backbone.View.extend({constructor:function(){Backbone.View.prototype.constructor.apply(this,arguments)},initialize:function(e){this.parentSetView=e.parentSetView?e.parentSetView:null,null!==this.parentSetView&&this.listenTo(this.parentSetView,"remove",this.remove),this.listenTo(this,"remove",this.removeAllPages),this.listenTo(Cargo.Event,"pageview_removed",function(e){-1!==this.pageViews.indexOf(e)&&(this.pageViews=_.without(this.pageViews,e))});var t=!1;this.listenTo(this.model.get("pages"),"add",function(e,i,o){1==o.from_pagination?t=!0:!1!==o.render_changes&&this.render(!0,o)}),this.listenTo(this.model.get("pages"),"remove",function(e,t,i){var o=_.union(this.pageViews,this.setViews),n=_.findWhere(o,{model:e});n&&(n.remove(),this.pageViews=_.without(this.pageViews,n),this.setViews=_.without(this.setViews,n)),!0===i.render_changes&&this.render(!0,i),Cargo.Helper.throttledScrollMonitorUpdate()}),this.listenTo(Cargo.Event,"pagination_complete",function(e,i,o){t&&this.render(!0,o),t=!1}),this.listenTo(this.model,"tag_pagination_complete",function(e,i,o){t&&this.render(!0,o),t=!1}),this.listenTo(this.model,"destroy",function(){this.remove()}),this.pageViews=[],this.setViews=[],this.findAndInitializePrerenderedContent()},sortPagesAndUpdateDOM:function(){if(!(this.model.get("pages").length<=1)){this.model.get("pages").sort();var e=_.union(this.pageViews,this.setViews);e.sort(function(e,t){return e.model.get("sort")-t.model.get("sort")}),_.each(e,function(e){this.el.appendChild(e.el)},this)}},sortSetViews:function(){this.setViews.sort(function(e,t){return e.model.get("sort")-t.model.get("sort")})},sortPageViews:function(){this.pageViews.sort(function(e,t){return e.model.get("sort")-t.model.get("sort")})},removeAllPages:function(){_.each(this.pageViews,function(e){e.remove()}),this.pageViews=[]},removeAllSets:function(){_.each(this.setViews,function(e){e.remove()}),this.setViews=[]},render:function(e,t){t=t||{},_.defaults(t,{}),!0!==e&&(e=!1,this.removeAllPages(),this.removeAllSets());var i=!1,o=this.model.get("pages").getFirstIndexGap();this.model.get("pages").each(function(n,a,r){if("page"!==n.type||n.get("pin")){if("set"===n.type){if(e&&(void 0!==_.findWhere(this.setViews,{model:n})||void 0!==this.$el.children('[data-container="set"][data-id="'+n.get("id")+'"]')[0]))return;var s=Cargo.Core.SetViewFactory.constructSetView({parentSetView:this,model:n});s.el.setAttribute("data-container","set"),s.el.setAttribute("data-id",n.get("id")),this.el.appendChild(s.el),s.render(void 0,t),this.setViews.push(s),i=!0}}else{if(this.model.get("page_count")>1&&n.get("index")>o)return void console.warn("Pageview not rendered because set has gap before it.",n);if(e&&(void 0!==_.findWhere(this.pageViews,{model:n})||void 0!==this.$el.children('[data-container="page"][data-id="'+n.get("id")+'"]')[0]))return;var l;if(l="undefined"!=typeof __pin_preview_pageview__&&__pin_preview_pageview__.model===n?__pin_preview_pageview__:Cargo.Core.PageviewFactory.constructPageView({parentView:this,model:n}),e)if(a>0){var d=this.$el.children('[data-container][data-id="'+r[a-1].get("id")+'"]')[0];d?d.parentNode.insertBefore(l.el,d.nextSibling):0===n.get("index")&&Cargo.Helper.IsIndexableModel(n)?this.el.insertBefore(l.el,this.el.firstChild):this.el.appendChild(l.el)}else this.el.insertBefore(l.el,this.el.firstChild);else this.el.appendChild(l.el);l.render(),this.pageViews.push(l),i=!0}},this),i&&(this.sortPageViews(),this.sortSetViews(),Cargo.Event.trigger("set_render_complete",this,t))},findAndInitializePrerenderedContent:function(e){_.each(this.el.children,function(t){var i=t.getAttribute("data-container"),o=parseInt(t.getAttribute("data-id"),10),n=this.model.get("pages").findWhere({id:o});if(isNaN(Number(e))||o===e)if(n){if("set"===i){if(void 0===_.findWhere(this.setViews,{model:n})){var a=Cargo.Core.SetViewFactory.constructSetView({parentSetView:this,model:n,el:t});this.setViews.push(a)}}else if("page"===i&&void 0===_.findWhere(this.pageViews,{model:n})){var r=Cargo.Core.PageviewFactory.constructPageView({parentView:this,model:n,el:t});this.pageViews.push(r)}this.sortPageViews(),this.sortSetViews()}else Cargo.Collection.Scaffolding.fetchPageModel(o,{done:_.bind(function(e){e.get("id")===o&&(console.info("fetching",o,"success"),void 0!==this.model.get("pages").findWhere({id:o})?this.findAndInitializePrerenderedContent(o):console.info("can't locate newly added model."))},this)})},this)},getAllPageViews:function(){var e=[];return function t(i){e=_.union(e,i.pageViews),_.each(i.setViews,t)}(this),e},getAllSetViews:function(){var e=[];return function t(i){e=_.union(e,i.setViews),_.each(i.setViews,t)}(this),e},remove:function(){this.preventRemove||(Cargo.Helper.throttledScrollMonitorUpdate(),Backbone.View.prototype.remove.apply(this,arguments))}}),Cargo.o.view.Pin=Backbone.View.extend({no_render:!1,Data:{tallest_height:null},initialize:function(e){this.count=0,this.debouncedSortElements=_.debounce(this.sortElements,10),this.position=this.$el.data("view").replace("pinned_",""),this.template=$('[type="text/x-handlebars-template"]#pinned_'+this.position).html(),this.reversedSide="bottom",this.pinCollection=new Cargo.o.collection.pins(null,{position:this.position}),this.pinCollection.on("sort",this.debouncedSortElements,this),this.pinCollection.on("formatting_update_required",function(e,t){this.pinCollection.sort(),this.requestFormatTick()},this),this.initializePreRenderedPins(),this.requestFormatTick=_.bind(this.requestFormatTick,this),this.listenTo(Cargo.Event,"BaseUnit:refresh thumbnails_render_complete thumbnails_hide thumbnails_show pagination_complete inline-editor-load-complete set_render_complete elementresizer_refresh_complete format_pins",this.requestFormatTick,this),this.listenTo(Cargo.Event,"homepage_loaded content_load_complete refresh_pins mobile_breakpoint_triggered",function(){this.render(Cargo.Helper.GetCurrentProjectId(),!0)}),this.requestFormatTick(),"bottom"===this.position&&(this.pinCollection.each(function(e){var t=e.get("pageView").$el.find(".image-gallery").length>0;e.set({has_image_gallery:t})}),Cargo.Event.on("image_gallery_init_complete",_.bind(function(e){_.each(e,_.bind(function(e,t){var i=_.findWhere(this.pinCollection.models,{id:e});i&&i.set({image_gallery_init_completed:!0})},this))},this)))},initializePreRenderedPins:function(e){var t=[];this.$el.find('[data-container="content"]').each(_.bind(function(e,i){var o=parseInt($(i).data("id")),n=Cargo.Collection.Scaffolding.getModel({id:o});if(n){var a=new Cargo.o.view.Page({template:$('[type="text/x-handlebars-template"]#pin').html(),parentView:this,model:n,el:i.parentNode});t.push({id:o,pageView:a})}},this)),this.pinCollection.add(t);var i=this.filterExcludedPins(this.pinCollection.models);this.pinCollection.remove(_.pluck(i,"id"))},render:function(e,t){t=!0===t;var i,o,n,a=_.union(this.collection.getPinsByPositionSetId(this.position,!1),this.collection.getPinsByPositionSetId(this.position,e)),r=this.pinCollection.pluck("pageModel");n=this.filterExcludedPins(a,!0),t||(this.pinCollection.reset(),n=this.filterExcludedPins(this.pinCollection.models)),a=_.filter(a,function(e){return-1==n.indexOf(e)}),i=_.difference(r,a),i=_.union(i,_.intersection(r,n)),o=_.difference(a,r),_.difference(r,i,o);var s,l=[];_.each(o,function(e){"undefined"!=typeof __pin_preview_pageview__&&__pin_preview_pageview__.model===e?(s=__pin_preview_pageview__).stopListening(e):s=new Cargo.o.view.Page({template:$('[type="text/x-handlebars-template"]#pin').html(),parentView:this,model:e}),this.el.appendChild(s.el),s.render(),l.push({id:e.get("id"),pageView:s})},this),this.pinCollection.remove(_.pluck(i,"id")),this.pinCollection.add(l),(i.length>0||o.length>0)&&this.sortElements(),void 0!==Cargo.View.Content.activeLinkPID&&Cargo.View.Content.checkActiveLinks(Cargo.View.Content.activeLinkPID),(i.length>0||o.length>0)&&Cargo.Event.trigger("pin_load_complete")},filterExcludedPins:function(e,t){var i=document.documentElement.clientWidth,o=Cargo.Helper.IsMobileWindowSize(i),n=void 0!==Cargo.Helper.GetCurrentRoute()?Cargo.Helper.GetCurrentRoute():window.location.pathname.replace(/\//g,"");return _this=this,_.filter(e,function(e){if(Cargo.__admin_pid_required__===e.get("id"))return!1;var i=t?e:e.get("pageModel"),a=(i.get("project_url"),i.getPinOption("exclude_mobile")),r=i.getPinOption("exclude_desktop");return n!=i.get("project_url")&&n!=i.get("id")&&(o?a:r)})},sortElements:function(){var e=_.map(this.el.querySelectorAll(".page[data-id]"),function(e){return parseInt(e.dataset.id)}),t=this.pinCollection.pluck("id");if(!_.isEqual(e,t)){var i=this.el.querySelector('.page[data-id="'+Cargo.__admin_pid_required__+'"]');if(i&&i.parentNode){var o=t.indexOf(Cargo.__admin_pid_required__);this.pinCollection.each(function(e){e.id!=Cargo.__admin_pid_required__&&(t.indexOf(e.id)<o?this.el.insertBefore(e.get("pageView").el,i.parentNode):this.el.insertBefore(e.get("pageView").el,i.parentNode.nextSibling))},this)}else this.pinCollection.each(function(e){this.el.appendChild(e.get("pageView").el)},this);this.requestFormatTick()}},getPageViewById:function(e){var t=this.pinCollection.findWhere({id:e});if(void 0!==t)return t.get("pageView")},requestFormatTick:function(){var e=this;this.ticking||(this.ticking=!0,requestAnimationFrame(function(t){e.formatOverlayPages(),e.ticking=!1}))},formatOverlayPages:function(){this.formatting||(this.formatting=!0,this.levelKeys=_.keys(this.pinCollection.levels),this.pinCollection.each(function(e){var t=window.getComputedStyle(e.get("pageView").el,null),i=parseFloat(t.height)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom);e.set({page_height:i}),_.delay(_.bind(function(){this.setPagePointerEvents(e.get("pageModel"),e.get("pageView").$el)},this),250)},this),this.accommodatePages(),this.setHeightPerLevel(),this.positionPages(),this.setContainerHeight(),this.setContentContainerHeightforBottomPins(),Cargo.Event.trigger("pin_format_complete",this.position),this.formatting=!1,this.allowFixedSiteMenuToScroll(),"bottom"==this.position&&setTimeout(_.bind(function(){this.showAllBottomHiddenPins()},this),800))},allowFixedSiteMenuToScroll:function(){Cargo.View.SiteMenu&&Cargo.Helper.isMobile()&&Cargo.Helper.IsMobileWindowSize(document.documentElement.clientWidth)&&(1==this.pinCollection.length&&1==Cargo.View.SiteMenu.collection.length&&this.pinCollection.models[0].get("id")==Cargo.View.SiteMenu.collection.models[0].get("id")&&Cargo.Router._lastFrag==Cargo.View.SiteMenu.collection.models[0].get("project_url")&&(this.pinCollection.models[0].get("pageView").$el.removeClass("overlay fixed"),this.$el.css("height","")))},setContainerHeight:function(){var e=0;_.each(this.pinCollection.levels,function(t,i){e+=parseFloat(t.overall_height)}),this.$el.css("height",e)},setContentContainerHeightforBottomPins:function(){var e=$(".content_container"),t=!1;Cargo.Helper.IsAdminEdit()&&void 0!==parent&&void 0!==parent.Cargo&&void 0!==parent.Cargo.Editor&&void 0!==parent.Cargo.Editor.View&&void 0!==parent.Cargo.Editor.View.ContentView&&"editproject"===parent.Cargo.Editor.View.ContentView.id&&void 0!==Cargo.View.Content?(_.each(Cargo.View.Content.getActivePageViews(),function(e){e.model.id==Cargo.Helper.GetHomepageId()&&(t=!0)}),void 0===_.findWhere(this.pinCollection.models,{id:parent.Cargo.Editor.View.ContentView.pid})||"bottom"!=this.pinCollection.position||t?e.removeClass("full_height"):e.addClass("full_height")):e.removeClass("full_height")},setHeightPerLevel:function(){var e=this;_.each(this.pinCollection.levels,function(t,i){i=parseInt(i,10);if(0!==t.models.length){var o=0;self_accommodating=void 0!==t.tallest&&t.tallest.get("accommodate_same_set"),height_pages=_.filter(t.models,function(e){var i=e.getPinOptions(),o=!i.overlay&&!i.fixed,n=self_accommodating&&e==t.tallest;return o||n}),_.each(height_pages,function(e){o+=e.get("page_height")});var n=_.filter(t.models,function(t){if(void 0!==t.get("accommodated_by_pid"))return e.getPageDepthByPid(t.get("accommodated_by_pid"))!==i})[0];void 0!==n&&(o+=n.get("page_padding")),t.overall_height=o}})},positionPages:function(){var e=this,t=this.position;opposite_position="bottom"==this.position?"top":"bottom",this.pinCollection.each(function(i){var o=0,n=i.getPinOptions(),a=(i.get("id"),!n.fixed&&!n.overlay),r=!1,s=i.get("depth"),l=(i.get("sort"),e.levelKeys[e.levelKeys.indexOf(s+"")+1]),d=e.levelKeys[e.levelKeys.indexOf(s+"")-1],c=(e.pinCollection.levels[l],e.pinCollection.levels[d]),h=e.pinCollection.levels[s];if("bottom"==t){for(var u=0;u<=s;u++){var g=e.pinCollection.levels[u-1];void 0!==g&&(void 0===g.tallest||g.tallest.get("accommodated_next_set")?null==g.tallest&&(o+=g.overall_height):o+=g.overall_height)}a?c&&null==c.tallest?o-=c.overall_height:c&&void 0!==c.tallest&&c.tallest.get("accommodate_same_set")?o-=c.overall_height:0==s&&h&&h.tallest&&h.tallest.get("accommodate_same_set")&&(o-=h.tallest.get("page_height")):r=!0}else{for(u=0;u<=s;u++)void 0!==e.pinCollection.levels[u-1]&&(o+=e.pinCollection.levels[u-1].overall_height);a?c&&null==c.tallest?o-=c.overall_height:c&&void 0!==c.tallest&&c.tallest.get("accommodate_same_set")?o-=c.overall_height:void 0!==h.tallest&&h.tallest.get("accommodate_same_set")&&void 0!==c&&void 0!==c.tallest&&c.tallest.get("id")!==i.get("accommodated_by_pid")&&(o+=c.tallest.get("page_height")):r=!0}r&&s>0&&void 0!==d&&void 0!==c&&void 0!==c.tallest&&c.tallest.get("id")!==i.get("accommodated_by_pid")&&1==h.accommodated_by_previous_set&&(o+=c.tallest.get("page_height"));var p=i.get("pageView").$el[0];if(p.style[t]=o+"px",p.style[opposite_position]="",n.overlay){var m=0;if(void 0!==h)m=h.models.slice().reverse().indexOf(i);p.style.zIndex=e.pinCollection.deepestLevel+-s+4+m}})},removeModelFlags:function(){_.each(this.pinCollection.models,function(e){e.unset("accommodated_by_pid")})},removeLevelFlags:function(){_.each(this.pinCollection.levels,function(e,t){void 0!==e.accommodated_by_previous_set&&(e.accommodated_by_previous_set=!1),void 0!==e.accommodated_by_same_set&&(e.accommodated_by_same_set=!1)})},accommodatePages:function(){this.removeAccommodatePadding(),this.removeModelFlags(),this.removeLevelFlags();var e=this.position,t=this;_.each(this.pinCollection.levels,function(i,o){if(0!==i.models.length&&(o=parseInt(o,10),next_depth=t.levelKeys[t.levelKeys.indexOf(o+"")+1],prev_depth=t.levelKeys[t.levelKeys.indexOf(o+"")-1],i.tallest&&(i.tallest.unset("accommodate_same_set"),i.tallest.unset("accommodated_next_set"),i.tallest.unset("accommodated_pin"),i.tallest.unset("accommodated_pid"),i.tallest.unset("content_accommodate_page")),i.tallest=void 0,_.each(i.models,function(e){var t=e.getPinOptions();t.overlay&&t.accommodate&&(!i.tallest||e.get("page_height")>i.tallest.get("page_height"))&&(i.tallest=e)}),_.each(i.models,_.bind(function(e){e!==i.tallest&&this.showBottomHiddenPin(e)},this)),null!=i.tallest)){var n=this.reversedSide,a=_.filter(i.models,function(e){var t=e.getPinOptions();return!t.overlay&&!t.fixed}).sort(function(t,i){return e==n?i.get("sort")-t.get("sort"):t.get("sort")-i.get("sort")})[0];if(a)return this.accommodateSinglePage(a,i.tallest),i.tallest.set({accommodate_same_set:!0,accommodated_pin:!0,accommodated_pid:a.get("id")}),void(i.accommodated_by_same_set=!0);var r=this.pinCollection.levels[next_depth];if(r){var s=_.filter(r.models,function(e){return e.getPinOptions().overlay}).sort(function(t,i){return e==n?i.get("sort")-t.get("sort"):t.get("sort")-i.get("sort")})[0];if(null==s&&(s=_.filter(r.models,function(e){return!e.getPinOptions().overlay}).sort(function(t,i){return e==n?i.get("sort")-t.get("sort"):t.get("sort")-i.get("sort")})[0]),s)return this.accommodateSinglePage(s,i.tallest),r.accommodated_by_previous_set=!0,void i.tallest.set({accommodated_pin:!0,accommodated_pid:s.get("id"),accommodated_next_set:!0})}o===this.pinCollection.deepestLevel&&(this.accommodateSinglePagebyElement($(this.getContentContainerElementToAccommodate()),i.tallest),i.tallest.set("content_accommodate_page",!0))}},this)},removeAccommodatePadding:function(){var e="padding-"+this.position;this.pinCollection.each(function(t){t.get("page_padding")>0&&(t.get("pageView").$el.css({"padding-top":"","padding-bottom":"",top:"",bottom:""}).removeAttr("data-"+e),t.set("page_padding",0))}),$("[data-"+e+"]").css(e,"").removeAttr("data-"+e),$("[data-content-accommodated]").css(e,"").removeAttr("data-content-accommodated")},accommodateSinglePage:function(e,t){var i=t.get("page_height"),o="padding-"+this.position;e.get("pageView").$el.css(o,i).attr("data-"+o,!0),e.set({page_padding:i,accommodated_by_pid:t.get("id")}),this.showBottomHiddenPin(t)},showAllBottomHiddenPins:function(){_.each(this.pinCollection.models,_.bind(function(e){e.get("pageView").$el.removeClass("bottom_pin_invisibility")},this))},showBottomHiddenPin:function(e){!0===e.get("has_image_gallery")?e.get("image_gallery_init_completed")&&e.get("pageView").$el.removeClass("bottom_pin_invisibility"):!1===e.get("has_image_gallery")&&e.get("pageView").$el.removeClass("bottom_pin_invisibility")},getContentContainerElementToAccommodate:function(){var e,t,i=$('.content_container [data-container="page"]');i.length>0&&(e=i.get(0),t=i.get(i.length-1));var o=!1,n=Cargo.View.Thumbnail;return n&&(o=Cargo.View.Thumbnail.show_thumbs),"top"==this.position?e||(o?n.el:void 0):"bottom"==this.position?o&&n?n.el:t||void 0:void 0},accommodateSinglePagebyElement:function(e,t){var i=t.get("page_height"),o="padding-"+this.position;if($(e).css(o,i).attr("data-"+o,!0).attr("data-content-accommodated",!0),void 0!==$(e).attr("data-id")){var n=_.findWhere(this.current_page_models,{id:$(e).attr("data-id")});void 0!==n&&n.set("page_padding",i)}this.showBottomHiddenPin(t)},setPagePointerEvents:function(e,t){if(e.get("pin_options").overlay){var i=t.find(".bodycopy")[0],o=this.hasNoBackgroundColor(t.find(".page_background")[0]),n=this.hasNoBackgroundColor(t.find(".page")[0]),a=void 0!==i&&parseFloat(window.getComputedStyle(t.find(".bodycopy")[0]).height)>baseUnit.cache.window.h;if(!t.find(".page_background")[0])return;0==e.get("backdrop_enabled")&&(o?t.addClass("pointer-events-none"):t.removeClass("pointer-events-none"),n&&!a||!e.get("pin_options").fixed?t.find(".page").removeClass("pointer-events-auto"):t.find(".page").addClass("pointer-events-auto")),a&&e.get("pin_options").fixed?(t.find(".page").addClass("allow-scroll"),Cargo.Helper.isMobile()&&"bottom"==e.get("pin_options").position&&setTimeout(function(){t.css({bottom:"",top:0})},10)):t.find(".page").removeClass("allow-scroll")}},hasNoBackgroundColor:function(e){if(null==e)return!1;var t=window.getComputedStyle(e,null).getPropertyValue("background-color"),i=t.match("rgba")?alpha=t.replace(/^.*,(.+)\)/,"$1"):null;return null==t||"transparent"==t||"initial"==t||0==i},getPageDepthByPid:function(e){return this.pinCollection.findWhere({id:parseInt(e)}).get("depth")}}),Cargo.o.view.SiteMenu=Backbone.View.extend({template:$('[type="text/x-handlebars-template"]#sitemenu').html(),events:{"click #site_menu_panel_container a":"linkClick",click:"close",touchstart:"close","click .close":"hide","click [rel='site_menu']":"setToHideOverlayPage"},enabled:null,initialize:function(e){Cargo.Event.on("content_load_complete",_.bind(this.hide,this)),Cargo.Event.on("homepage_loaded",_.bind(this.hide,this)),this.collection.fetch(),this.siteMenuOptions=Cargo.Model.DisplayOptions.get("site_menu_options"),this.siteMenuOptions.single_page_id&&"page"===this.siteMenuOptions.display_type&&!0===this.siteMenuOptions.enable&&this.loadSiteMenuPageModel()},loadSiteMenuPageModel:function(e){Cargo.Collection.Scaffolding.fetchPageModel(this.siteMenuOptions.single_page_id,{done:_.bind(function(t){this.siteMenuPageModel=t,"function"==typeof e&&e()},this),silent:!0,render_changes:!1,insert:!1})},linkClick:function(){var e=!1,t=function(){e=!0};Cargo.Router.once("route",t,this),setTimeout(function(){Cargo.Router.off("route",t),!1===e&&this.hide()}.bind(this),1)},generateSiteMenuTree:function(){var e=Cargo.Collection.Scaffolding.getSetStructure(),t=this.collection.toJSON();for(_.each(e._byId,function(e){e.in_nav=void 0!==_.findWhere(t,{id:e.id}),e.has_children=!1}),i=0;i<t.length;i++)menuItem=t[i],"set"===menuItem.type?i>0&&(e._byId[menuItem.id].previous_type=t[i-1].is_set?"set":"page"):e._byId[menuItem.set_id]&&(e._byId[menuItem.set_id].has_children=!0,e._byId[menuItem.set_id].pages.push(menuItem));_.each(e._byId,function(e){e.pages.sort(function(e,t){return e.sort-t.sort})}),this.SiteMenuTree=e.tree,e=null},render:function(e){this.SiteMenuTree||this.generateSiteMenuTree(),this.site_menu_options=Cargo.Model.DisplayOptions.get("site_menu_options");var t=this.site_menu_options.display_type;if("page"!=t){var i=Cargo.API.GetDataPackage("site_menu_tree",this.SiteMenuTree);i=_.extend(i,{is_page:t});var o=Cargo.Core.Handlebars.Render(this.template,i);return $("#site_menu_panel_container",this.el).empty().show().html(o),$("html").addClass("no-scroll"),this.delegateEvents(),this.setActivePage(),this}},isActive:function(){return this.enabled},renderSingleOverlayPageView:function(e){var t=$("#site_menu_panel_container")[0];if(t){this.currentOverlayPageView&&this.currentOverlayPageView.remove(),!0===e.get("pin")&&(e=e.clone()).set("pin",!1);var i=Cargo.Core.PageviewFactory.constructPageView({model:e});t.innerHTML="",t.appendChild(i.el),this.currentOverlayPageView=i,Cargo.Event.once("page_render_complete",function(){window.requestAnimationFrame(function(){baseUnit.cache.window.w-i.$el[0].offsetWidth<20&&($("body")[0].style.overflow="hidden")})}),i.render(),i.$el.wrap('<div class="site_menu_page_wrapper"></div>'),i.$el.after('<div id="site_menu_page_overlay"></div>'),Cargo.Plugins.elementResizer.requestRefreshTick(),this.toggleOverlayPanel(!0,i)}},bindClickToCloseOverlay:function(e){var t=this;$("#site_menu_page_overlay").on("click.closeOverlaySiteMenu",function(i){t.hide(),$("#site_menu_page_overlay").off("click.closeOverlaySiteMenu"),e.$el.off("click.closeOverlaySiteMenu")}),e.$el.on("click.closeOverlaySiteMenu",function(i){0==$(i.target).closest('[data-container="content"]').length&&(t.hide(),$("#site_menu_page_overlay").off("click.closeOverlaySiteMenu"),e.$el.off("click.closeOverlaySiteMenu"))})},setActivePage:function(e){Cargo.Helper.IsOnHomepage()&&$('[rel="home_page"]',this.el).addClass("active");var t=Cargo.Helper.GetCurrentProjectUrl();$('[href="'+t+'"]',this.el).addClass("active")},toggleOverlayPanel:function(e,t){!0===e?($("#site_menu_panel_container")[0].style.display="",$("#site_menu_button",this.el)[0].style.display="none",this.enabled=!0,this.bindClickToCloseOverlay(t)):($("#site_menu_panel_container")[0].style.display="none",$("#site_menu_button",this.el)[0].style.display="",this.enabled=!1,this.currentOverlayPageView&&this.currentOverlayPageView.remove())},isLinkInEditor:function(e){return e.is('[rel="site_menu"]')&&!e.is("#site_menu_button")&&Cargo.Helper.IsAdminEdit()},show:function(e,t){var i,o=this,n=Cargo.Model.DisplayOptions.get("site_menu_options");if(void 0!==e?(e.preventDefault(),i=$(e.currentTarget)):void 0!==t&&(i=t),void 0!==i&&"page"==n.display_type){var a=i.is("#site_menu_button")||i.is('[rel="site_menu"]'),r=i.is('[rel="site_menu"]')&&0!==$(i).closest("#site_menu_panel_container").length;if(this.isLinkInEditor(i))return;if(a&&i[0].hasAttribute("href")||r)return!0===n.overlay_sitemenu_page?r?void this.toggleOverlayPanel(!1):void(null!==n.single_page_id&&void 0!==n.single_page_id?Cargo.Collection.Scaffolding.fetchPageModel(n.single_page_id,{done:function(e){o.renderSingleOverlayPageView(e)},render_changes:!1,insert:!1}):console.warn("There is no page set as the Site Menu")):void this.triggerNavigateToAPage(i)}$("#site_menu_button",this.el)[0].style.display="none",this.render(e),$("body")[0].style.overflow="hidden",this.enabled=!0},triggerNavigateToAPage:function(e){var t;if("/"!==e.attr("href")&&"#"!==e.attr("href")&&""!==e.attr("href"))t=e.attr("href");else if(this.siteMenuPageModel)t=this.siteMenuPageModel.get("project_url");else if(this.siteMenuOptions.single_page_id&&"page"===this.siteMenuOptions.display_type&&!1===this.siteMenuOptions.enable)return void this.loadSiteMenuPageModel(_.bind(function(){this.triggerNavigateToAPage(e)},this));void 0===t?Cargo.Modal.Alert({message:"Page Not Found"}):(Cargo.Event.trigger("add_history",t),this.enabled=!0)},setToHideOverlayPage:function(e){0!==$(e.currentTarget).closest("#site_menu_panel_container").length&&(e.preventDefault(),!0===Cargo.Model.DisplayOptions.get("site_menu_options").overlay_sitemenu_page&&this.toggleOverlayPanel(!1))},hide:function(e){var t=Cargo.Model.DisplayOptions.get("site_menu_options");$("#site_menu_panel_container",this.el)[0].style.display="none","page"===t.display_type?(!0===t.overlay_sitemenu_page&&this.toggleOverlayPanel(!1),t.single_page_id==parseInt(Cargo.Helper.GetCurrentProjectId())?!0===e?Action.Page.Home():setTimeout(_.bind(function(){this.enabled=!0,$("#site_menu_button",this.el)[0].style.display="none"},this),1):(this.enabled=!1,$("#site_menu_button",this.el)[0].style.display="")):(this.enabled=!1,$("#site_menu_button",this.el)[0].style.display=""),$("body")[0].style.overflow=""},close:function(e){"site_menu_panel"==$(e.target).attr("id")&&this.hide()},updateTitle:function(e,t){"page"==Cargo.Model.DisplayOptions.get("site_menu_options").display_type&&$("#site_menu_button",this.el).attr("href",t)},changeDisplayType:function(e,t,i){$("[data-type]",this.el).attr("data-type",e),this.$el.attr("data-type",e),"cargo_menu"==e?$("#site_menu_button",this.el).removeAttr("href"):this.UpdateSinglePageLink(t)},UpdateSinglePageLink:function(e){var t=Cargo.Collection.Scaffolding.getSetOrPageModel({id:Number(e)},!1);if(t)$("#site_menu_button",this.el).attr("href",t.get("project_url"));else{var i=this;Cargo.Collection.Scaffolding.fetchPageModel(e,{done:function(e,t){$("#site_menu_button",i.el).attr("href",e.get("project_url"))}})}}}),Cargo.o.view.Following=Backbone.View.extend({className:"persona-following-root",fauxFixedElements:[],animationDuration:450,animationInProgress:!1,followingWidth:"400px",enabled:!1,iframeLoadInitialized:!1,iframeLoaded:!1,section:!1,slideData:{delta:1,offset:0,lastOffset:0,closing:!0},initialize:function(){this.isInAdminOrPreviewMode=Cargo.Helper.IsAdminPath()||Cargo.Helper.IsAdminEdit()||Cargo.Helper.IsPresetPreview(),this.messageQueue=[],this.contentFrame=document.createElement("iframe"),this.contentFrame.id="following-frame",this.contentFrame.style.display="none",this.contentFrame.style.border="none",this.contentFrame.style.background="transparent",this.contentFrame.name="following-frame",this.followingOverlay=document.createElement("div"),this.followingOverlay.id="following-overlay",this.followingOverlay.style.display="none",this.followingOverlay.style.position="fixed",this.followingOverlay.style.top=0,this.followingOverlay.style.left=0,this.followingOverlay.style.right=0,this.followingOverlay.style.bottom=0,this.followingOverlay.style.zIndex=2147483637,this.followingOverlay.addEventListener("click",_.bind(function(){this.followingOverlay.classList.contains("prevent-close")||this.close()},this)),document.body.appendChild(this.followingOverlay),document.documentElement.appendChild(this.render().el);var e=document.createElement("div");e.id="following-container",e.style.background="#1a1a1a",this.el.parentNode.insertBefore(e,this.el),e.appendChild(this.el),this.container=e,this.contentWindow=this.contentFrame.contentWindow,this.contentFrame=$(this.contentFrame),/^\/?follow/.test(document.location.pathname)||/^\/?contact-form/.test(document.location.pathname)||/^\/?cart/.test(document.location.pathname)||!1===Cargo.Helper.isMobile()&&$(window).on("load",_.bind(function(){setTimeout(_.bind(function(){this.iframeLoadInitialized||this.loadFrameSection()},this),500)},this))},render:function(){return this.setElement(this.contentFrame),this},triggerEventInFrame:function(e,t){if(this.messageQueue)return this.iframeLoaded&&this.el.contentWindow&&this.el.contentWindow.Following?void this.el.contentWindow.Following.Events.trigger(e,t):(this.iframeLoadInitialized||this.loadFrameSection(),void this.messageQueue.push(arguments))},Toggle:function(e){if(e=e||{},!0!==this.animationInProgress)if(this.enabled)(null==Cargo.Router.previousSiteRoute||Cargo.Router.previousSiteRoute.match(/contact-form/g)||Cargo.Router.previousSiteRoute.match(/cart/g))&&(Cargo.Router.previousSiteRoute="/"),!0!==e.preventNavigate&&Cargo.Router.navigate(Cargo.Router.previousSiteRoute,{trigger:!1}),this.disable();else{Cargo.Event.trigger("add_history","following");var t=parent.document.getElementById("login_frame");null!==t&&t.parentNode.removeChild(t)}},loadSection:function(e,t){this.enabled||this.enable(t),this.loadFrameSection(e,t)},loadFrameSection:function(e,t){this.isInAdminOrPreviewMode&&!0!==t||("cart"===e&&Cargo.Model.Site.attributes.has_shop&&(this.container.style.background="#333"),!0!==this.iframeLoadInitialized?($(this.contentFrame).on("load",_.bind(function(){this.iframeLoaded=!0,this.messageQueue.length>0&&this.el.contentWindow.Following.Events.on("init-complete",function(){_.each(this.messageQueue,function(e){this.triggerEventInFrame.apply(this,e)},this),this.messageQueue=[]},this)},this)),this.contentFrame.attr("src","/followingframe/"+Cargo.Helper.GetUrl()+("string"==typeof e?"/"+e:"")+"?"+("undefined"!=typeof __cargo_js_ver__?__cargo_js_ver__:"")),this.iframeLoadInitialized=!0):this.el.contentWindow&&void 0!==this.el.contentWindow.Following&&void 0!==this.el.contentWindow.Following.View&&void 0!==this.el.contentWindow.Following.View.Main?(null==e&&void 0!==this.el.contentWindow.Following.View.Main.start_route&&(e=this.el.contentWindow.Following.View.Main.start_route),this.el.contentWindow.Following.Router.navigate(e,{trigger:!0,replace:!0})):this.contentFrame.attr("src","/followingframe/"+Cargo.Helper.GetUrl()+("string"==typeof e?"/"+e:"")+"?"+("undefined"!=typeof __cargo_js_ver__?__cargo_js_ver__:"")))},resizeListener:function(e){var t=document.getElementsByTagName("html")[0],i=window.innerWidth+"px",o=window.innerHeight+"px";!0===e&&(i="",o=""),t.style.width=i,t.style.height=o,document.body.style.width=i,document.body.style.height=o,$(window).width()>500?this.followingWidth="400px":this.followingWidth=$(window).width()-40+"px",document.documentElement.style.setProperty("--following-width","-"+this.followingWidth),this.enabled&&(document.body.style.setProperty("transform","translateX(-"+this.followingWidth+")"),document.body.style.setProperty("-webkit-transform","translateX(-"+this.followingWidth+")")),$("#following-container").css({width:this.followingWidth,height:o})},enable:function(e){if((!this.isInAdminOrPreviewMode||!0===e)&&!0!==this.animationInProgress){document.body,document.getElementsByTagName("html")[0];if(this.fixedElements=this.getFixedElements(),this.animationInProgress=!0,this.scrollAnchor=document.createElement("div"),this.scrollPos=window.scrollY,this.inlineStyles=document.createElement("style"),this.tempInlineStyles=document.createElement("style"),this.scrollAnchor.style.position="absolute",this.scrollAnchor.style.width="0px",this.scrollAnchor.style.height="0px",this.scrollAnchor.style.top=this.scrollPos+"px",document.body.appendChild(this.scrollAnchor),document.body.appendChild(this.tempInlineStyles),document.body.appendChild(this.inlineStyles),!this.isInAdminOrPreviewMode&&Cargo.Router.is_first_route)return this.direct_route=!0,this.prepareElementsForAnimation(),void this.realEnable();window.requestAnimationFrame(_.bind(function(){this.prepareElementsForAnimation(),this.realEnable()},this))}},prepareElementsForAnimation:function(){var e=document.body,t=document.getElementsByTagName("html")[0];this.tempInlineStyles.sheet.insertRule(".backdrop > div > * { \t-webkit-transform: translateZ(0);\t\t\ttransform: translateZ(0);}",0),e.style.setProperty("z-index","1"),e.style.setProperty("transform","translateZ(0)"),e.style.setProperty("-webkit-transform","rotateZ(0)"),e.style.setProperty("min-height",window.innerHeight+"px"),t.style.setProperty("transform","translateZ(0)"),t.style.setProperty("-webkit-transform","rotateZ(0)"),t.style.setProperty("min-height",window.innerHeight+"px"),this.resizeListener(),this.fixFixedElements(this.fixedElements),this.fixedElements=void 0,e.style.setProperty("position","fixed"),e.style.setProperty("overflow","hidden"),t.style.setProperty("position","fixed"),t.style.setProperty("overflow","hidden"),setTimeout(_.bind(function(){this.resizeListener()},this),150),this.scrollAnchor.scrollIntoView()},realEnable:function(){this.el.style.display="",this.triggerEventInFrame("frame-animation-starting",{}),this.inlineStyles.sheet.insertRule("#following-container { \twidth: "+this.followingWidth+";\theight: 100%;\tposition: absolute;\ttop: 0;\tbottom: 0;\tright: 0;}",0),this.inlineStyles.sheet.insertRule("#following-overlay.prevent-close { \tcursor: default;}",0),this.inlineStyles.sheet.insertRule("#following-overlay { \tcursor: pointer;}",0),this.scrollAnchor.scrollIntoView(),this.resizeListener=_.bind(this.resizeListener,this),window.addEventListener("resize",this.resizeListener,!1),this.scrollAnchor.parentNode.removeChild(this.scrollAnchor),this.scrollAnchor=void 0;var e=this.direct_route?0:this.animationDuration;document.documentElement.style.setProperty("--following-animation-duration",e+"ms"),setTimeout(_.bind(function(){this.enabled=!0,this.animationInProgress=!1,this.enableClickToClose(),this.tempInlineStyles.sheet.disabled=!0,this.direct_route&&(document.body.classList.remove("animate-left"),this.container.classList.remove("animate-left"),document.documentElement.style.setProperty("--following-animation-duration",this.animationDuration+"ms")),this.direct_route=!1},this),e),document.body.classList.remove("animate-right"),document.body.classList.add("animate-left"),this.container.classList.add("animate-left")},enableClickToClose:function(){this.followingOverlay.style.display="block"},disableClickToClose:function(){this.followingOverlay.style.display="none"},close:function(){this.Toggle()},disable:function(){window.requestAnimationFrame(_.bind(this.realDisable,this))},realDisable:function(){!0!==this.animationInProgress&&(this.animationInProgress=!0,window.focus(),void 0!==this.el.contentWindow.Following&&this.el.contentWindow.Following.Events.trigger("disable"),this.tempInlineStyles&&this.tempInlineStyles.sheet&&(this.tempInlineStyles.sheet.disabled=!1),setTimeout(_.bind(function(){this.enabled=!1,this.animationInProgress=!1,$("body").css({transform:"","-webkit-transform":""}),this.unfixFixedElements(),void 0!==this.inlineStyles&&(this.inlineStyles.sheet.disabled=!0,this.inlineStyles.parentNode.removeChild(this.inlineStyles)),void 0!==this.tempInlineStyles&&(this.tempInlineStyles.sheet.disabled=!0,this.tempInlineStyles.parentNode.removeChild(this.tempInlineStyles));var e=document.body,t=document.getElementsByTagName("html")[0];e.style.setProperty("z-index",""),e.style.setProperty("transform",""),e.style.setProperty("-webkit-transform",""),e.style.setProperty("min-height",""),t.style.setProperty("transform",""),t.style.setProperty("-webkit-transform",""),t.style.setProperty("min-height",""),e.style.setProperty("position",""),e.style.setProperty("overflow",""),t.style.setProperty("position",""),t.style.setProperty("overflow",""),this.resizeListener(!0),window.scrollTo(0,this.scrollPos),window.removeEventListener("resize",this.resizeListener,!1),this.disableClickToClose(),this.el.style.display="none",document.body.classList.remove("animate-right"),this.container.classList.remove("animate-right")},this),this.animationDuration),document.body.classList.remove("animate-left"),this.container.classList.remove("animate-left"),document.body.classList.add("animate-right"),this.container.classList.add("animate-right"))},isActive:function(){return this.enabled},getFixedElements:function(e){void 0===e&&(e=window.document);var t,i,o,n,a,r,s,l=['[style*="position:fixed"],[style*="position: fixed"]'],d=/\bposition:\s*fixed;/,c=e.styleSheets,h=[];for(i=0;i<c.length;i++){try{a=c[i].cssRules}catch(e){continue}if(null!==a)for(n=a.length,o=0;o<n;o++)r=a[o],d.test(r.cssText)&&null!=r.selectorText&&l.push(r.selectorText)}for(l=l.join(","),n=(l=e.querySelectorAll(l)).length,i=0;i<n;i++)s=l[i],"fixed"===(t=window.getComputedStyle(s,null)).getPropertyValue("position")&&h.push({el:s,offset:{left:isNaN(parseInt(t.getPropertyValue("left")))?0:parseInt(t.getPropertyValue("left")),top:isNaN(parseInt(t.getPropertyValue("top")))?0:parseInt(t.getPropertyValue("top"))},webkitTransformMatrix:"none"===t.getPropertyValue("-webkit-transform")?"":t.getPropertyValue("-webkit-transform"),transformMatrix:"none"===t.getPropertyValue("transform")?"":t.getPropertyValue("transform"),styleAttribute:s.getAttribute("style")});return h},fixFixedElements:function(e){this.unfixFixedElements();var t={top:$(window).scrollTop(),left:$(window).scrollLeft()};lastScrollPos=t.top,void 0===e&&(e=this.getFixedElements()),Cargo.Helper.isEdge()&&(t.top=0),this.scrollOffset=t,e.forEach(_.bind(function(e){e.el.style.setProperty("transform","translateY("+t.top+"px) "+e.transformMatrix,"important"),e.el.style.setProperty("-webkit-transform","translateY("+t.top+"px) "+e.webkitTransformMatrix,"important"),e.el.style.setProperty("transition","none","important"),e.el.style.setProperty("-webkit-transition","none","important"),this.fauxFixedElements.push(e)},this))},unfixFixedElements:function(){this.fauxFixedElements.forEach(function(e){e.el.style.removeProperty("transform"),e.el.style.removeProperty("-webkit-transform"),setTimeout(function(){null===e.styleAttribute||""===e.styleAttribute?e.el.removeAttribute("style"):e.el.setAttribute("style",e.styleAttribute)},1)}),this.scrollOffset=void 0,this.fauxFixedElements=[]}}),Cargo.o.view.Thumbnail=Backbone.View.extend({name:"Thumbnail",isEditing:!1,Subview:!1,MobileSubview:!1,PageModel:!1,ContentModel:!1,templates:{},template:$('[type="text/x-handlebars-template"]#thumbnail').html(),initialize:function(){return this.model||(this.model=Cargo.Model.ThumbnailSettings),Cargo.Event.on("mobile_size",_.bind(this.checkSizeAndActivateView,this)),Cargo.Event.on("content_load_complete",_.bind(function(e){this.checkAndLoadThumbnails(e)},this)),Cargo.Event.on("homepage_loaded",this.checkAndLoadThumbnails,this),Cargo.Event.on("thumbnails:load_tag",function(e,t){var i;t?(isNaN(Number(t))||(i=Cargo.Collection.Scaffolding.getSetOrPageModel({id:Number(t)})),i||(i=Cargo.Collection.Scaffolding.getModelByPurl(t)),i&&(t=i.get("id")),this.ContentModel=i,this.loadThumbnailsFor(void 0,{set_id:t,tags:e})):this.checkAndLoadThumbnails(void 0,{tags:e})},this),this.show_thumbs=null,this},events:{dragstart:"dragstart"},dragstart:function(e){if(Cargo.API.Config.cookie_url&&e.target.nodeType===Node.ELEMENT_NODE&&"IMG"===e.target.nodeName&&e.target.hasAttribute("data-mid")){var t=parseInt($(e.target).closest("[data-id]").attr("data-id"));if(!isNaN(t)){var i=this.collection.findWhere({id:t});if(i.get("thumb_meta")&&i.get("thumb_meta").thumbnail_crop){var o=new Cargo.o.model.image(i.get("thumb_meta").thumbnail_crop.imageModel);if(o&&0==/(.*?)\.(svg)$/g.test(o.getOriginalImage().url)){var n={drag_image_src:e.target.getAttribute("src"),image_url:o.getOriginalImage().url,source_url:window.location.origin+i.get("url"),source_title:i.get("title")+" - "+Cargo.Model.Site.GetWebsiteTitle(),tags:""===i.get("tags")?[]:i.get("tags").split(", "),excerpt:i.get("excerpt")};e.dataTransfer.setData("cargo/imageselection",JSON.stringify(n))}}}}},requestTemplate:function(e,t){this.listenTo(Cargo.Event,"template_loaded",this.checkTemplate),this.listenTo(Cargo.Event,"content_load_complete",this.setActiveThumb);var i=e||this.model.get("name"),o=t||this.model.getTemplatePath();if(this.templates[i]=Cargo.Template.Get(i,o),this.templates.Thumbnail=Cargo.Template.Get("Thumbnail"),_.contains(this.templates,void 0))return this;this.stopListening(Cargo.Event,"template_loaded");var n=this.model.get("data").mobile_data;return n&&n.separate_mobile_view&&this.model.get("data").responsive&&Cargo.Helper.IsMobileWindowSize(document.documentElement.clientWidth)?this.setupMobile():this.setup(),this},checkTemplate:function(e){if(!(e in this.templates))return this;if(this.templates[e]=Cargo.Template.Get(e),_.contains(this.templates,void 0))return this;this.stopListening(Cargo.Event,"template_loaded");var t=this.model.get("data").mobile_data;return t&&t.separate_mobile_view&&this.model.get("data").responsive&&Cargo.Helper.IsMobileWindowSize(document.documentElement.clientWidth)?this.setupMobile():this.setup(),this},setup:function(){this.addEventListeners();var e=Cargo.Collection.ThumbnailModes.findWhere({mode_id:this.model.get("mode_id")});return e?(require(["/_jsapps/thumbnails/"+e.get("path")+"/main.js"],_.bind(this.setupSubView,this)),this):this},setupMobile:function(){if(this.addEventListeners(),this.MobileSubview)this.render(this.MobileSubview);else{if(require.defined("!text")||Backdrop.Data.require_loaded){var e=this.model.get("data").mobile_data;return require(["text!/_jsapps/thumbnails/"+e.mobile_design_path+"/defaults.json","/_jsapps/thumbnails/"+e.mobile_design_path+"/main.js"],_.bind(this.setupMobileSubView,this)),this}_.delay(_.bind(this.setupMobile,this),100)}},activateMobile:function(){this.model.set("mobile_active",!0,{changing:"mobile_active"});var e=this.model.get("data").mobile_data;if(e&&e.separate_mobile_view&&e.mobile_design_path&&this.model.get("data").responsive){var t=e.mobile_design_path,i=this.model.getTemplatePath(t);this.templates&&this.templates[t.toCamel(!0)]?this.setupMobile():this.requestTemplate(t.toCamel(!0),i)}else e&&(this.templates&&this.templates[this.model.get("name")]||this.requestTemplate());return this},activateNormal:function(){if(this.model.set("mobile_active",!1,{changing:"mobile_active"}),!this.MobileSubview||!this.templates[this.model.get("name")])return this.templates&&this.templates[this.model.get("name")]?this:(this.requestTemplate(),this);this.setup()},addEventListeners:function(){return this.stopListening(Cargo.Event,"inline-editor-destroy-complete"),this.stopListening(this.model,"change"),!1!==this.PageModel&&this.stopListening(this.PageModel,"change"),this.stopListening(this.collection,"sync"),this.listenTo(this.collection,"sync",this.checkCollectionLengthAndSize),this.listenTo(Cargo.Event,"inline-editor-destroy-complete",function(){this.checkAndLoadThumbnails(Cargo.Helper.GetCurrentProjectId())},this),this.listenTo(this.model,"change",this.handleUpdates),!1!==this.PageModel&&this.listenTo(this.PageModel,"change",this.handleUpdates),this},setResponsive:function(){this.model.get("mobile_active")&&this.model.get("data").responsive?this.el.setAttribute("responsive-layout",""):this.el.removeAttribute("responsive-layout")},checkCollectionLengthAndSize:function(e,t,i){var o=!1;i&&i.params&&void 0!==i.params.page_id&&i.params.page_id!==this.currentPageID&&(o=!0),i=i||{},this.collection.length>0?(i&&i.from_thumbnail_reseed&&!1===this.show_thumbs||o||this.showThumbs(),this.checkSizeAndActivateView(Cargo.Helper.IsMobileWindowSize(document.documentElement.clientWidth)),this.checkPagination(),_.defer(function(){Cargo.Plugins.elementResizer.refresh()})):o||this.hideThumbs()},checkSizeAndActivateView:function(e,t){e&&this.model.get("data").responsive?this.model.get("mobile_active")&&this.MobileSubview.inited||this.activateMobile():!this.model.get("mobile_active")&&this.Subview.inited||this.activateNormal()},hideThumbs:function(){return this.Subview&&"function"==typeof this.Subview.hideThumbs&&this.Subview.hideThumbs(),this.show_thumbs=!1,this.el.style.display="none",Cargo.Event.trigger("thumbnails_hide"),this},showThumbs:function(){return this.Subview&&"function"==typeof this.Subview.showThumbs&&this.Subview.showThumbs(),this.show_thumbs=!0,this.el.style.display="",Cargo.Event.trigger("thumbnails_show"),this},setActiveThumb:function(e){var t=this.el.querySelector(".thumbnail.active"),i=this.el.querySelector('[data-id="'+e+'"].thumbnail');t&&t.getAttribute("data-id")!=e&&$(t).removeClass("active"),$(i).addClass("active")},handleUpdates:function(e,t){var i;if("page"===e.type){if(this.PageModel&&this.PageModel!==e)return;i=_.clone(e.getPageOption("thumbnail_options")),this.PageModel=e,this.ContentModel=e}else i=_.clone(this.model.get("data"));if(i){switch("filter_type"==t.changing&&"page"===e.type&&("tag"==t.value?setTimeout($.proxy(function(){e.setThumbnailOption("filter_tags",i.filter_tags)},this),100):"set"==t.value&&setTimeout($.proxy(function(){e.setThumbnailOption("filter_set",i.filter_set)},this),100)),t.changing){case"thumb_meta":this.setup();break;case"show_thumbs":case"show_local_thumbs":!0===t.value?this.checkAndLoadThumbnails(void 0,i):this.hideThumbs();break;case"thumbnail_mode":this.requestTemplate();break;case"mobile_active":case"responsive":this.setResponsive(),this.checkSizeAndActivateView(Cargo.Helper.IsMobileWindowSize(document.documentElement.clientWidth));break;case"filter_set":case"filter_tags":case"filter_type":case"random_limit":this.checkAndLoadThumbnails(void 0,i);break;default:this.ContentModel&&this.PageModel&&this.checkAndLoadThumbnails(this.PageModel.get("id"),this.PageModel.getPageOption("thumbnail_options"))}if(this.MobileSubview&&this.model.get("mobile_active")&&t&&this.model.get("data").responsive&&(t.mobile?i.mobile_data[t.mobile]=t.value:t.changing&&(i[t.changing]=t.value),i.show_thumbs||i.show_local_thumbs&&!i.show_thumbs)){var o=this.MobileSubview.model.get("data"),n=_.extend(o,i);this.MobileSubview.model.set("data",n,{silent:!0,changing:t.changing,value:t.value}),this.MobileSubview.handleUpdates(null,{changing:t.changing,value:t.value})}return this}},setupSubView:function(e){return this.Subview&&this.Subview.remove(),this.Subview=new e({model:this.model,collection:this.collection,parentView:this}),this.render(this.Subview),this.Subview.inited=!0,this},setupMobileSubView:function(e,t){this.MobileSubview&&this.MobileSubview.remove();var i=JSON.parse(e);_.extend(i,this.model.get("data"));var o=Cargo.Collection.ThumbnailModes.findWhere({path:i.mobile_data.mobile_design_path}),n=new Cargo.o.model.thumbnailsettings;return n.set({page_id:this.model.get("page_id"),site_id:this.model.get("site_id"),mobile_active:this.model.get("mobile_active"),mode_id:o.get("mode_id"),name:o.get("name"),path:o.get("path"),data:i}),this.MobileSubview=new t({model:n,collection:this.collection,parentView:this}),this.render(this.MobileSubview),this.MobileSubview.inited=!0,this},render:function(e){if(!this.canRender())return this;e||(e=this.Subview),this.setResponsive(),Handlebars.registerPartial("thumbnail_subview","");var t=Cargo.Template.Get("Thumbnail"),i=Cargo.Core.Handlebars.Render(t,{});this.$el.html(i);var o=this.$el.find(".thumbnails");return o.empty(),o.replaceWith(e.$el),e.render(),this.el._thumb_pagination_watcher||(Cargo.Event.on("thumbnail_pagination_complete",function(e,t,i){scrollMonitor.update(),this.checkPagination()},this),this.el._thumb_pagination_watcher=scrollMonitor.create(this.el,{bottom:2*-screen.height}),this.el._thumb_pagination_watcher.partiallyExitViewport(_.bind(function(){setTimeout(_.bind(this.checkPagination,this))},this)),this.checkPagination()),this},checkPagination:function(){!0===this.show_thumbs&&this.el._thumb_pagination_watcher&&!this.el._thumb_pagination_watcher.isBelowViewport&&this.collection.paginate()},canRender:function(){return!(_.contains(this.templates,void 0)||!Cargo.Collection.ThumbnailModes.length)},checkAndLoadThumbnails:function(e,t){var i,o,n=Cargo.Helper.GetPageViewById(e),a=this.ContentModel;if(this.ContentModel=Cargo.Collection.Scaffolding.getModel({id:e}),this.PageModel=!!n&&n.model,this.currentPageID=e,!Cargo.API.Config.direct_link_pid||!this.ContentModel||this.ContentModel!==a){if(!this.ContentModel)if($("script[data-set='FirstloadThumbOptions']").html()&&(o=$.parseJSON($("script[data-set='FirstloadThumbOptions']").html())),o)0===o.length&&(o=void 0);else{var r=Cargo.Collection.Tags.findTagByUrl(e);if(r)o={tags:r.get("url")};else if(_.isUndefined(t)&&!this.model.get("data").show_thumbs)return}if($("script[data-set='FirstloadThumbOptions']").remove(),!this.ContentModel&&_.isUndefined(t)&&(!o||_.size(o)<=1)&&!this.model.get("data").show_thumbs)return this.hideThumbs(),void this.addEventListeners();this.ContentModel&&("set"==this.ContentModel.type?(i=this.ContentModel.get("thumbnail_options"),o=void 0):void 0!==this.ContentModel.type&&!0!==this.ContentModel.get("pin")&&!(i=this.ContentModel.getPageOption("thumbnail_options"))&&o&&(o.use_global_thumb_settings=!0));var s=_.clone(o||(t||i));this.loadThumbnailsFor(e,s),this.addEventListeners()}},loadThumbnailsFor:function(e,t){var i;if(t)i=t.use_global_thumb_settings?_.clone(this.model.get("data")):t;else if((i=_.clone(this.model.get("data"))).show_thumbs){var o,n=Cargo.Collection.Scaffolding.getModel({id:e});if(n&&0!==n.get("id"))(o=Cargo.Collection.Tags.findTagByUrl(n.get("project_url")))?(console.log("thumb index: tag/set url collision"),n&&n.get("is_set")?n.get("stack")||(i.set_id=n.get("id")):"bdif"!==Cargo.API.Config.cargo_url&&(i.show_thumbs=!1)):n&&n.get("is_set")&&!n.get("stack")&&(i.set_id=n.get("id"));else(o=Cargo.Collection.Tags.findTagByUrl(e))&&(i.tags=o.get("url"))}if(void 0!==i.show_local_thumbs&&(i.show_thumbs=i.show_local_thumbs),!1===i.show_thumbs)this.hideThumbs();else{var a=this.collection.fetch({params:this.getCollectionSettingsForOptions(e,i),reset:!0,success:_.bind(function(e,t){this.checkCollectionLengthAndSize.apply(this,arguments)},this)});a&&a.readyState!==XMLHttpRequest.DONE&&(this.el.style.visibility="hidden",Cargo.View.PinnedBottom.el.style.visibility="hidden",a.always(_.bind(function(){this.el.style.visibility="",Cargo.View.PinnedBottom.el.style.visibility=""},this)))}},getCollectionSettingsForOptions:function(e,t){var i={tags:void 0,page_id:void 0,set_id:void 0,random_limit:void 0,force_all:void 0};return t&&(t.tags||t.set_id?(i.tags=t.tags,i.set_id=t.set_id):"set"==t.filter_type?i.set_id=t.filter_set:"tag"==t.filter_type?i.tags=t.filter_tags:"random"==t.filter_type?(i.page_id=e,i.random_limit=parseInt(t.random_limit),isNaN(i.random_limit)&&(i.random_limit=10)):"all"==t.filter_type?(i.page_id=e,i.force_all=!0):i.page_id=e),i},updateIsEditing:function(e){this.isEditing=e==this.model.get("name"),this.trigger("is_editing",this.isEditing)},getIsEditing:function(){return this.isEditing},getActiveSubView:function(){return this.model.get("mobile_active")&&this.MobileSubview&&this.model.get("data").responsive?this.MobileSubview:this.Subview},updateThumbnailCrop:function(e,t,i){var o=this.collection.findWhere({id:e});if(o){if(o.set("thumb_meta",{thumbnail_crop:t},{silent:!0}),i)return void this.handleUpdates(o,{changing:"thumb_meta"});if(i)return;var n=this.el.querySelector('[data-id="'+e+'"].thumbnail img');n&&("function"==typeof t.imageModel.get?(n.setAttribute("width",t.imageModel.get("width")),n.setAttribute("height",t.imageModel.get("height"))):(n.setAttribute("width",t.imageModel.width),n.setAttribute("height",t.imageModel.height)),i?Cargo.Plugins.elementResizer.refresh():(n.style.width=t.percentWidth+"%",n.style.marginLeft=t.marginLeft+"%",n.style.marginTop=t.marginTop+"%",Cargo.Plugins.elementResizer.update()))}}}),Cargo.o.view.TemplateButton=Backbone.View.extend({data:{creating:!1},el:"body",events:{"click .new_site_button":"confirmCreate","mouseover .new_site_button":"showFull","mouseout .new_site_button":"hideFull"},enabled:null,is_inframe:!1,initialize:function(e){Cargo.API.Config.is_template&&(parent==window?this.render():($("body").addClass("template_site_inframe"),this.is_inframe=!0)),window.addEventListener("message",this.onPostMessage,!1)},render:function(e){var t=this,i=Cargo.Core.Handlebars.Render('<div class="new_site_button_wrapper"><div class="new_site_button"><div class="text">Make a site with this Template</div><div class="plus"><svg id="plus_makesite" x="0px" y="0px" viewBox="0 0 44 44" style="enable-background:new 0 0 44 44;"><defs><mask id="specialMask"><rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect><g id="specialOrderText" fill="#000000"><line class="cls-3" x1="10" x2="34" y1="22" y2="22"/><line class="cls-3" y1="10" y2="34" x1="22" x2="22"/></g></mask></defs><g class="masked" style="mask: url(\'#specialMask\');"><g id="transform-rect"><rect id="rect" x="0" y="0" width="44" height="44" style="fill: #f00;"></rect></g></g></svg></div></div></div>');return $("body").append(i).addClass("template_site"),this.data.currentID=Cargo.Model.Site.get("id"),this.delegateEvents(),$.get("/_jsapps/modal/modal.html",function(e){t.createsitemodal=new modal,t.createsitemodal.template=_.template(e)}),this},onPostMessage:function(e){e.data&&e.data.redirect_url&&(window.onbeforeunload=null,document.location.href=e.data.redirect_url),e.data&&e.data.tab_index&&this.is_inframe&&("off"===e.data.tab_index?setTimeout(function(){$("*").not('[tabindex="-1"]').addClass("tabindex-off").attr("tabindex","-1")},100):"clear"===e.data.tab_index&&$(".tabindex-off").attr("tabindex","").removeAttr("tabindex").removeClass("tabindex-off"))},remove:function(){window.removeEventListener("message",this.onPostMessage)},confirmCreate:function(e){var t=this;t.createsitemodal.Confirm({message:"Make a site with this Template?",confirm:function(){t.start(e)}}),t.$el.addClass("createsitemodal")},start:function(e){e.preventDefault(),require(["/_jsapps/admin/_models/adminsite.js"],_.bind(function(e){this.data.AdminSite=new e,this.data.AdminSite.set("template_id",this.data.currentID),this.data.AdminSite.save({},{success:_.bind(function(e,t,i){if(0!=t.length){Cargo.Modal.Block({message:""});var o="https://auth.cargo.site/newsitesignup/"+e.get("sites_uid")+"/"+e.get("master_muid")+"/"+e.get("progress_id")+"?template_id="+this.data.currentID;Cargo.Modal.$el.addClass("signup"),Cargo.Modal.$el.find(".confirm-box").html('<iframe src="'+o+'"></iframe>'),Cargo.Modal.$el.find("iframe").css({width:"100%",height:"calc(100% + 1px)",border:"none"}),document.body.style.overflow="hidden"}},this),error:_.bind(function(e,t,i){var o=$.parseJSON(t.responseText);0!=o.length&&alert(o.message)},this)})},this))},requestStartProgress:function(){this.requests++,$.ajax({method:"POST",dataType:"json",url:"/dispatch/siteservices/checkSiteCopyStatus",data:{new_site_uid:this.data.AdminSite.get("sites_uid"),template_site_uid:this.data.AdminSite.get("template_id"),progress_id:this.data.AdminSite.get("progress_id")},success:_.bind(function(e){if(!(e.error&&e.error.length>0)){var t=this.requests>100?1500:500*Math.random()+250;clearTimeout(this.data.requestTimeout),this.data.requestTimeout=setTimeout(_.bind(this.requestStartProgress,this),t),e&&e.jdata&&console.log(e.jdata)}},this),error:_.bind(function(){var e=this.requests>100?1500:500*Math.random()+250;clearTimeout(this.data.requestTimeout),this.data.requestTimeout=setTimeout(_.bind(this.requestStartProgress,this),e)},this)})},displayCompletionStatus:function(e){var t=e.percent;t<10&&(t=Math.min(.1*this.requests,10)),this.createsitemodal.UpdateProgress(Math.round(t)),t>=100&&(clearTimeout(this.data.requestTimeout),setTimeout(_.bind(function(){window.onbeforeunload=null,document.location.href=this.data.redirect_url},this),1e3))}}),Cargo.o.view.ProductWidget=Backbone.View.extend({defaults:{price:!0,button_text:"Add to Cart"},initialize:function(e){this.activeSKU=void 0,requirejs(["text!/_jsapps/ecommerce/_templates/productWidget.html"],_.bind(function(e){this.template=_.template(e),this.requestedRender&&(delete this.requestedRender,this.render()),Cargo.Event.trigger("format_pins")},this))},events:{"change [name='skus']":"changeSKU","click [data-add-cart]":"addToCart"},getOptions:function(){var e={};if(this.el.hasAttribute("data-options"))try{e=JSON.parse(this.el.getAttribute("data-options"))}catch(e){}return _.defaults(e,this.defaults)},updateOptions:function(e){if(e){var t=this.getOptions();t=_.extend(t,e);try{this.el.setAttribute("data-options",JSON.stringify(t))}catch(e){console.warn("unable to store widget settings",e)}return this.render(),t}},formatPriceForCurrency:function(e,t,i){var o;if(void 0!==i&&(e*=i),"string"!=typeof t)o=e/100+"";else{var n={AED:"د.إ",AFN:"؋",ALL:"L",AMD:"֏",ANG:"ƒ",AOA:"Kz",ARS:"$",AUD:"$",AWG:"ƒ",AZN:"₼",BAM:"KM",BBD:"$",BDT:"৳",BGN:"лв",BHD:".د.ب",BIF:"FBu",BMD:"$",BND:"$",BOB:"$b",BRL:"R$",BSD:"$",BTC:"฿",BTN:"Nu.",BWP:"P",BYR:"p.",BZD:"BZ$",CAD:"$",CDF:"FC",CHF:"CHF",CLP:"$",CNY:"¥",COP:"$",CRC:"₡",CUC:"$",CUP:"₱",CVE:"$",CZK:"Kč",DJF:"Fdj",DKK:"kr",DOP:"RD$",DZD:"دج",EEK:"kr",EGP:"£",ERN:"Nfk",ETB:"Br",ETH:"Ξ",EUR:"€",FJD:"$",FKP:"£",GBP:"£",GEL:"₾",GGP:"£",GHC:"₵",GHS:"GH₵",GIP:"£",GMD:"D",GNF:"FG",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"₪",IMP:"£",INR:"₹",IQD:"ع.د",IRR:"﷼",ISK:"kr",JEP:"£",JMD:"J$",JOD:"JD",JPY:"¥",KES:"KSh",KGS:"лв",KHR:"៛",KMF:"CF",KPW:"₩",KRW:"₩",KWD:"KD",KYD:"$",KZT:"лв",LAK:"₭",LBP:"£",LKR:"₨",LRD:"$",LSL:"M",LTC:"Ł",LTL:"Lt",LVL:"Ls",LYD:"LD",MAD:"MAD",MDL:"lei",MGA:"Ar",MKD:"ден",MMK:"K",MNT:"₮",MOP:"MOP$",MRO:"UM",MUR:"₨",MVR:"Rf",MWK:"MK",MXN:"$",MYR:"RM",MZN:"MT",NAD:"$",NGN:"₦",NIO:"C$",NOK:"kr",NPR:"₨",NZD:"$",OMR:"﷼",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"₱",PKR:"₨",PLN:"zł",PYG:"Gs",QAR:"﷼",RMB:"￥",RON:"lei",RSD:"Дин.",RUB:"₽",RWF:"R₣",SAR:"﷼",SBD:"$",SCR:"₨",SDG:"ج.س.",SEK:"kr",SGD:"$",SHP:"£",SLL:"Le",SOS:"S",SRD:"$",SSP:"£",STD:"Db",SVC:"$",SYP:"£",SZL:"E",THB:"฿",TJS:"SM",TMT:"T",TND:"د.ت",TOP:"T$",TRL:"₤",TRY:"₺",TTD:"TT$",TVD:"$",TWD:"NT$",TZS:"TSh",UAH:"₴",UGX:"USh",USD:"$",UYU:"$U",UZS:"лв",VEF:"Bs",VND:"₫",VUV:"VT",WST:"WS$",XAF:"FCFA",XBT:"Ƀ",XCD:"$",XOF:"CFA",XPF:"₣",YER:"﷼",ZAR:"R",ZWD:"Z$"};t=t.toUpperCase(),-1===["BIF","CLP","DJF","GNF","JPY","KMF","KRW","MGA","PYG","RWF","VND","VUV","XAF","XOF","XPF"].indexOf(t)&&(e/=100),o="undefined"!=typeof Intl?new Intl.NumberFormat(Cargo.__ecommerce_locale__||"en-US",{style:"currency",currency:t,currencyDisplay:"symbol",useGrouping:!0,minimumFractionDigits:0}).format(e):(n.hasOwnProperty(t)?n[t]:t+" ")+""+e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}if("string"==typeof o&&-1!==o.indexOf(".")){var a=o.split(".");2===a.length&&1===a[1].length&&(a[1]=a[1]+"0",o=a.join("."))}return o},render:function(){if(this.template){var e;void 0!==this.model&&((e=this.model.toJSON()).skus.data.sort(function(e,t){var i=_.reduce(e.attributes,function(e,t){return e+t},""),o=_.reduce(t.attributes,function(e,t){return e+t},"");return i<o?-1:i>o?1:0}),!this.activeSKU&&e.skus.data.length>0&&(this.activeSKU=e.skus.data[0]));var t=this.template({formatPriceForCurrency:this.formatPriceForCurrency,options:this.getOptions(),product:e,activeSKU:this.activeSKU,has_inventory:this.checkIfInventoryAvailable()});return this.el.innerHTML=t,this.el.setAttribute("contenteditable",!1),this}this.requestedRender=!0},changeSKU:function(e){var t=e.target[e.target.selectedIndex].value,i=_.findWhere(this.model.get("skus").data,{id:t});i&&(this.activeSKU=i,this.render())},checkIfInventoryAvailable:function(){if(this.activeSKU){if("finite"===this.activeSKU.inventory.type&&this.activeSKU.inventory.quantity>0)return!0;if("infinite"===this.activeSKU.inventory.type)return!0;if("bucket"===this.activeSKU.inventory.type&&("in_stock"===this.activeSKU.inventory.value||"limited"===this.activeSKU.inventory.value))return!0}return!1},addToCart:function(e){this.model&&!Cargo.Helper.IsAdminEdit()&&(e.preventDefault(),Cargo.View.Following.triggerEventInFrame("add-sku-to-cart",{sku:this.activeSKU.id,product:this.model.get("id")}))}}),window.Vimeo={},_.defer(function(){define("jquery",[],function(){return jQuery})}),function(){jQuery.noConflict=function(){return console.warn("Detected a call to jQuery.noConflict. Preventing this from happening so we don't brick user sites."),jQuery};var e=function(e){return!(!e||"string"!=typeof e||-1===e.indexOf("googletagmanager.com/gtm.js"))};(function(){var e=/\/adminedit/.test(document.location.pathname)||/\/admin/.test(document.location.pathname);try{var t=parent!=window&&"object"==typeof parent.Cargo,i=null!=Cargo.Editor;return e||t||i}catch(e){return!1}})()&&(document.createElement=function(){if("script"!==arguments[0].toLowerCase())return document.__proto__.createElement.apply(document,arguments);var t=document.__proto__.createElement.apply(document,arguments),i=t.setAttribute.bind(t);return Object.defineProperty(t,"src",{get:function(){return t.getAttribute("src")},set:function(t){return e(t)&&i("type","javascript/blocked"),i("src",t),!0}}),Object.defineProperty(t,"type",{set:function(o){return i("type",e(t.src)?"javascript/blocked":o),!0}}),t.setAttribute=function(e,i){"type"===e||"src"===e?t[e]=i:HTMLScriptElement.prototype.setAttribute.apply(t,arguments)},t})}(),$(function(){requirejs.onError=function(e){e.stack?console.error(e.stack):console.error(e),Cargo.utils.errorHandler.report(e)},requirejs.config({paths:{text:"//static.cargo.site/libs/require/text.2.0.16.min",css:"//static.cargo.site/libs/require/css.min"},urlArgs:"undefined"!=typeof __cargo_js_ver__?__cargo_js_ver__:void 0}),document.body.style.visibility="";var e=Backbone.View.prototype.remove;Backbone.View.prototype.remove=function(){this.trigger("remove"),e.apply(this,arguments)},Cargo.API=new Cargo.o.api,Cargo.Helper=new Cargo.o.helpers,Cargo.Template=new Cargo.o.templates,Cargo.Router=new Cargo.o.router,Cargo.Model.DisplayOptions=new Cargo.o.model.display_options,Cargo.Model.Site=new Cargo.o.model.site,Cargo.Model.Image=new Cargo.o.model.image,Cargo.Model.Css=new Cargo.o.model.css,Cargo.Model.Tag=new Cargo.o.model.tag,Cargo.Model.ThumbnailSettings=new Cargo.o.model.thumbnailsettings,Cargo.Collection.Images=new Cargo.o.collection.images,Cargo.Collection.Scaffolding=new Cargo.o.collection.scaffolding,Cargo.Collection.SiteMenu=new Cargo.o.collection.sitemenu,Cargo.Collection.StripeProducts=new Cargo.o.collection.StripeProductCollection,Cargo.Collection.ThumbnailSettings=new Cargo.o.collection.thumbnailsettings,Cargo.Collection.ThumbnailModes=new Cargo.o.collection.thumbnailmodes,Cargo.Collection.GlobalThumbnails=new Cargo.o.collection.thumbnails,Cargo.Collection.Tags=new Cargo.o.collection.tags,Cargo.Model.DisplayOptions.once("change",function(){Cargo.Event.trigger("display_options_available",Cargo.Model.DisplayOptions)}),Cargo.Model.DisplayOptions.fetch({reset:!0}),Cargo.Analytics=new Cargo.o.analytics,Cargo.Model.Site.fetch(),Cargo.Model.ThumbnailSettings.fetch(),Cargo.Collection.Scaffolding.fetch(),Cargo.Collection.ThumbnailSettings.fetch(),Cargo.Collection.ThumbnailModes.fetch(),Cargo.Core.InitEcommerce=function(){!0===Cargo.Model.Site.get("has_shop")&&!1===Cargo.Helper.IsAdminPath()&&("staging"===__cargo_context__?requirejs.config({paths:{ecommerce:"/_jsapps/ecommerce-v2"}})(["ecommerce/ecommerce-client"],function(){console.log("shop frontend loaded")}):requirejs.config({paths:{ecommerce:"/_jsapps/ecommerce-v2"}})(["ecommerce/dist/client-package"],function(){console.log("built shop frontend loaded",arguments)})),!0===Cargo.Model.Site.get("has_ecommerce")&&!0!==Cargo.Model.Site.get("has_shop")?Cargo.Collection.StripeProducts.fetch({success:function(e){Cargo.Collection.StripeProducts.productSyncOccurred=!0},error:function(){Cargo.Collection.StripeProducts.productSyncOccurred=!0}}):Cargo.Collection.StripeProducts.productSyncOccurred=!0},Cargo.Core.InitEcommerce(),Cargo.Helper.TestUrlCaseAndRedirect(),Cargo.Helper.IsAdminPath()||(Cargo.Backdrop=Cargo.View.Backdrop=Backdrop.View.Backdrop=new Cargo.o.view.Backdrop),Cargo.Helper.IsAdminPath()&&(Cargo.Collection.ImageLibrary=new Cargo.o.collection.images,Cargo.Collection.ImageLibrary.fetch()),Cargo.View.Following=new Cargo.o.view.Following,Cargo.View.TemplateButton=new Cargo.o.view.TemplateButton,void 0===Cargo.View.Main&&(Cargo.View.Main=new Cargo.o.view.Main({el:"body",collection:Cargo.Model.Site})),Cargo.Template.FindAndAddViewStubs(),Cargo.Template.LoadFoundViews(),Cargo.Helper.isOldIE()||Cargo.Helper.IsAdminPath()||(Cargo.Router.is_first_route=!0,Backbone.history.start({pushState:!0,hashChange:!1,root:Cargo.Helper.GetHomeUrl(!0)})),Cargo.Core.KeyboardShortcut.InitDefaults(),Cargo.Template.LoadAll(),Cargo.Template.LoadFoundViews(),Cargo.Core.ImageGallery.initialize(),Cargo.Core.Ecommerce.initialize(),Cargo.Core.InitKeycodeListener(),Cargo.Core.InitMessageListener(),"undefined"!=typeof scrollMonitor&&(Cargo.Helper.throttledScrollMonitorUpdate=_.throttle(scrollMonitor.update,50)),Cargo.Event.trigger("init_complete")}),function(e){"use strict";!function(e){var t=window.Slick||{};(t=function(){var t=0;return function(i,o){var n,a=this;a.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:e(i),appendDots:e(i),arrows:!0,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev" aria-label="Previous" tabindex="0" role="button">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next" aria-label="Next" tabindex="0" role="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(t,i){return e('<button type="button" data-role="none" role="button" tabindex="0" />').text(i+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,preventDefaults:!0,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},a.initials={animating:!1,dragging:!1,autoPlayTimer:null,hideUITimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},e.extend(a,a.initials),a.activeBreakpoint=null,a.animType=null,a.animProp=null,a.breakpoints=[],a.breakpointSettings=[],a.cssTransitions=!1,a.focussed=!1,a.interrupted=!1,a.hidden="hidden",a.paused=!0,a.positionProp=null,a.respondTo=null,a.rowCount=1,a.shouldClick=!0,a.$slider=e(i),a.$slidesCache=null,a.transformType=null,a.transitionType=null,a.visibilityChange="visibilitychange",a.windowWidth=0,a.windowTimer=null,n=e(i).data("slick")||{},a.options=e.extend({},a.defaults,o,n),a.currentSlide=a.options.initialSlide,a.originalSettings=a.options,void 0!==document.mozHidden?(a.hidden="mozHidden",a.visibilityChange="mozvisibilitychange"):void 0!==document.webkitHidden&&(a.hidden="webkitHidden",a.visibilityChange="webkitvisibilitychange");a.autoPlay=e.proxy(a.autoPlay,a),a.autoPlayClear=e.proxy(a.autoPlayClear,a),a.autoPlayIterator=e.proxy(a.autoPlayIterator,a),a.changeSlide=e.proxy(a.changeSlide,a),a.clickHandler=e.proxy(a.clickHandler,a),a.selectHandler=e.proxy(a.selectHandler,a),a.setPosition=e.proxy(a.setPosition,a),a.swipeHandler=e.proxy(a.swipeHandler,a),a.dragHandler=e.proxy(a.dragHandler,a),a.keyHandler=e.proxy(a.keyHandler,a),a.hideUI=e.proxy(a.hideUI,a),a.showUI=e.proxy(a.showUI,a),a.preventDefault=e.proxy(a.preventDefault,a),a.instanceUid=t++,a.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,a.registerBreakpoints(),a.init(!0)}}()).prototype.activateADA=function(){this.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})},t.prototype.addSlide=t.prototype.slickAdd=function(t,i,o){var n=this;if("boolean"==typeof i)o=i,i=null;else if(i<0||i>=n.slideCount)return!1;n.unload(),"number"==typeof i?0===i&&0===n.$slides.length?e(t).appendTo(n.$slideTrack):o?e(t).insertBefore(n.$slides.eq(i)):e(t).insertAfter(n.$slides.eq(i)):!0===o?e(t).prependTo(n.$slideTrack):e(t).appendTo(n.$slideTrack),n.$slides=n.$slideTrack.children(this.options.slide),n.$slideTrack.children(this.options.slide).detach(),n.$slideTrack.append(n.$slides),n.$slides.each(function(t,i){e(i).attr("data-slick-index",t)}),n.$slidesCache=n.$slides,n.reinit()},t.prototype.animateHeight=function(){var e=this;if(1===e.options.slidesToShow&&!0===e.options.adaptiveHeight&&!1===e.options.vertical){var t=e.$slides.eq(e.currentSlide).outerHeight(!0);if(e.$list.animate({height:t},e.options.speed),!0===e.options.arrows){var i=e.$slides.eq(e.currentSlide),o=i.is(".has_caption")?t-i.find(".gallery_image_caption").outerHeight(!0):t;e.$prevArrow.animate({height:o},{duration:e.options.speed}).css("overflow","visible"),e.$nextArrow.animate({height:o},{duration:e.options.speed}).css("overflow","visible")}}},t.prototype.animateSlide=function(t,i){var o={},n=this;n.animateHeight(),!0===n.options.rtl&&!1===n.options.vertical&&(t=-t),!1===n.transformsEnabled?!1===n.options.vertical?n.$slideTrack.animate({left:t},n.options.speed,n.options.easing,i):n.$slideTrack.animate({top:t},n.options.speed,n.options.easing,i):!1===n.cssTransitions?(!0===n.options.rtl&&(n.currentLeft=-n.currentLeft),e({animStart:n.currentLeft}).animate({animStart:t},{duration:n.options.speed,easing:n.options.easing,step:function(e){e=Math.ceil(e),!1===n.options.vertical?(o[n.animType]="translate("+e+"px, 0px)",n.$slideTrack.css(o)):(o[n.animType]="translate(0px,"+e+"px)",n.$slideTrack.css(o))},complete:function(){i&&i.call()}})):(n.applyTransition(),t=Math.ceil(t),!1===n.options.vertical?o[n.animType]="translate3d("+t+"px, 0px, 0px)":o[n.animType]="translate3d(0px,"+t+"px, 0px)",n.$slideTrack.css(o),i&&setTimeout(function(){n.disableTransition(),i.call()},n.options.speed))},t.prototype.getNavTarget=function(){var t=this.options.asNavFor;return t&&null!==t&&(t=e(t).not(this.$slider)),t},t.prototype.asNavFor=function(t){var i=this.getNavTarget();null!==i&&"object"==typeof i&&i.each(function(){var i=e(this).slick("getSlick");i.unslicked||i.slideHandler(t,!0)})},t.prototype.applyTransition=function(e){var t=this,i={};!1===t.options.fade?i[t.transitionType]=t.transformType+" "+t.options.speed+"ms "+t.options.cssEase:i[t.transitionType]="opacity "+t.options.speed+"ms "+t.options.cssEase,!1===t.options.fade?t.$slideTrack.css(i):t.$slides.eq(e).css(i)},t.prototype.autoPlay=function(){var e=this;e.autoPlayClear(),e.slideCount>e.options.slidesToShow&&(e.autoPlayTimer=setInterval(e.autoPlayIterator,e.options.autoplaySpeed))},t.prototype.autoPlayClear=function(){this.autoPlayTimer&&clearInterval(this.autoPlayTimer)},t.prototype.autoPlayIterator=function(){var e=this,t=e.currentSlide+e.options.slidesToScroll;e.paused||e.interrupted||e.focussed||(!1===e.options.infinite&&(1===e.direction&&e.currentSlide+1===e.slideCount-1?e.direction=0:0===e.direction&&(t=e.currentSlide-e.options.slidesToScroll,e.currentSlide-1==0&&(e.direction=1))),e.slideHandler(t))},t.prototype.buildArrows=function(){var t=this;!0===t.options.arrows&&(t.$prevArrow=e(t.options.prevArrow).addClass("slick-arrow"),t.$nextArrow=e(t.options.nextArrow).addClass("slick-arrow"),t.slideCount>t.options.slidesToShow?(t.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),t.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.prependTo(t.options.appendArrows),t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.appendTo(t.options.appendArrows),!0!==t.options.infinite&&t.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):t.$prevArrow.add(t.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},t.prototype.buildDots=function(){var t,i,o=this;if(!0===o.options.dots&&o.slideCount>o.options.slidesToShow){for(o.$slider.addClass("slick-dotted"),i=e("<ul />").addClass(o.options.dotsClass),t=0;t<=o.getDotCount();t+=1)i.append(e("<li />").append(o.options.customPaging.call(this,o,t)));o.$dots=i.appendTo(o.options.appendDots),o.$dots.find("li").first().addClass("slick-active").attr("aria-hidden","false")}},t.prototype.buildOut=function(){var t=this;t.$slides=t.$slider.children(t.options.slide+":not(.slick-cloned)").addClass("slick-slide"),t.slideCount=t.$slides.length,t.$slides.each(function(t,i){e(i).attr("data-slick-index",t).data("originalStyling",e(i).attr("style")||"")}),t.$slider.addClass("slick-slider"),t.$slideTrack=0===t.slideCount?e('<div class="slick-track"/>').appendTo(t.$slider):t.$slides.wrapAll('<div class="slick-track"/>').parent(),t.$list=t.$slideTrack.wrap('<div aria-live="polite" class="slick-list"/>').parent(),t.$slideTrack.css("opacity",0),!0!==t.options.centerMode&&!0!==t.options.swipeToSlide||(t.options.slidesToScroll=1),e("img[data-lazy]",t.$slider).not("[src]").addClass("slick-loading"),t.setupInfinite(),t.buildArrows(),t.buildDots(),t.updateDots(),t.setSlideClasses("number"==typeof t.currentSlide?t.currentSlide:0),!0===t.options.draggable&&t.$list.addClass("draggable")},t.prototype.buildRows=function(){var e,t,i,o,n,a,r,s=this;if(o=document.createDocumentFragment(),a=s.$slider.children(),s.options.rows>1){for(r=s.options.slidesPerRow*s.options.rows,n=Math.ceil(a.length/r),e=0;e<n;e++){var l=document.createElement("div");for(t=0;t<s.options.rows;t++){var d=document.createElement("div");for(i=0;i<s.options.slidesPerRow;i++){var c=e*r+(t*s.options.slidesPerRow+i);a.get(c)&&d.appendChild(a.get(c))}l.appendChild(d)}o.appendChild(l)}s.$slider.empty().append(o),s.$slider.children().children().children().css({width:100/s.options.slidesPerRow+"%",display:"inline-block"})}},t.prototype.checkResponsive=function(t,i){var o,n,a,r=this,s=!1,l=r.$slider.width(),d=window.innerWidth||e(window).width();if("window"===r.respondTo?a=d:"slider"===r.respondTo?a=l:"min"===r.respondTo&&(a=Math.min(d,l)),r.options.responsive&&r.options.responsive.length&&null!==r.options.responsive){for(o in n=null,r.breakpoints)r.breakpoints.hasOwnProperty(o)&&(!1===r.originalSettings.mobileFirst?a<r.breakpoints[o]&&(n=r.breakpoints[o]):a>r.breakpoints[o]&&(n=r.breakpoints[o]));null!==n?null!==r.activeBreakpoint?(n!==r.activeBreakpoint||i)&&(r.activeBreakpoint=n,"unslick"===r.breakpointSettings[n]?r.unslick(n):(r.options=e.extend({},r.originalSettings,r.breakpointSettings[n]),!0===t&&(r.currentSlide=r.options.initialSlide),r.refresh(t)),s=n):(r.activeBreakpoint=n,"unslick"===r.breakpointSettings[n]?r.unslick(n):(r.options=e.extend({},r.originalSettings,r.breakpointSettings[n]),!0===t&&(r.currentSlide=r.options.initialSlide),r.refresh(t)),s=n):null!==r.activeBreakpoint&&(r.activeBreakpoint=null,r.options=r.originalSettings,!0===t&&(r.currentSlide=r.options.initialSlide),r.refresh(t),s=n),t||!1===s||r.$slider.trigger("breakpoint",[r,s])}},t.prototype.changeSlide=function(t,i){var o,n,a,r=this,s=e(t.currentTarget);switch(s.is("a")&&t.preventDefault(),s.is("li")||(s=s.closest("li")),a=r.slideCount%r.options.slidesToScroll!=0,o=a?0:(r.slideCount-r.currentSlide)%r.options.slidesToScroll,t.data.message){case"previous":n=0===o?r.options.slidesToScroll:r.options.slidesToShow-o,r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide-n,!1,i);break;case"next":n=0===o?r.options.slidesToScroll:o,r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide+n,!1,i);break;case"index":var l=0===t.data.index?0:t.data.index||s.index()*r.options.slidesToScroll;r.slideHandler(r.checkNavigable(l),!1,i),s.children().trigger("focus");break;default:return}},t.prototype.checkNavigable=function(e){var t,i;if(t=this.getNavigableIndexes(),i=0,e>t[t.length-1])e=t[t.length-1];else for(var o in t){if(e<t[o]){e=i;break}i=t[o]}return e},t.prototype.cleanUpEvents=function(){var t=this;t.options.dots&&null!==t.$dots&&e("li",t.$dots).off("click.slick",t.changeSlide).off("mouseenter.slick",e.proxy(t.interrupt,t,!0)).off("mouseleave.slick",e.proxy(t.interrupt,t,!1)),t.$slider.off("focus.slick blur.slick"),!0===t.options.arrows&&t.slideCount>t.options.slidesToShow&&(t.$prevArrow&&t.$prevArrow.off("click.slick",t.changeSlide),t.$nextArrow&&t.$nextArrow.off("click.slick",t.changeSlide)),t.$slider.off("touchstart.slick mousedown.slick",t.swipeHandler),t.$slider.off("touchmove.slick mousemove.slick",t.swipeHandler),t.$slider.off("touchend.slick mouseup.slick",t.swipeHandler),t.$slider.off("touchcancel.slick mouseleave.slick",t.swipeHandler),t.$list.off("click.slick",t.clickHandler),e(document).off(t.visibilityChange,t.visibility),t.cleanUpSlideEvents(),!0===t.options.accessibility&&t.$list.off("keydown.slick",t.keyHandler),!0===t.options.focusOnSelect&&e(t.$slideTrack).children().off("click.slick",t.selectHandler),e(window).off("orientationchange.slick.slick-"+t.instanceUid,t.orientationChange),e(window).off("resize.slick.slick-"+t.instanceUid,t.resize),e("[draggable!=true]",t.$slideTrack).off("dragstart",t.preventDefault),e(window).off("load.slick.slick-"+t.instanceUid,t.setPosition),e(document).off("ready.slick.slick-"+t.instanceUid,t.setPosition),Cargo.Event.off("slideshow-lazyload",t.lazyLoad),Cargo.Event.off("slideshow-lazyload",t.progressiveLazyLoad)},t.prototype.cleanUpSlideEvents=function(){var t=this;t.$list.off("mouseenter.slick",e.proxy(t.interrupt,t,!0)),t.$list.off("mouseleave.slick",e.proxy(t.interrupt,t,!1))},t.prototype.cleanUpRows=function(){var e,t=this;t.options.rows>1&&((e=t.$slides.children().children()).removeAttr("style"),t.$slider.empty().append(e))},t.prototype.clickHandler=function(e){!1===this.shouldClick&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())},t.prototype.destroy=function(t){var i=this;i.autoPlayClear(),i.touchObject={},i.cleanUpEvents(),e(".slick-cloned",i.$slider).detach(),i.$dots&&i.$dots.remove(),i.$prevArrow&&i.$prevArrow.length&&(i.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),i.htmlExpr.test(i.options.prevArrow)&&i.$prevArrow.remove()),i.$nextArrow&&i.$nextArrow.length&&(i.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),i.htmlExpr.test(i.options.nextArrow)&&i.$nextArrow.remove()),i.$slides&&(i.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){e(this).attr("style",e(this).data("originalStyling"))}),i.$slideTrack.children(this.options.slide).detach(),i.$slideTrack.detach(),i.$list.detach(),i.$slider.append(i.$slides)),i.cleanUpRows(),i.$slider.removeClass("slick-slider"),i.$slider.removeClass("slick-initialized"),i.$slider.removeClass("slick-dotted"),i.unslicked=!0,t||i.$slider.trigger("destroy",[i])},t.prototype.disableTransition=function(e){var t=this,i={};i[t.transitionType]="",!1===t.options.fade?t.$slideTrack.css(i):t.$slides.eq(e).css(i)},t.prototype.fadeSlide=function(e,t){var i=this;!1===i.cssTransitions?(i.$slides.eq(e).css({zIndex:i.options.zIndex}),i.$slides.eq(e).animate({opacity:1},i.options.speed,i.options.easing,t)):(i.applyTransition(e),i.$slides.eq(e).css({opacity:1,zIndex:i.options.zIndex}),t&&setTimeout(function(){i.disableTransition(e),t.call()},i.options.speed))},t.prototype.fadeSlideOut=function(e){var t=this;!1===t.cssTransitions?t.$slides.eq(e).animate({opacity:0,zIndex:t.options.zIndex-2},t.options.speed,t.options.easing):(t.applyTransition(e),t.$slides.eq(e).css({opacity:0,zIndex:t.options.zIndex-2}))},t.prototype.filterSlides=t.prototype.slickFilter=function(e){var t=this;null!==e&&(t.$slidesCache=t.$slides,t.unload(),t.$slideTrack.children(this.options.slide).detach(),t.$slidesCache.filter(e).appendTo(t.$slideTrack),t.reinit())},t.prototype.focusHandler=function(){var t=this;t.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*:not(.slick-arrow)",function(i){i.stopImmediatePropagation();var o=e(this);setTimeout(function(){t.options.pauseOnFocus&&(t.focussed=o.is(":focus"),t.autoPlay())},0)})},t.prototype.getCurrent=t.prototype.slickCurrentSlide=function(){return this.currentSlide},t.prototype.getDotCount=function(){var e=this,t=0,i=0,o=0;if(!0===e.options.infinite)for(;t<e.slideCount;)++o,t=i+e.options.slidesToScroll,i+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;else if(!0===e.options.centerMode)o=e.slideCount;else if(e.options.asNavFor)for(;t<e.slideCount;)++o,t=i+e.options.slidesToScroll,i+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;else o=1+Math.ceil((e.slideCount-e.options.slidesToShow)/e.options.slidesToScroll);return o-1},t.prototype.getLeft=function(e){var t,i,o,n=this,a=0;return n.slideOffset=0,i=n.$slides.first().outerHeight(!0),!0===n.options.infinite?(n.slideCount>n.options.slidesToShow&&(n.slideOffset=n.slideWidth*n.options.slidesToShow*-1,a=i*n.options.slidesToShow*-1),n.slideCount%n.options.slidesToScroll!=0&&e+n.options.slidesToScroll>n.slideCount&&n.slideCount>n.options.slidesToShow&&(e>n.slideCount?(n.slideOffset=(n.options.slidesToShow-(e-n.slideCount))*n.slideWidth*-1,a=(n.options.slidesToShow-(e-n.slideCount))*i*-1):(n.slideOffset=n.slideCount%n.options.slidesToScroll*n.slideWidth*-1,a=n.slideCount%n.options.slidesToScroll*i*-1))):e+n.options.slidesToShow>n.slideCount&&(n.slideOffset=(e+n.options.slidesToShow-n.slideCount)*n.slideWidth,a=(e+n.options.slidesToShow-n.slideCount)*i),n.slideCount<=n.options.slidesToShow&&(n.slideOffset=0,a=0),!0===n.options.centerMode&&!0===n.options.infinite?n.slideOffset+=n.slideWidth*Math.floor(n.options.slidesToShow/2)-n.slideWidth:!0===n.options.centerMode&&(n.slideOffset=0,n.slideOffset+=n.slideWidth*Math.floor(n.options.slidesToShow/2)),t=!1===n.options.vertical?e*n.slideWidth*-1+n.slideOffset:e*i*-1+a,!0===n.options.variableWidth&&(o=n.slideCount<=n.options.slidesToShow||!1===n.options.infinite?n.$slideTrack.children(".slick-slide").eq(e):n.$slideTrack.children(".slick-slide").eq(e+n.options.slidesToShow),t=!0===n.options.rtl?o[0]?-1*(n.$slideTrack.width()-o[0].offsetLeft-o.width()):0:o[0]?-1*o[0].offsetLeft:0,!0===n.options.centerMode&&(o=n.slideCount<=n.options.slidesToShow||!1===n.options.infinite?n.$slideTrack.children(".slick-slide").eq(e):n.$slideTrack.children(".slick-slide").eq(e+n.options.slidesToShow+1),t=!0===n.options.rtl?o[0]?-1*(n.$slideTrack.width()-o[0].offsetLeft-o.width()):0:o[0]?-1*o[0].offsetLeft:0,t+=(n.$list.width()-o.outerWidth())/2)),t},t.prototype.getOption=t.prototype.slickGetOption=function(e){return this.options[e]},t.prototype.getNavigableIndexes=function(){var e,t=this,i=0,o=0,n=[];for(!1===t.options.infinite?e=t.slideCount:(i=-1*t.options.slidesToScroll,o=-1*t.options.slidesToScroll,e=2*t.slideCount);i<e;)n.push(i),i=o+t.options.slidesToScroll,o+=t.options.slidesToScroll<=t.options.slidesToShow?t.options.slidesToScroll:t.options.slidesToShow;return n},t.prototype.getSlick=function(){return this},t.prototype.getSlideCount=function(){var t,i,o=this;return i=!0===o.options.centerMode?o.slideWidth*Math.floor(o.options.slidesToShow/2):0,!0===o.options.swipeToSlide?(o.$slideTrack.find(".slick-slide").each(function(n,a){if(a.offsetLeft-i+e(a).outerWidth()/2>-1*o.swipeLeft)return t=a,!1}),Math.abs(e(t).attr("data-slick-index")-o.currentSlide)||1):o.options.slidesToScroll},t.prototype.goTo=t.prototype.slickGoTo=function(e,t){this.changeSlide({data:{message:"index",index:parseInt(e)}},t)},t.prototype.init=function(t){var i=this;e(i.$slider).hasClass("slick-initialized")||(e(i.$slider).addClass("slick-initialized"),i.buildRows(),i.buildOut(),i.setProps(),i.startLoad(),i.loadSlider(),i.initializeEvents(),i.updateArrows(),i.updateDots(),i.checkResponsive(!0),i.focusHandler()),t&&i.$slider.trigger("init",[i]),!0===i.options.accessibility&&i.initADA(),i.options.autoplay&&(i.paused=!1,i.autoPlay()),i.showUI(),this.hideUITimer=setTimeout(this.hideUI,1500)},t.prototype.initADA=function(){var t=this;t.$slides.add(t.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),t.$slideTrack.attr("role","listbox"),t.$slides.not(t.$slideTrack.find(".slick-cloned")).each(function(i){e(this).attr({role:"option","aria-describedby":"slick-slide"+t.instanceUid+i})}),null!==t.$dots&&t.$dots.attr("role","tablist").find("li").each(function(i){e(this).attr({role:"presentation","aria-selected":"false","aria-controls":"navigation"+t.instanceUid+i,id:"slick-slide"+t.instanceUid+i})}).first().attr("aria-selected","true").end().find("button").attr("role","button").end().closest("div").attr("role","toolbar"),t.activateADA()},t.prototype.initArrowEvents=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},e.changeSlide),e.$nextArrow.off("click.slick").on("click.slick",{message:"next"},e.changeSlide))},t.prototype.initDotEvents=function(){var t=this;!0===t.options.dots&&t.slideCount>t.options.slidesToShow&&e("li",t.$dots).on("click.slick",{message:"index"},t.changeSlide),!0===t.options.dots&&!0===t.options.pauseOnDotsHover&&e("li",t.$dots).on("mouseenter.slick",e.proxy(t.interrupt,t,!0)).on("mouseleave.slick",e.proxy(t.interrupt,t,!1))},t.prototype.initSlideEvents=function(){var t=this;t.options.pauseOnHover&&(t.$prevArrow&&(t.$prevArrow.on("mouseenter.slick",e.proxy(t.interrupt,t,!0)),t.$prevArrow.on("mouseleave.slick",e.proxy(t.interrupt,t,!1))),t.$nextArrow&&(t.$nextArrow.on("mouseenter.slick",e.proxy(t.interrupt,t,!0)),t.$nextArrow.on("mouseleave.slick",e.proxy(t.interrupt,t,!1))),t.$list.on("mouseenter.slick",e.proxy(t.interrupt,t,!0)),t.$list.on("mouseleave.slick",e.proxy(t.interrupt,t,!1)))},t.prototype.initializeEvents=function(){var t=this;t.initArrowEvents(),t.initDotEvents(),t.initSlideEvents(),t.$slider.on("touchstart.slick mousedown.slick",{action:"start"},t.swipeHandler),t.$slider.on("touchmove.slick mousemove.slick",{action:"move"},t.swipeHandler),t.$slider.on("touchend.slick mouseup.slick",{action:"end"},t.swipeHandler),t.$slider.on("touchcancel.slick mouseleave.slick",{action:"end"},t.swipeHandler),t.$list.on("click.slick",t.clickHandler),e(document).on(t.visibilityChange,e.proxy(t.visibility,t)),!0===t.options.accessibility&&t.$list.on("keydown.slick",t.keyHandler),!0===t.options.focusOnSelect&&e(t.$slideTrack).children().on("click.slick",t.selectHandler),e(window).on("orientationchange.slick.slick-"+t.instanceUid,e.proxy(t.orientationChange,t)),e(window).on("resize.slick.slick-"+t.instanceUid,e.proxy(t.resize,t)),e("[draggable!=true]",t.$slideTrack).on("dragstart",t.preventDefault),e(window).on("load.slick.slick-"+t.instanceUid,t.setPosition),e(document).on("ready.slick.slick-"+t.instanceUid,t.setPosition)},t.prototype.initUI=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.show(),e.$nextArrow.show()),!0===e.options.dots&&e.slideCount>e.options.slidesToShow&&e.$dots.show()},t.prototype.keyHandler=function(e){var t=this;e.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===e.keyCode&&!0===t.options.accessibility?t.changeSlide({data:{message:!0===t.options.rtl?"next":"previous"}}):39===e.keyCode&&!0===t.options.accessibility&&t.changeSlide({data:{message:!0===t.options.rtl?"previous":"next"}}))},t.prototype.lazyLoad=function(){var t,i,o=this;function n(t){e("img[data-lazy], img[data-lazy-src]",t).each(function(){var t=e(this),i=t.attr("data-lazy")||t.attr("data-lazy-src"),n=document.createElement("img");t.removeAttr("data-lazy"),t.removeAttr("data-lazy-src"),n.onload=function(){t.attr("src",i).removeClass("slick-loading"),o.$slider.trigger("lazyLoaded",[o,t,i])},n.onerror=function(){t.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),o.$slider.trigger("lazyLoadError",[o,t,i])},n.src=i})}!0===o.options.centerMode?!0===o.options.infinite?(t=o.currentSlide+(o.options.slidesToShow/2+1),i=t+o.options.slidesToShow+2):(t=Math.max(0,o.currentSlide-(o.options.slidesToShow/2+1)),i=o.options.slidesToShow/2+1+2+o.currentSlide):(t=o.options.infinite?o.options.slidesToShow+o.currentSlide:o.currentSlide,i=Math.ceil(t+o.options.slidesToShow),!0===o.options.fade&&(t>0&&t--,i<=o.slideCount&&i++)),i+=3,(t-=1)<0&&(t=0),n(o.$slider.find(".slick-slide").slice(t,i)),o.slideCount<=o.options.slidesToShow?n(o.$slider.find(".slick-slide")):o.currentSlide>=o.slideCount-o.options.slidesToShow?n(o.$slider.find(".slick-cloned").slice(0,o.options.slidesToShow)):0===o.currentSlide&&n(o.$slider.find(".slick-cloned").slice(-1*o.options.slidesToShow))},t.prototype.loadSlider=function(){var e=this;e.setPosition(),e.$slideTrack.css({opacity:1}),e.$slider.removeClass("slick-loading"),e.initUI(),"progressive"===e.options.lazyLoad&&e.progressiveLazyLoad()},t.prototype.next=t.prototype.slickNext=function(e){this.changeSlide({data:{message:"next"}},e)},t.prototype.orientationChange=function(){this.checkResponsive(),this.setPosition()},t.prototype.pause=t.prototype.slickPause=function(){this.autoPlayClear(),this.paused=!0},t.prototype.play=t.prototype.slickPlay=function(){var e=this;e.autoPlay(),e.options.autoplay=!0,e.paused=!1,e.focussed=!1,e.interrupted=!1},t.prototype.postSlide=function(e){var t=this;t.unslicked||(t.$slider.trigger("afterChange",[t,e]),t.animating=!1,t.setPosition(),t.swipeLeft=null,t.options.autoplay&&t.autoPlay(),!0===t.options.accessibility&&t.initADA())},t.prototype.prev=t.prototype.slickPrev=function(e){this.changeSlide({data:{message:"previous"}},e)},t.prototype.preventDefault=function(e){this.options.preventDefaults&&e.preventDefault()},t.prototype.progressiveLazyLoad=function(t){t=t||1;var i,o,n,a=this,r=e("img[data-lazy]",a.$slider);r.length?(i=r.first(),o=i.attr("data-lazy"),(n=document.createElement("img")).onload=function(){i.attr("src",o).removeAttr("data-lazy").removeClass("slick-loading"),!0===a.options.adaptiveHeight&&a.setPosition(),a.$slider.trigger("lazyLoaded",[a,i,o]),a.progressiveLazyLoad()},n.onerror=function(){t<3?setTimeout(function(){a.progressiveLazyLoad(t+1)},500):(i.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),a.$slider.trigger("lazyLoadError",[a,i,o]),a.progressiveLazyLoad())},n.src=o):a.$slider.trigger("allImagesLoaded",[a])},t.prototype.refresh=function(t){var i,o,n=this;o=n.slideCount-n.options.slidesToShow,!n.options.infinite&&n.currentSlide>o&&(n.currentSlide=o),n.slideCount<=n.options.slidesToShow&&(n.currentSlide=0),i=n.currentSlide,n.destroy(!0),e.extend(n,n.initials,{currentSlide:i}),n.init(),t||n.changeSlide({data:{message:"index",index:i}},!1)},t.prototype.registerBreakpoints=function(){var t,i,o,n=this,a=n.options.responsive||null;if("array"===e.type(a)&&a.length){for(t in n.respondTo=n.options.respondTo||"window",a)if(o=n.breakpoints.length-1,i=a[t].breakpoint,a.hasOwnProperty(t)){for(;o>=0;)n.breakpoints[o]&&n.breakpoints[o]===i&&n.breakpoints.splice(o,1),o--;n.breakpoints.push(i),n.breakpointSettings[i]=a[t].settings}n.breakpoints.sort(function(e,t){return n.options.mobileFirst?e-t:t-e})}},t.prototype.reinit=function(){var t=this;t.$slides=t.$slideTrack.children(t.options.slide).addClass("slick-slide"),t.slideCount=t.$slides.length,t.currentSlide>=t.slideCount&&0!==t.currentSlide&&(t.currentSlide=t.currentSlide-t.options.slidesToScroll),t.slideCount<=t.options.slidesToShow&&(t.currentSlide=0),t.registerBreakpoints(),t.setProps(),t.setupInfinite(),t.buildArrows(),t.updateArrows(),t.initArrowEvents(),t.buildDots(),t.updateDots(),t.initDotEvents(),t.cleanUpSlideEvents(),t.initSlideEvents(),t.checkResponsive(!1,!0),!0===t.options.focusOnSelect&&e(t.$slideTrack).children().on("click.slick",t.selectHandler),t.setSlideClasses("number"==typeof t.currentSlide?t.currentSlide:0),t.setPosition(),t.focusHandler(),t.paused=!t.options.autoplay,t.autoPlay(),t.options.arrows&&(t.showUI(),t.hideUITimer=setTimeout(t.hideUI,1500)),t.$slider.trigger("reInit",[t])},t.prototype.resize=function(){var t=this;e(window).width()!==t.windowWidth&&(clearTimeout(t.windowDelay),t.windowDelay=window.setTimeout(function(){t.windowWidth=e(window).width(),t.checkResponsive(),t.unslicked||t.setPosition()},50))},t.prototype.removeSlide=t.prototype.slickRemove=function(e,t,i){var o=this;if(e="boolean"==typeof e?!0===(t=e)?0:o.slideCount-1:!0===t?--e:e,o.slideCount<1||e<0||e>o.slideCount-1)return!1;o.unload(),!0===i?o.$slideTrack.children().remove():o.$slideTrack.children(this.options.slide).eq(e).remove(),o.$slides=o.$slideTrack.children(this.options.slide),o.$slideTrack.children(this.options.slide).detach(),o.$slideTrack.append(o.$slides),o.$slidesCache=o.$slides,o.reinit()},t.prototype.setCSS=function(e){var t,i,o=this,n={};!0===o.options.rtl&&(e=-e),t="left"==o.positionProp?Math.ceil(e)+"px":"0px",i="top"==o.positionProp?Math.ceil(e)+"px":"0px",n[o.positionProp]=e,!1===o.transformsEnabled?o.$slideTrack.css(n):(n={},!1===o.cssTransitions?(n[o.animType]="translate("+t+", "+i+")",o.$slideTrack.css(n)):(n[o.animType]="translate3d("+t+", "+i+", 0px)",o.$slideTrack.css(n)))},t.prototype.setDimensions=function(){var e=this;!1===e.options.vertical?!0===e.options.centerMode&&e.$list.css({padding:"0px "+e.options.centerPadding}):(e.$list.height(e.$slides.first().outerHeight(!0)*e.options.slidesToShow),!0===e.options.centerMode&&e.$list.css({padding:e.options.centerPadding+" 0px"}));var t=e.$list.get(0).getBoundingClientRect();e.listWidth=t.width,e.listHeight=t.height,!1===e.options.vertical&&!1===e.options.variableWidth?(e.slideWidth=Math.ceil(e.listWidth/e.options.slidesToShow),e.$slideTrack.width(Math.ceil(e.slideWidth*e.$slideTrack.children(".slick-slide").length))):!0===e.options.variableWidth?e.$slideTrack.width(5e3*e.slideCount):(e.slideWidth=Math.ceil(e.listWidth),e.$slideTrack.height(Math.ceil(e.$slides.first().outerHeight(!0)*e.$slideTrack.children(".slick-slide").length)));var i=e.$slides.first().outerWidth(!0)-e.$slides.first().width();!1===e.options.variableWidth&&e.$slideTrack.children(".slick-slide").width(e.slideWidth-i)},t.prototype.setFade=function(){var t,i=this;i.$slides.each(function(o,n){t=i.slideWidth*o*-1,!0===i.options.rtl?e(n).css({position:"relative",right:t,top:0,zIndex:i.options.zIndex-2,opacity:0}):e(n).css({position:"relative",left:t,top:0,zIndex:i.options.zIndex-2,opacity:0})}),i.$slides.eq(i.currentSlide).css({zIndex:i.options.zIndex-1,opacity:1})},t.prototype.setHeight=function(){var e=this;if(1===e.options.slidesToShow&&!0===e.options.adaptiveHeight&&!1===e.options.vertical){var t=e.$slides.eq(e.currentSlide).outerHeight(!0);if(e.$list.css("height",t),!0===e.options.arrows){var i=e.$slides.eq(e.currentSlide),o=i.is(".has_caption")?t-i.find(".gallery_image_caption").outerHeight(!0):t;e.$prevArrow.css("height",o),e.$nextArrow.css("height",o)}}},t.prototype.setOption=t.prototype.slickSetOption=function(){var t,i,o,n,a,r=this,s=!1;if("object"===e.type(arguments[0])?(o=arguments[0],s=arguments[1],a="multiple"):"string"===e.type(arguments[0])&&(o=arguments[0],n=arguments[1],s=arguments[2],"responsive"===arguments[0]&&"array"===e.type(arguments[1])?a="responsive":void 0!==arguments[1]&&(a="single")),"single"===a)r.options[o]=n;else if("multiple"===a)e.each(o,function(e,t){r.options[e]=t});else if("responsive"===a)for(i in n)if("array"!==e.type(r.options.responsive))r.options.responsive=[n[i]];else{for(t=r.options.responsive.length-1;t>=0;)r.options.responsive[t].breakpoint===n[i].breakpoint&&r.options.responsive.splice(t,1),t--;r.options.responsive.push(n[i])}s&&(r.unload(),r.reinit())},t.prototype.setPosition=function(){var e=this;e.setDimensions(),e.setHeight(),!1===e.options.fade?e.setCSS(e.getLeft(e.currentSlide)):e.setFade(),e.$slider.trigger("setPosition",[e])},t.prototype.setProps=function(){var e=this,t=document.body.style;e.positionProp=!0===e.options.vertical?"top":"left","top"===e.positionProp?e.$slider.addClass("slick-vertical"):e.$slider.removeClass("slick-vertical"),void 0===t.WebkitTransition&&void 0===t.MozTransition&&void 0===t.msTransition||!0===e.options.useCSS&&(e.cssTransitions=!0),e.options.fade&&("number"==typeof e.options.zIndex?e.options.zIndex<3&&(e.options.zIndex=3):e.options.zIndex=e.defaults.zIndex),void 0!==t.OTransform&&(e.animType="OTransform",e.transformType="-o-transform",e.transitionType="OTransition",void 0===t.perspectiveProperty&&void 0===t.webkitPerspective&&(e.animType=!1)),void 0!==t.MozTransform&&(e.animType="MozTransform",e.transformType="-moz-transform",e.transitionType="MozTransition",void 0===t.perspectiveProperty&&void 0===t.MozPerspective&&(e.animType=!1)),void 0!==t.webkitTransform&&(e.animType="webkitTransform",e.transformType="-webkit-transform",e.transitionType="webkitTransition",void 0===t.perspectiveProperty&&void 0===t.webkitPerspective&&(e.animType=!1)),void 0!==t.msTransform&&(e.animType="msTransform",e.transformType="-ms-transform",e.transitionType="msTransition",void 0===t.msTransform&&(e.animType=!1)),void 0!==t.transform&&!1!==e.animType&&(e.animType="transform",e.transformType="transform",e.transitionType="transition"),e.transformsEnabled=e.options.useTransform&&null!==e.animType&&!1!==e.animType},t.prototype.setSlideClasses=function(e){var t,i,o,n,a=this;i=a.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),a.$slides.eq(e).addClass("slick-current"),!0===a.options.centerMode?(t=Math.floor(a.options.slidesToShow/2),!0===a.options.infinite&&(e>=t&&e<=a.slideCount-1-t?a.$slides.slice(e-t,e+t+1).addClass("slick-active").attr("aria-hidden","false"):(o=a.options.slidesToShow+e,i.slice(o-t+1,o+t+2).addClass("slick-active").attr("aria-hidden","false")),0===e?i.eq(i.length-1-a.options.slidesToShow).addClass("slick-center"):e===a.slideCount-1&&i.eq(a.options.slidesToShow).addClass("slick-center")),a.$slides.eq(e).addClass("slick-center")):e>=0&&e<=a.slideCount-a.options.slidesToShow?a.$slides.slice(e,e+a.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):i.length<=a.options.slidesToShow?i.addClass("slick-active").attr("aria-hidden","false"):(n=a.slideCount%a.options.slidesToShow,o=!0===a.options.infinite?a.options.slidesToShow+e:e,a.options.slidesToShow==a.options.slidesToScroll&&a.slideCount-e<a.options.slidesToShow?i.slice(o-(a.options.slidesToShow-n),o+n).addClass("slick-active").attr("aria-hidden","false"):i.slice(o,o+a.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false")),"ondemand"===a.options.lazyLoad?(Cargo.Event.on("slideshow-lazyload",a.lazyLoad,this),a.lazyLoad()):"progressive"===a.options.lazyLoad&&Cargo.Event.on("slideshow-lazyload",a.progressiveLazyLoad,this)},t.prototype.setupInfinite=function(){var t,i,o,n=this;if(!0===n.options.fade&&(n.options.centerMode=!1),!0===n.options.infinite&&!1===n.options.fade&&(i=null,n.slideCount>n.options.slidesToShow)){for(o=!0===n.options.centerMode?n.options.slidesToShow+1:n.options.slidesToShow,t=n.slideCount;t>n.slideCount-o;t-=1){i=t-1;var a=e(n.$slides[i]).clone(!0).attr({id:"","data-exclude-item":""});a.find("[data-gallery-item], [data-gallery-item] *").attr("data-exclude-item",""),a.attr("data-slick-index",i-n.slideCount).prependTo(n.$slideTrack).addClass("slick-cloned")}for(t=0;t<o;t+=1){i=t;var a=e(n.$slides[i]).clone(!0).attr({id:"","data-exclude-item":""});a.find("[data-gallery-item], [data-gallery-item] *").attr("data-exclude-item",""),a.attr("data-slick-index",i+n.slideCount).appendTo(n.$slideTrack).addClass("slick-cloned")}n.$slideTrack.find(".slick-cloned").find("[id]").each(function(){e(this).attr("id","")})}},t.prototype.interrupt=function(e){e||this.autoPlay(),this.interrupted=e},t.prototype.selectHandler=function(t){var i=this,o=e(t.target).is(".slick-slide")?e(t.target):e(t.target).parents(".slick-slide"),n=parseInt(o.attr("data-slick-index"));if(n||(n=0),i.slideCount<=i.options.slidesToShow)return i.setSlideClasses(n),void i.asNavFor(n);i.slideHandler(n)},t.prototype.slideHandler=function(e,t,i){var o,n,a,r,s,l=null,d=this;if(t=t||!1,(!0!==d.animating||!0!==d.options.waitForAnimate)&&!(!0===d.options.fade&&d.currentSlide===e||d.slideCount<=d.options.slidesToShow))if(!1===t&&d.asNavFor(e),o=e,l=d.getLeft(o),r=d.getLeft(d.currentSlide),d.currentLeft=null===d.swipeLeft?r:d.swipeLeft,!1===d.options.infinite&&!1===d.options.centerMode&&(e<0||e>d.getDotCount()*d.options.slidesToScroll))!1===d.options.fade&&(o=d.currentSlide,!0!==i?d.animateSlide(r,function(){d.postSlide(o)}):d.postSlide(o));else if(!1===d.options.infinite&&!0===d.options.centerMode&&(e<0||e>d.slideCount-d.options.slidesToScroll))!1===d.options.fade&&(o=d.currentSlide,!0!==i?d.animateSlide(r,function(){d.postSlide(o)}):d.postSlide(o));else{if(d.options.autoplay&&clearInterval(d.autoPlayTimer),n=o<0?d.slideCount%d.options.slidesToScroll!=0?d.slideCount-d.slideCount%d.options.slidesToScroll:d.slideCount+o:o>=d.slideCount?d.slideCount%d.options.slidesToScroll!=0?0:o-d.slideCount:o,d.animating=!0,d.$slider.trigger("beforeChange",[d,d.currentSlide,n]),a=d.currentSlide,d.currentSlide=n,d.setSlideClasses(d.currentSlide),d.options.asNavFor&&(s=(s=d.getNavTarget()).slick("getSlick")).slideCount<=s.options.slidesToShow&&s.setSlideClasses(d.currentSlide),d.updateDots(),d.updateArrows(),!0===d.options.fade)return!0!==i?(d.fadeSlideOut(a),d.fadeSlide(n,function(){d.postSlide(n)})):d.postSlide(n),void d.animateHeight();!0!==i?d.animateSlide(l,function(){d.postSlide(n)}):d.postSlide(n)}},t.prototype.startLoad=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.hide(),e.$nextArrow.hide()),!0===e.options.dots&&e.slideCount>e.options.slidesToShow&&e.$dots.hide(),e.$slider.addClass("slick-loading")},t.prototype.swipeDirection=function(){var e,t,i,o,n=this;return e=n.touchObject.startX-n.touchObject.curX,t=n.touchObject.startY-n.touchObject.curY,i=Math.atan2(t,e),(o=Math.round(180*i/Math.PI))<0&&(o=360-Math.abs(o)),o<=45&&o>=0?!1===n.options.rtl?"left":"right":o<=360&&o>=315?!1===n.options.rtl?"left":"right":o>=135&&o<=225?!1===n.options.rtl?"right":"left":!0===n.options.verticalSwiping?o>=35&&o<=135?"down":"up":"vertical"},t.prototype.swipeEnd=function(e){var t,i,o=this;if(o.dragging=!1,o.interrupted=!1,o.shouldClick=!(o.touchObject.swipeLength>10),o.$slider.removeAttr("data-in-transition"),void 0===o.touchObject.curX)return!1;if(!0===o.touchObject.edgeHit&&o.$slider.trigger("edge",[o,o.swipeDirection()]),o.touchObject.swipeLength>=o.touchObject.minSwipe){switch(i=o.swipeDirection()){case"left":case"down":t=o.options.swipeToSlide?o.checkNavigable(o.currentSlide+o.getSlideCount()):o.currentSlide+o.getSlideCount(),o.currentDirection=0;break;case"right":case"up":t=o.options.swipeToSlide?o.checkNavigable(o.currentSlide-o.getSlideCount()):o.currentSlide-o.getSlideCount(),o.currentDirection=1}"vertical"!=i&&(o.slideHandler(t),o.touchObject={},o.$slider.trigger("swipe",[o,i]))}else o.touchObject.startX!==o.touchObject.curX&&(o.slideHandler(o.currentSlide),o.touchObject={})},t.prototype.swipeHandler=function(t){var i=this;if("move"===t.data.action&&i.showUI(),e(t.target).closest(".slick-arrow").length?clearTimeout(this.hideUITimer):"mouseleave"==t.type?this.hideUITimer=setTimeout(this.hideUI,250):this.hideUITimer=setTimeout(this.hideUI,1500),!(!1===i.options.swipe||"ontouchend"in document&&!1===i.options.swipe||!1===i.options.draggable&&-1!==t.type.indexOf("mouse")))switch(i.touchObject.fingerCount=t.originalEvent&&void 0!==t.originalEvent.touches?t.originalEvent.touches.length:1,i.touchObject.minSwipe=i.listWidth/i.options.touchThreshold,!0===i.options.verticalSwiping&&(i.touchObject.minSwipe=i.listHeight/i.options.touchThreshold),t.data.action){case"start":i.swipeStart(t);break;case"move":i.swipeMove(t);break;case"end":i.swipeEnd(t)}},t.prototype.showUI=function(){this.$slider.find(".slick-arrow").removeClass("hidden"),clearTimeout(this.hideUITimer)},t.prototype.hideUI=function(){this.hideUITimer=null,this.$slider.find(".slick-arrow").addClass("hidden")},t.prototype.swipeMove=function(e){var t,i,o,n,a,r=this;return a=void 0!==e.originalEvent?e.originalEvent.touches:null,!(!r.dragging||a&&1!==a.length)&&(t=r.getLeft(r.currentSlide),r.touchObject.curX=void 0!==a?a[0].pageX:e.clientX,r.touchObject.curY=void 0!==a?a[0].pageY:e.clientY,r.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(r.touchObject.curX-r.touchObject.startX,2))),!0===r.options.verticalSwiping&&(r.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(r.touchObject.curY-r.touchObject.startY,2)))),"vertical"!==(i=r.swipeDirection())?(void 0!==e.originalEvent&&r.touchObject.swipeLength>4&&e.preventDefault(),n=(!1===r.options.rtl?1:-1)*(r.touchObject.curX>r.touchObject.startX?1:-1),!0===r.options.verticalSwiping&&(n=r.touchObject.curY>r.touchObject.startY?1:-1),o=r.touchObject.swipeLength,r.touchObject.edgeHit=!1,!1===r.options.infinite&&(0===r.currentSlide&&"right"===i||r.currentSlide>=r.getDotCount()&&"left"===i)&&(o=r.touchObject.swipeLength*r.options.edgeFriction,r.touchObject.edgeHit=!0),!1===r.options.vertical?r.swipeLeft=t+o*n:r.swipeLeft=t+o*(r.$list.height()/r.listWidth)*n,!0===r.options.verticalSwiping&&(r.swipeLeft=t+o*n),!0!==r.options.fade&&!1!==r.options.touchMove&&(!0===r.animating?(r.swipeLeft=null,!1):void r.setCSS(r.swipeLeft))):void 0)},t.prototype.swipeStart=function(e){var t,i=this;if(i.interrupted=!0,1!==i.touchObject.fingerCount||i.slideCount<=i.options.slidesToShow)return i.touchObject={},!1;void 0!==e.originalEvent&&void 0!==e.originalEvent.touches&&(t=e.originalEvent.touches[0]),i.touchObject.startX=i.touchObject.curX=void 0!==t?t.pageX:e.clientX,i.touchObject.startY=i.touchObject.curY=void 0!==t?t.pageY:e.clientY,setTimeout(function(){i.interrupted&&i.$slider.attr("data-in-transition","")},10),i.dragging=!0},t.prototype.unfilterSlides=t.prototype.slickUnfilter=function(){var e=this;null!==e.$slidesCache&&(e.unload(),e.$slideTrack.children(this.options.slide).detach(),e.$slidesCache.appendTo(e.$slideTrack),e.reinit())},t.prototype.unload=function(){var t=this;e(".slick-cloned",t.$slider).remove(),t.$dots&&t.$dots.remove(),t.$prevArrow&&t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.remove(),t.$nextArrow&&t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.remove(),t.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},t.prototype.unslick=function(e){var t=this;t.$slider.trigger("unslick",[t,e]),t.destroy()},t.prototype.updateArrows=function(){var e=this;Math.floor(e.options.slidesToShow/2),!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&!e.options.infinite&&(e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),e.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===e.currentSlide?(e.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):e.currentSlide>=e.slideCount-e.options.slidesToShow&&!1===e.options.centerMode?(e.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):e.currentSlide>=e.slideCount-1&&!0===e.options.centerMode&&(e.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},t.prototype.updateDots=function(){var e=this;null!==e.$dots&&(e.$dots.find("li").removeClass("slick-active").attr("aria-hidden","true"),e.$dots.find("li").eq(Math.floor(e.currentSlide/e.options.slidesToScroll)).addClass("slick-active").attr("aria-hidden","false"))},t.prototype.visibility=function(){var e=this;e.options.autoplay&&(document[e.hidden]?e.interrupted=!0:e.interrupted=!1)},e.fn.slick=function(){var e,i,o=this,n=arguments[0],a=Array.prototype.slice.call(arguments,1),r=o.length;for(e=0;e<r;e++)if("object"==typeof n||void 0===n?o[e].slick=new t(o[e],n):i=o[e].slick[n].apply(o[e].slick,a),void 0!==i)return i;return o}}(jQuery)}(),function(e,t){var i=function(e,t,i){if(!1!==e.prototype.hasOwnProperty(name))return!1;e.prototype[t]=i};i(Node,"saveable",!1),i(Node,"setSaveable",function(e){return this.saveable=e,this}),i(Node,"isSaveable",function(){return this.saveable}),Node.prototype.persistCloneNode=function(){var e=function(t,i,o){for(var n=0;n<t.childNodes.length;n++)o(t.childNodes[n],i.childNodes[n]),0<t.childNodes[n].childNodes.length&&e(t.childNodes[n],i.childNodes[n],o)},t=Node.prototype.cloneNode.apply(this,arguments);return!0===this.isSaveable()&&t.setSaveable(!0),0<this.childNodes.length&&e(this,t,function(e,t){!0===e.isSaveable()&&t.setSaveable(!0)}),t},this.core={markAsEditable:function(e){}}}(window.CargoEditor=window.CargoEditor||{}),function(){"use strict";function e(){return this.data={main_margin:0,mobile_formatting:!1,mobile_padding:0,mobile_zoom:20},this.cache={chrome:0,offset:0,size:0,window:{h:0,w:0}},_.extend(this,Backbone.Events),this.listenTo(Cargo.Event,"design:ready",this.initialize),$(_.bind(this.onDocumentReady,this)),this}e.prototype.addEventListeners=function(){this.listenTo(Cargo.Event,"content_load_complete",this.refresh),this.listenTo(Cargo.Event,"editor-image-added handleAdminUIChange",this.onEditorChange),this.listenTo(Cargo.Event,"handleAdminUIChange",this.handleAdminUIChange);var e=Cargo.Helper.isMobile(),t=(e?"orientationchange":"resize")+".BaseUnit",i=e&&!Cargo.Helper.isIOS()?_.debounce(_.bind(this.onWindowResize,this),150):e&&Cargo.Helper.isIOS()?_.debounce(_.bind(this.onWindowResize,this),150):_.bind(this.onWindowResize,this);return $(window).on(t,i),$(window).on("load.BaseUnit",_.bind(this.onWindowLoad,this)),this},e.prototype.removeEventListeners=function(){return this.stopListening(),$(document).off(".BaseUnit"),$(window).off(".BaseUnit"),this},e.prototype.handleAdminUIChange=function(e,t){switch(e){case"mobile_formatting":case"mobile_pages_full_width":this.data[e]=t;break;case"main_margin":case"mobile_padding":case"mobile_zoom":this.data[e]=parseFloat(t)}return this.setBaseUnit(),this.triggerEvent("refresh"),this},e.prototype.onDocumentReady=function(e){this.$html=$(document.documentElement),this.addEventListeners(),Cargo.Event.trigger("design:ready")},e.prototype.onWindowLoad=function(e){CargoEditor&&CargoEditor.events&&this.listenTo(CargoEditor.events,"editor-summary-created",this.onEditorChange),this.cacheWindowSize(),this.refresh()},e.prototype.isIphoneX=function(){var e=window.devicePixelRatio||1,t=window.screen.width*e,i=window.screen.height*e;return!(!/iPad|iPhone|iPod/.test(navigator.userAgent)||window.MSStream||1125!=t||2436!==i)},e.prototype.onWindowResize=function(e){this.cacheWindowSize(),this.setBaseUnit(),this.triggerEvent("refresh")},e.prototype.onEditorChange=_.debounce(function(){this.refresh(),Cargo.Plugins.elementResizer.refresh()},0),e.prototype.initialize=function(){var e=Cargo.Model.DisplayOptions.get("layout_options");return this.data=_.extend(this.data,e),this.data.mobile_zoom=parseFloat(this.data.mobile_zoom),this.data.mobile_padding=parseFloat(this.data.mobile_padding),this.data.main_margin=parseFloat(this.data.main_margin),this.cacheWindowSize(),this.refresh(),Cargo.Plugins.elementResizer.refresh(),this},e.prototype.refresh=function(){return this.setBaseUnit(),this.triggerEvent("refresh"),this},e.prototype.cacheWindowSize=function(){if(!Cargo.Helper.isMobile()){for(var e=0;window.matchMedia.call(window,"(min-height:"+(e+=1)+"px)").matches;);return this.cache.window.h=e-1,this.cache.window.w=document.documentElement.clientWidth,this}return document.documentElement.clientWidth>window.innerHeight?(this.cache.window.h=screen.width||window.innerHeight,this.cache.window.w=screen.height||document.documentElement.clientWidth,this.isIphoneX()&&(this.cache.window.w=document.documentElement.clientWidth)):(this.cache.window.h=screen.height||window.innerHeight,this.cache.window.w=screen.width||document.documentElement.clientWidth),this.cache.chrome=this.cache.window.h-window.innerHeight,this},e.prototype.setBaseUnit=function(){var e,t=0,i=this.data.mobile_padding,o=this.data.mobile_zoom-15;return this.cache.window.h>this.cache.window.w&&(t=this.cache.window.h/this.cache.window.w-1),(t/=.777777778)>1&&(t=1),i=Math.abs(i)/10,i=this.data.main_margin*i*t*-1,e=this.getBaseUnit({weight:9+o*t,min:20}),this.triggerEvent("set",{diff:t,offset:i,size:e}),this.cache.size===e?this:(document.documentElement.style.fontSize=e+"%",this.cache.size=e,this)},e.prototype.getBaseUnit=function(e){e=e||{};var t=0;return t=(e=$.extend(!0,{height:this.cache.window.h,width:this.cache.window.w,min:11,max:!1,weight:5,round:!1,offset:1},e)).width<e.height?e.width:e.height,t*=e.offset,t/=100/e.weight,e.min&&t<e.min&&(t=e.min),e.max&&t>e.max&&(t=e.max),e.round&&(t=Math.floor(t)),t},e.prototype.triggerEvent=function(e,t){return e="BaseUnit:"+e,t=t||{},Cargo.Event.trigger(e,_.extend(t,{cache:this.cache,data:this.data})),this},window.BaseUnit=e}(),function(){"use strict";function e(){return this.cache={},this.data={},_.extend(this,Backbone.Events),$(_.bind(this.setup,this)),this.listenTo(Cargo.Event,"BaseUnit:refresh BaseUnit:set",this.cacheChanges),this.listenTo(Cargo.Event,"slideshow_update BaseUnit:refresh",this.stretchShortMobileContent),this.listenTo(Cargo.Event,"mobile_size",this.setMobileClass),this}e.prototype.setup=function(){this.$body=$(document.body),this.$main=$("main"),this.$containerPadding=$("[data-container-padding]"),this.$contentPadded=$(".l-content-padding"),this.$contentRuler=$("[data-content-ruler]"),this.listenTo(Cargo.Event,"BaseUnit:set content_load_complete set_render_complete thumbnails_render_complete inspector_style_changed",this.onOtherEvent)},e.prototype.stretchShortMobileContent=function(){if(!_.isEmpty(this.cache)&&void 0!==this.$contentPadded){var e=this.cache.window.h-this.cache.chrome>=this.$contentPadded.outerHeight();return this.data.mobile_formatting||!e?(this.$main.css({position:"",top:"",bottom:"",minHeight:""}),this):(this.$main.css({position:"fixed",top:0,bottom:0,minHeight:0}),this)}},e.prototype.forceMobileSizing=function(){return this.$contentRuler.width()/this.data.window.w*100>85},e.prototype.setMobileClass=function(e){this.$body||(this.$body=$(document.body));var t=e?"addClass":"removeClass";this.is_mobile_size=e,Cargo.Event.trigger("body_mobile_class_added",e),this.$body[t]("mobile"),this.setPagesToFullWidth()},e.prototype.setMobilePaddingOffset=function(e){var t=this,i=this.$body.find(".content_padding");this.mobile_padding=parseFloat(e.mobile_padding),i.each(function(){if(t.is_mobile_size){var e,i,o=parseInt($(this).closest("[data-id]").attr("data-id")),n=Cargo.Collection.Scaffolding.getModel({id:o});if(Cargo.Helper.IsAdminEdit()&&void 0!==parent.Cargo&&void 0!==parent.Cargo.Editor&&void 0!==parent.Cargo.Editor.View&&void 0!==parent.Cargo.Editor.View.ContentView&&parent.Cargo.Editor.View.ContentView.$el.is("#editproject")&&parent.Cargo.Editor.View.ContentView.pid==o){if(e=!0,void 0===parent.Cargo.Editor.View.ContentView.layoutOptions)return;i=parent.Cargo.Editor.View.ContentView.layoutOptions.getCurrentValues()}else e=!1,i=void 0!==n?n.getPageOption("local_layout_options"):Cargo.Model.DisplayOptions.get("layout_options");var a,r,s=Cargo.Model.DisplayOptions.get("layout_options");_.each(["top","right","bottom","left"],function(o){if(a="main_margin_"+o,r=NaN,i&&void 0!==i[a]?r=e?parseFloat(i[a].value):parseFloat(i[a]):s&&void 0!==s[a]&&(r=parseFloat(s[a])),isNaN(r))this.style.removeProperty("padding-"+o);else{var n=t.calculateMobilePaddingOffset(r);this.style.setProperty("padding-"+o,n+"rem")}},this)}else this.removeAttribute("style")});var o,n=document.getElementById("site_menu_button"),a=document.getElementById("shop_button"),r=[];n&&r.push(n),a&&r.push(a),_.each(document.styleSheets,function(e){e&&e.ownerNode&&"member_stylesheet"==e.ownerNode.id&&(o=e),e&&e.publicData&&"member_stylesheet"==e.publicData.id&&(o=e)}),o&&void 0!==r[0]&&_.each(r,function(e,i){var n;try{n=o.cssRules}catch(e){console.warn(e)}if(n){var a={top:"",right:"",bottom:"",left:""};_.each(n,function(t){(function(e,t){var i=Element.prototype,o=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector||function(e){return-1!==[].indexOf.call(document.querySelectorAll(e),this)};try{return o.call(e,t)}catch(e){console.warn(e)}return!1})(e,t.selectorText)&&_.each(t.style,function(e){a.hasOwnProperty(e)&&(a[e]=t.style[e])})}),_.each(a,function(i,o){if(t.is_mobile_size){if(""!==i){var n=parseFloat(i),a=t.calculateMobilePaddingOffset(n);e.style[o]=a+"rem"}}else e.style[o]=""})}}),Cargo.Event.trigger("mobile_padding_set")},e.prototype.calculateMobilePaddingOffset=function(e){var t=e-Math.abs(this.mobile_padding)/10*e;return Number(t.toFixed(1))},e.prototype.setPagesToFullWidth=function(e){this.mobile_pages_full_width=void 0!==e?e.mobile_pages_full_width:this.data.mobile_pages_full_width;var t=this.mobile_pages_full_width&&this.is_mobile_size?"addClass":"removeClass";this.$body[t]("full_width")},e.prototype.onOtherEvent=function(){this.setMobilePaddingOffset(this.data),this.setPagesToFullWidth(this.data)},e.prototype.cacheChanges=function(e){this.cache=e.cache,this.data=e.data},e.prototype.eventPreventDefault=function(e){e.preventDefault()},window.MobileAdjustments=e}(),Cargo=window.Cargo||{},Cargo.Modal;var modal=Backbone.View.extend({id:"confirm_modal",defaults:{message:"Save changes?",modal_type:"save",selector:"body",textarea_value:""},template:null,existingLinkElement:void 0,events:{"click .modal-overlay":"ModalClose","click [data-confirm]":"ModalConfirm","click [data-deny]":"ModalDeny"},is_active:!1,blocked:!1,initialize:function(e){if(null==this.template){var t=this;$.get("/_jsapps/modal/modal.html",function(e){t.template=_.template(e)})}},render:function(){var e=this.template({modal:this.model.toJSON()});return this.$el.html(e),void 0!==Cargo.View&&void 0!==Cargo.View.Following&&!Cargo.View.Following.enabled&&null==Cargo.Homepage&&Cargo.Helper.IsAdminEdit()&&setTimeout(function(){$(this.el).attr("tabindex","-1"),$(this.el).focus(),$("#editor_masterview").length>0&&$("#editor_masterview").is(".translate")&&parseInt($("#panel_content").css("top"))>0&&$("#master_wrapper").scrollTop(parseInt($("#panel_content").css("top"))),setTimeout(function(){$(this.el).focus()}.bind(this),100)}.bind(this),100),Cargo.Event.once("enter_keycode_triggered",this.ModalConfirm,this),Cargo.Event.once("esc_keycode_triggered",this.ModalClose,this),"save"==this.model.get("modal_type")&&Cargo.Event.once("save_shortcut_triggered",this.ModalConfirm,this),void 0!==Cargo.View&&void 0!==Cargo.View.Following&&Cargo.View.Following.enabled&&Cargo.View.Following.scrollOffset&&(this.$el.find(".modal-overlay").css("top",Cargo.View.Following.scrollOffset.top+"px"),this.$el.find(".confirm-box").css("top","calc("+Cargo.View.Following.scrollOffset.top+"px + 40%)")),Cargo.Event.trigger("modal_render_complete"),this},Confirm:function(e){(e=e||{}).modal_type="confirm",this.show(e)},ConfirmWithProgress:function(e){(e=e||{}).modal_type="confirm_with_progress",this.show(e)},Alert:function(e){(e=e||{}).modal_type="alert",this.show(e)},Prompt:function(e){(e=e||{}).modal_type="prompt",this.show(e),$(document).on("keydown.confirm_modal",_.bind(function(e){!0===e.shiftKey&&13===e.keyCode&&(e.preventDefault(),this.ModalConfirm())},this)),setTimeout(_.bind(function(){var e=$("[data-modal-textarea]",this.el)[0];e.focus();var t=e.value;e.value="",e.value=t},this),300)},Dialog:function(e){(e=e||{}).modal_type="dialog",this.show(e),setTimeout(_.bind(function(){$("[data-modal-textarea]",this.el).select()},this),300)},Block:function(e){(e=e||{}).modal_type="block",this.blocked=!0,this.show(e)},Save:function(e){(e=e||{}).modal_type="save",this.show(e)},show:function(e){this.model=null,this.model=new Backbone.Model(this.defaults),_.extend(this.model.attributes,e),$(this.model.get("selector")).append(this.render().el),Cargo.Event.trigger("confirm_modal:open"),this.is_active=!0},isActive:function(){return this.is_active},ModalConfirm:function(){var e,t=this.model.get("modal_type");"function"==typeof this.model.get("confirm")&&("prompt"==t&&(e=$("[data-modal-textarea]",this.el).val()),this.model.get("confirm")(e)),this.model.set("modal_type",null),"confirm_with_progress"==t?this.ShowProgress():this.ModalClose(!0)},ModalDeny:function(){"function"==typeof this.model.get("deny")&&this.model.get("deny")(),this.ModalClose(!0)},ModalClose:function(e){if(!0!==this.blocked){if("alert"==this.model.get("modal_type"))return this.model.set("modal_type",null),void this.ModalConfirm();this.is_active=!1,!0!==e&&"function"==typeof this.model.get("close")&&this.model.get("close")(),Cargo.Event.off("enter_keycode_triggered",this.ModalConfirm),Cargo.Event.off("enter_keycode_triggered",this.ModalClose),Cargo.Event.off("esc_keycode_triggered",this.ModalClose),Cargo.Event.off("save_shortcut_triggered",this.ModalConfirm),Cargo.Event.trigger("confirm_modal:close"),$(document).off("keydown.confirm_modal"),this.el.remove()}},ShowProgress:function(){this.blocked=!0,$("[data-modal-message] div").html(this.model.get("progress_message")),$("[data-deny], [data-confirm]",this.el).hide(),$("[data-progress]",this.el).show(),this.UpdateProgress(0)},UpdateProgress:function(e){var t=$("[data-progress]",this.el),i=t.find(".progress-indicator"),o=t.find(".progress-percentage");0!=e||this.processing?e>10&&(i.find(".loading_animation").length>0&&(i.removeClass("waiting"),i.find(".loading_animation").remove()),i.css("width",e+"%"),o.text(e+"%")):(i.addClass("waiting").html(Cargo.Core.Handlebars.Render("{{>loading_animation}}",{})),this.processing=!0),100==e&&(this.processing=!1,this.blocked=!1)}});Cargo.Modal=new modal;var Backdrop={Data:{require_loaded:!1},o:{}};Backdrop.o.model={},Backdrop.o.collection={},Backdrop.Model={},Backdrop.Collection={},Backdrop.View={},Backdrop.o.model.Settings=Backbone.Model.extend({constructor:function(){this.defaults={page_id:void 0,backdrop_id:1,backdrop_path:"none",data:{}},Backbone.Model.prototype.constructor.apply(this,arguments)},url:function(){var e=Cargo.API.Config;return e.api_path+"/"+e.Version+"/backdrop/"+Cargo.Model.Site.get("site_url")+"/"+this.get("page_id")+"/"+this.get("backdrop_id")}}),Backdrop.o.model.Global=Backbone.Model.extend({isNew:function(){return!0},fetch:function(e){$("[data-set='GlobalSettings']").length>0?this.set($.parseJSON($("[data-set='GlobalSettings']").html()),e):Backbone.Model.prototype.fetch.apply(this,arguments)},url:function(){var e=Cargo.API.Config;return e.api_path+"/"+e.Version+"/backdrop/"+e.cargo_url}});var Cargo=Cargo||{};Cargo.Plugins=Cargo.Plugins||{},function(){function e(){}e.prototype.initializeImage=function(e){},e.prototype.setSrcAccordingToSize=function(e){if(null!=e){var t=Math.floor(Math.min(250*Math.ceil(Math.max(childObj.actualWidth,parentWidth)/250),childObj.imageModel.get("width"))),i=childObj.imageModel.getImageWithOptions({w:t});i.retina&&childObj.actualWidth/i.w>.8&&(i=childObj.imageModel.getImageWithOptions({w:t,q:94})),(i.w>childObj.lastSize||i.q>childObj.lastQ)&&childObj.element.attr("src")!==i.url&&(childObj.element.attr("src",i.url),childObj.lastSize=i.w,childObj.lastQ=i.q,childObj.element[0].__cachedLastSize=i.w,childObj.element[0].__cachedLastQ=i.q)}},Cargo.Plugins.imageSrcLoader=new e}();var Cargo=Cargo||{},requirejs,require,define;Cargo.Plugins=Cargo.Plugins||{},function(){"use strict";if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}});else{var e=window.document,t=[];o.prototype.THROTTLE_TIMEOUT=100,o.prototype.POLL_INTERVAL=null,o.prototype.USE_MUTATION_OBSERVER=!0,o.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},o.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},o.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},o.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},o.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter(function(e,t,i){if("number"!=typeof e||isNaN(e)||e<0||1<e)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==i[t-1]})},o.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map(function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},o.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(n(window,"resize",this._checkForIntersections,!0),n(e,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in window&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},o.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,a(window,"resize",this._checkForIntersections,!0),a(e,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},o.prototype._checkForIntersections=function(){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(o){var n=o.element,a=r(n),s=this._rootContainsTarget(n),l=o.entry,d=e&&s&&this._computeTargetAndRootIntersection(n,t),c=o.entry=new i({time:window.performance&&performance.now&&performance.now(),target:n,boundingClientRect:a,rootBounds:t,intersectionRect:d});l?e&&s?this._hasCrossedThreshold(l,c)&&this._queuedEntries.push(c):l&&l.isIntersecting&&this._queuedEntries.push(c):this._queuedEntries.push(c)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},o.prototype._computeTargetAndRootIntersection=function(t,i){if("none"!=window.getComputedStyle(t).display){for(var o,n,a,s,d,c,h,u,g=r(t),p=l(t),m=!1;!m;){var f=null,v=1==p.nodeType?window.getComputedStyle(p):{};if("none"==v.display)return;if(p==this.root||p==e?(m=!0,f=i):p!=e.body&&p!=e.documentElement&&"visible"!=v.overflow&&(f=r(p)),f&&(o=f,n=g,a=Math.max(o.top,n.top),s=Math.min(o.bottom,n.bottom),d=Math.max(o.left,n.left),u=s-a,!(g=0<=(h=(c=Math.min(o.right,n.right))-d)&&0<=u&&{top:a,bottom:s,left:d,right:c,width:h,height:u})))break;p=l(p)}return g}},o.prototype._getRootRect=function(){var t;if(this.root)t=r(this.root);else{var i=e.documentElement,o=e.body;t={top:0,left:0,right:i.clientWidth||o.clientWidth,width:i.clientWidth||o.clientWidth,bottom:i.clientHeight||o.clientHeight,height:i.clientHeight||o.clientHeight}}return this._expandRectByRootMargin(t)},o.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map(function(t,i){return"px"==t.unit?t.value:t.value*(i%2?e.width:e.height)/100}),i={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return i.width=i.right-i.left,i.height=i.bottom-i.top,i},o.prototype._hasCrossedThreshold=function(e,t){var i=e&&e.isIntersecting?e.intersectionRatio||0:-1,o=t.isIntersecting?t.intersectionRatio||0:-1;if(i!==o)for(var n=0;n<this.thresholds.length;n++){var a=this.thresholds[n];if(a==i||a==o||a<i!=a<o)return!0}},o.prototype._rootIsInDom=function(){return!this.root||s(e,this.root)},o.prototype._rootContainsTarget=function(t){return s(this.root||e,t)},o.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},o.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},window.IntersectionObserver=o,window.IntersectionObserverEntry=i}function i(e){this.time=e.time,this.target=e.target,this.rootBounds=e.rootBounds,this.boundingClientRect=e.boundingClientRect,this.intersectionRect=e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,i=t.width*t.height,o=this.intersectionRect,n=o.width*o.height;this.intersectionRatio=i?Number((n/i).toFixed(4)):this.isIntersecting?1:0}function o(e,t){var i,o,n,a=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(a.root&&1!=a.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(i=this._checkForIntersections.bind(this),o=this.THROTTLE_TIMEOUT,n=null,function(){n=n||setTimeout(function(){i(),n=null},o)}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(a.rootMargin),this.thresholds=this._initThresholds(a.threshold),this.root=a.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" ")}function n(e,t,i,o){"function"==typeof e.addEventListener?e.addEventListener(t,i,o||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,i)}function a(e,t,i,o){"function"==typeof e.removeEventListener?e.removeEventListener(t,i,o||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,i)}function r(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function s(e,t){for(var i=t;i;){if(i==e)return!0;i=l(i)}return!1}function l(e){var t=e.parentNode;return t&&11==t.nodeType&&t.host?t.host:t&&t.assignedSlot?t.assignedSlot.parentNode:t}}(),Cargo.Plugins.elementResizer=function(e){var t=/googlebot|bingbot|crawler|spider|robot|crawling/i.test(navigator.userAgent);function i(e,t){var o=e&&(t(e)?e:i(e.parentNode,t));return o||null}function o(e){var t=getComputedStyle(e,null);return"border-box"===t.getPropertyValue("box-sizing")?parseFloat(t.width)-((parseFloat(t.paddingLeft)||0)+(parseFloat(t.paddingRight)||0)+(parseFloat(t.borderLeftWidth)||0)+(parseFloat(t.borderRightWidth)||0)):parseFloat(t.width)}isAndroidDevice=/(android)/i.test(navigator.userAgent),uniqueId=0,childrenById={},isAndroidDevice&&console.info("Disabling scroll transitions for Android.");var n={vars:{ticking:!1,initialized:!1,isInCargoFrame:function(){var e=/\/adminedit/.test(document.location.pathname)||/\/admin/.test(document.location.pathname);try{var t=parent!=window&&"object"==typeof parent.Cargo,i=null!=Cargo.Editor;return e||t||i}catch(e){return!1}}()},options:{cargo_refreshEvents:["homepage_loaded","show_index_complete","mobile_padding_set","inspector_preview","page_collection_reset","direct_link_loaded","image_gallery_init_complete"],generic_refreshEvents:[],updateEvents:["resize","orientationchange"],selectors:["img","object","iframe","video",".elementresizer","[data-elementresizer-child]",".audio_component"],targets:{},minimumHeight:1,minimumWidth:1,adjustElementsToWindowHeight:!0,forceMobileImagesFullWidth:!1,forceMargin:!1,scrollTransition:!1,scrollTransitionThreshold:-100,forceVerticalMargin:40,forceHorizontalMargin:0,allowInit:!0},init:function(){function e(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)}if(this.isMobile=!!Cargo.Helper&&Cargo.Helper.isMobile(),this.initializeObservers(),Cargo.Event.trigger("element_resizer_init",a),!n.options.allowInit)return!1;var t,i=document.createElement("img");i.classList.add("scroll-transition-fade","below-viewport");var o=document.createElement("div");o.classList.add("page");var r=document.createElement("div");r.classList.add("content"),r.appendChild(i),o.appendChild(r),document.body.appendChild(o);var s=window.getComputedStyle(i).getPropertyValue("transform"),l=s.indexOf("matrix(")>-1,d=s.indexOf("matrix3d(")>-1,c=0,h=0;if(l){s=s.replace(")","").replace("matrix(","").split(",");for(var u=0;u<s.length;u++)s[u]=parseFloat(s[u])||0;h=s[s.length-1],c=s[s.length-2]}else if(d){s=s.replace(")","").replace("matrix3d(","").split(",");for(u=0;u<s.length;u++)s[u]=parseFloat(s[u]);h=s[s.length-3],c=s[s.length-4]}document.body.removeChild(o),this.imageTransforms={x:c,y:h},_.each(n.options.updateEvents,function(i){e(window,i,function(){n.requestTick(),"orientationchange"===i&&(clearTimeout(t),t=setTimeout(function(){n.requestTick()},160))})}),_.each(n.options.generic_refreshEvents,function(t){e(window,t,function(){n.refresh()})}),Cargo.Event.on("pagination_complete",function(){n.matchImagesWithImageModels(),n.refresh(!0)}),_.each(n.options.cargo_refreshEvents,function(e){Cargo.hasOwnProperty("Event")&&Cargo.Event.on(e,function(){n.requestRefreshTick()})}),Cargo.hasOwnProperty("Event")&&Cargo.Event.on("inspector_open",function(){CargoInspector.eventManager.subscribe("style_changed",function(e){n.requestTick()})});try{var g=window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5)");"function"==typeof g.addListener&&g.addListener(function(){n.setResponsiveImageSrcs()})}catch(e){}Cargo.Event.on("content_load_complete",function(){n.matchImagesWithImageModels(),n.requestTick()}),Cargo.Event.on("thumbnails_hide",function(){_.defer(function(){n.update()})}),void 0!==Cargo.Collection&&void 0!==Cargo.Collection.Scaffolding&&Cargo.Collection.Scaffolding.on("add",_.debounce(function(){n.matchImagesWithImageModels(),n.update()},1)),Cargo.Event.on("pin_load_complete",function(){n.requestRefreshTick()}),Cargo.Event.on("pin_format_complete",function(){n.requestTick()}),n.vars.initialized=!0,n.refresh()},refresh:function(e){if(!0!==e&&(e=!1),!n.vars.initialized)return!1;e||(_.each(childrenById,function(e){_.each(e.observedNodes,function(e){n.lazyLoadObserver.unobserve(e),n.scrollTransitionObserver.unobserve(e),delete e._elementResizerId,delete e._inViewport,delete e._hasLazyLoadObserver}),e.observedNodes=[]}),childrenById={},n.options.targets={}),_.each(document.querySelectorAll("[data-elementresizer]"),function(t){if(e&&_.find(n.options.targets,function(e){return e.container===t}))return;var a=i(t,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.hasAttribute("data-resize-parent")})||document.body,r=[];_.each(t.querySelectorAll(n.options.selectors.join(",")),function(e){var t,a=i(e,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("image-gallery")});if((!a||a.classList.contains("initialized"))&&(null===i(e,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.hasAttribute("data-no-elementresizer")})&&!e.hasAttribute("data-no-elementresizer"))){for(var s,l,d,c,h,u,g,p=e;p;)p.nodeType===Node.ELEMENT_NODE&&(p.hasAttribute("grid-col")?s=p:p.classList.contains("slick-slider")?l=p:p.classList.contains("marquee")?g=p:p.hasAttribute("thumbnails")?d=p:"wallpaper"==p.getAttribute("data-backdrop")?c=p:p.classList.contains("page_container")&&p.classList.contains("overlay")&&p.classList.contains("accommodate")?h=p:(p.classList.contains("page_container")&&p.classList.contains("fixed")||"site_menu_panel_container"==p.id)&&(u=p)),p=p.parentNode;var m=o(e),f="border-box"===(t=getComputedStyle(e,null)).getPropertyValue("box-sizing")?parseFloat(t.height)-((parseFloat(t.paddingTop)||0)+(parseFloat(t.paddingBottom)||0)+(parseFloat(t.borderTopWidth)||0)+(parseFloat(t.borderBottomWidth)||0)):parseFloat(t.height),v=parseInt(e.getAttribute("data-rotation"))||0,b=parseInt(e.getAttribute("width")),_=parseInt(e.getAttribute("height")),y="string"==typeof e.getAttribute("height")&&-1!==e.getAttribute("height").indexOf("%"),w="string"==typeof e.getAttribute("width")&&-1!==e.getAttribute("width").indexOf("%"),C=isNaN(b)?m:b,S=isNaN(_)?f:_,x=n.constrain(n.options.minimumHeight,0,S),E=n.constrain(n.options.minimumWidth,0,C),k={id:uniqueId++,observedNodes:[],element:e,hasBeenHandled:!1,originalWidth:C,originalHeight:S,widthIsPercentage:w,heightIsPercentage:y,actualWidth:b,actualHeight:_,actualRotation:v,minimumHeight:x>S?S:x,minimumWidth:E>C?C:E,ratio:S/C,isDraggable:e.hasAttribute("data-draggable"),isInGallery:null!==a,isInWallpaper:void 0!==c,isInSlideshow:void 0!==l,isInMarquee:void 0!==g,isInColumns:void 0!==s,isInThumbnails:void 0!==d,isinFixedPinnedPage:void 0!==u,isInAdjustingPinnedPage:void 0!==h,nodeName:e.nodeName.toLowerCase(),isAudioPlayer:e.classList.contains("audio_component"),noResize:e.parentNode&&e.parentNode.hasAttribute("data-elementresizer-no-resize")||e.hasAttribute("data-elementresizer-no-resize"),noVerticalResize:e.parentNode&&e.parentNode.hasAttribute("data-elementresizer-no-vertical-resize")||e.hasAttribute("data-elementresizer-no-vertical-resize"),prevLeftMargin:0,lastSize:e._cachedLastSize?e._cachedLastSize:0,lastQ:e._cachedLastQ?e._cachedLastQ:0,isSoundCloudFrame:-1!==(e.getAttribute("src")+"").indexOf("soundcloud")&&"IFRAME"===e.nodeName,useRemSizing:e.hasAttribute("data-icon-mode")};childrenById[k.id]=k,r.push(k)}}),n.options.targets[_.uniqueId()]={container:t,resize_parent:a,children:r}}),n.matchImagesWithImageModels(),n.update(),Cargo.Event.trigger("elementresizer_refresh_complete",a)},matchImagesWithImageModels:function(){_.each(n.options.targets,function(e){if(Cargo.View.ImagesView)_.each(e.children,function(e){if(e.element.nodeType===Node.ELEMENT_NODE&&"IMG"===e.element.nodeName){var t=parseInt(e.element.getAttribute("data-mid"));isNaN(t)||(e.imageModel=Cargo.View.ImagesView.collection.findWhere({id:t}))}});else if(e.container.hasAttribute("thumbnails"))_.each(e.children,function(e){if(!e.imageModel){var t=i(e.element,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("thumbnail")});if(t){var o=parseInt(t.getAttribute("data-id")),n=Cargo.View.Thumbnail.collection.get(o);if(n&&n.get("thumb_meta")&&n.get("thumb_meta").thumbnail_crop&&n.get("thumb_meta").thumbnail_crop.imageModel)e.imageModel=new Cargo.o.model.image(n.get("thumb_meta").thumbnail_crop.imageModel);else{var a=Cargo.Collection.Scaffolding.getModel({id:o});if(void 0!==a&&void 0!==a.get("images")){var r=parseInt(e.element.getAttribute("data-mid"));isNaN(r)||(e.imageModel=_.where(a.get("images"),{id:r})[0])}}}}});else{var t,o=i(e.container,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.hasAttribute("data-id")});if(o&&(t=parseInt(o.getAttribute("data-id"))),!isNaN(t)){var n=Cargo.Collection.Scaffolding.getModel({id:parseInt(t)})||Cargo.Collection.Scaffolding.fetchPageModelCache[parseInt(t)];void 0!==n&&void 0!==n.get("images")&&_.each(e.children,function(e){var t=parseInt(e.element.getAttribute("data-mid"));isNaN(t)||(e.imageModel=_.where(n.get("images"),{id:t})[0])})}}})},requestRefreshTick:function(){n.vars.refresh_ticking||(requestAnimationFrame(function(){n.refresh()}),n.vars.refresh_ticking=!0)},requestTick:function(){n.vars.ticking||(requestAnimationFrame(function(){n.vars.refresh_ticking||n.update()}),n.vars.ticking=!0)},constrain:function(e,t,i){return e>i?i:e<t?t:e},update:function(){var e,t,r;for(e in n.options.targets){var s=o((r=n.options.targets[e]).container),l=o(r.resize_parent)-n.options.forceHorizontalMargin,d=n.options.adjustElementsToWindowHeight?document.documentElement.clientHeight-n.options.forceVerticalMargin:9e9,c=n.options.forceMobileImagesFullWidth&&Cargo.Helper.IsMobileWindowSize(document.documentElement.clientWidth),h=1;n.options.adjustElementsToWindowHeight&&void 0!==window.orientation&&0!=window.orientation&&(v=document.documentElement.clientWidth-(!1===n.options.forceMargin?40:n.options.forceMargin));var u=!!n.vars.isInCargoFrame&&null!==i(r.container,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("page_content")});for(t in r.children){var g,p=l,m=(g=r.children[t]).minimumHeight,f=g.minimumWidth,v=d,b=parseInt(g.element.getAttribute("data-scale"))/100||1,y=c&&!g.isInMarquee?1:b;if(rotation=parseInt(g.element.getAttribute("data-rotation")),g.isInEditor=u,transformX=g.isDraggable?g.element.getAttribute("data-transform-x"):0,transformY=g.isDraggable?g.element.getAttribute("data-transform-y"):0,!g.noResize){if(g.isInColumns){var w=i(g.element,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.hasAttribute("grid-col")});w&&(s=p=o(w),p-=n.options.forceHorizontalMargin)}if(g.noVerticalResize)v=9e9;else{var C=i(r.container,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("content_padding")}),S=0;C&&(S+=Math.ceil(parseFloat(window.getComputedStyle(C).paddingTop,10))),!g.isInAdjustingPinnedPage&&Cargo.View.PinnedTop.pinCollection.findWhere({content_accommodate_page:!0})&&(S+=Cargo.View.PinnedTop.pinCollection.findWhere({content_accommodate_page:!0}).get("page_height")),v=d+-2*(S=Math.min(S,.25*d))}var x=g.actualWidth,E=g.actualHeight;g.useRemSizing?p=Math.min(p,b*baseUnit.cache.size*16*(g.originalWidth/g.originalHeight)):p*=y;n.constrain(p-x,1,9e9),n.constrain(v-E,1,9e9),h=[p/g.actualWidth,v/g.actualHeight];if(h=Math.min(h[0],h[1]),E=n.constrain(E*h,-9e9,g.originalHeight),x=n.constrain(x*h,-9e9,g.originalWidth),g.widthIsPercentage?(x=s/100*g.originalWidth,E=g.heightIsPercentage?g.originalHeight/100*x:g.originalHeight):g.heightIsPercentage&&(E=x/100*g.originalHeight),(E<=m||x<=f)&&(h=[f/x,m/E],E*=h=Math.max(h[0],h[1]),x*=h),(!1===g.hasBeenHandled||Math.abs(g.actualWidth-x)>.5||Math.abs(g.actualHeight-E)>.5||g.actualRotation!==rotation)&&!isNaN(x)&&!isNaN(E)){g.actualWidth=x,g.actualHeight=E,g.actualRotation=rotation;var k=g.isInGallery||isNaN(rotation)?"":"rotate("+rotation+"deg)";(transformX||transformY)&&(k="translate("+transformX+"%, "+transformY+"%) "+k),_.each([g.element].concat("object"===g.nodeName?g.element.querySelectorAll("embed"):[]),function(e){e.style.width=g.actualWidth+"px",e.style.height=g.actualHeight+"px",e.style.transform=k}),g.hasBeenHandled=!0}}!function(e){var t=e.isInGallery||e.isInThumbnails?e.element.parentNode:e.element;if(e.isInSlideshow&&e.isInGallery&&(t=i(e.element,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("image-gallery")})),e.isInMarquee&&(t=i(e.element,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("marquee")})),!u&&!e.isinFixedPinnedPage&&(n.lazyLoadObserver.observe(e.element),e.element._hasLazyLoadObserver=!0,-1===e.observedNodes.indexOf(e.element)&&e.observedNodes.push(e.element),e.element._elementResizerId=e.id,n.options.scrollTransition&&!0!==isAndroidDevice)){n.scrollTransitionObserver.observe(t),-1===e.observedNodes.indexOf(t)&&e.observedNodes.push(t),t._elementResizerId=e.id,u||t.classList.add("scroll-transition-fade");var o=t;o.style.transitionDuration="initial",n.isMobile||Cargo.Router.executed_first_route||o.classList.remove("below-viewport");var a=0,r=0,s=0;e.isDraggable&&(a=e.element.getAttribute("data-transform-x")||0,r=e.element.getAttribute("data-transform-y")||0,s=e.element.getAttribute("data-transform-z")||0),e.isInMarquee?o.style.transform="":e.isInGallery&&e.actualRotation?o.style.transform="rotate("+-e.actualRotation+"deg) translate("+a+"%, "+r+"%) rotate("+e.actualRotation+"deg) translateZ("+s+"px)":e.actualRotation||e.isDraggable?o.style.transform="translate("+a+"%, "+r+"%) rotate("+e.actualRotation+"deg) translateZ("+s+"px)":o.style.transform=""}}(g)}}n.setResponsiveImageSrcs(),n.vars.ticking=!1,n.vars.refresh_ticking=!1,Cargo.Event.trigger("elementresizer_update_complete",a)},initializeObservers:function(){this.lazyLoadObserver=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting?(e.target._inViewport=!0,e.target.hasAttribute("data-lazy-src")&&(e.target.setAttribute("src",e.target.getAttribute("data-lazy-src")),e.target.removeAttribute("data-lazy-src"))):e.target._inViewport=!1})},{root:null,rootMargin:(this.isMobile?screen.height/4:screen.height)+"px",threshold:0}),this.scrollTransitionObserver=new IntersectionObserver(function(e){var t,i,o=document.scrollingElement.scrollHeight,a=document.scrollingElement.scrollTop;e.forEach(function(e){if(e.boundingClientRect.top+a+this.imageTransforms.y+(this.isMobile?100:0)>o)return e.target.classList.remove("below-viewport"),void this.scrollTransitionObserver.unobserve(e.target);if(null!==e.rootBounds&&(i=childrenById[e.target._elementResizerId]))if(t=e.boundingClientRect.y<e.rootBounds.y,e.isIntersecting)if(t)e.target.style.transitionDuration="initial",e.target.classList.remove("below-viewport");else{var r=0,s=0,l=0;i.isDraggable&&(r=i.element.getAttribute("data-transform-x")||0,s=i.element.getAttribute("data-transform-y")||0,l=i.element.getAttribute("data-transform-z")||0),e.target.style.transitionDuration="",i.isInMarquee?e.target.style.transform="":i.isInGallery&&i.actualRotation?e.target.style.transform="rotate("+-i.actualRotation+"deg) translate("+r+"%, "+s+"%) rotate("+i.actualRotation+"deg) translateZ("+l+"px)":i.actualRotation||i.isDraggable?e.target.style.transform="translate("+r+"%, "+s+"%) rotate("+i.actualRotation+"deg) translateZ("+l+"px)":e.target.style.transform="",e.target.classList.remove("below-viewport")}else if(t||i.isInEditor){if(t){e.target.classList.remove("below-viewport");r=0,s=0,l=0;i.isDraggable&&(r=i.element.getAttribute("data-transform-x")||0,s=i.element.getAttribute("data-transform-y")||0,l=i.element.getAttribute("data-transform-z")||0),i.isInMarquee?e.target.style.transform="":i.isInGallery&&i.actualRotation?e.target.style.transform="rotate("+-i.actualRotation+"deg) translate("+r+"%, "+s+"%) rotate("+i.actualRotation+"deg) translateZ("+l+"px)":i.actualRotation||i.isDraggable?e.target.style.transform="translate("+r+"%, "+s+"%) rotate("+i.actualRotation+"deg) translateZ("+l+"px)":e.target.style.transform="",e.target.style.willChange=""}}else e.target.style.transitionDuration="initial",e.target._startScrollWatchLeave=requestAnimationFrame(_.bind(function(t){e.target.classList.add("below-viewport");var i=0,o=0,a=0;t.isDraggable&&(i=t.element.getAttribute("data-transform-x")||0,o=t.element.getAttribute("data-transform-y")||0,a=t.element.getAttribute("data-transform-z")||0),t.isInMarquee?e.target.style.transform="":t.actualRotation&&t.isInGallery?e.target.style.transform="rotate("+-t.actualRotation+"deg) translate("+n.imageTransforms.x+"px, "+n.imageTransforms.y+"px) rotate("+t.actualRotation+"deg) translateZ("+a+"px)":!t.actualRotation||i||o?t.isDraggable?e.target.style.transform="translate("+i+"%, "+o+"%) translate("+n.imageTransforms.x+"px, "+n.imageTransforms.y+"px) rotate("+t.actualRotation+"deg) translateZ("+a+"px)":e.target.style.transform="":e.target.style.transform="translate("+n.imageTransforms.x+"px, "+n.imageTransforms.y+"px) rotate("+t.actualRotation+"deg) translateZ("+a+"px)",void 0!==t.element._scrollWatchEnterThreshold&&t.element._scrollWatchEnterThreshold.recalculateLocation(),void 0!==t.element._referenceScrollWatch&&t.element._referenceScrollWatch.recalculateLocation(),e.target._endScrollWatchLeave=requestAnimationFrame(_.bind(function(t){e.target.style.transitionDuration=""},this,t))},this,i))},this)}.bind(this),{root:null,rootMargin:"0px 9999999px 0px 9999999px",threshold:0})},getClosestBreakpoint:function(e,t){var i=250;return e<500&&(i=50),Math.floor(Math.min(Math.ceil(e/i)*i,t))},setResponsiveImageSrcs:function(){var e=!1;_.each(this.options.targets,function(n){var a,r,s,l=o(n.container);for(s=0;s<n.children.length;s++)if(r=n.children[s],isNaN(r.actualWidth)||void 0===r.imageModel||"function"!=typeof r.imageModel.get)t&&r.element.setAttribute("src",r.element.getAttribute("data-src"));else if(t)if(r.imageModel.get("width")>3500){var d=r.imageModel.getImageWithOptions({w:3500});r.element.getAttribute("src")!==d.url&&r.element.setAttribute("src",d.url)}else r.element.setAttribute("src",r.element.getAttribute("data-src"));else{var c=!1;if(r.isInThumbnails)l=r.element.parentElement.offsetWidth,l=Math.max(.01*parseFloat(r.element.style.width)*l,l)||l,a=this.getClosestBreakpoint(l,r.imageModel.get("width")),c=!0;else if(r.isInGallery){var h=i(r.element,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("gallery_card_image")});if(!h)continue;if(l=h.offsetWidth,a=this.getClosestBreakpoint(l,r.imageModel.get("width")),1===l)continue;c=!0}else r.isInWallpaper?(l=r.element.parentElement.offsetWidth,a=this.getClosestBreakpoint(l,r.imageModel.get("width")),c=!0):r.isInColumns?(l=r.element.parentElement.offsetWidth,a=this.getClosestBreakpoint(Math.max(r.actualWidth,l),r.imageModel.get("width"))):a=this.getClosestBreakpoint(r.actualWidth,r.imageModel.get("width"));if(0!=a)(d=r.imageModel.getImageWithOptions({w:a})).retina&&(Cargo.Model&&!0===Cargo.Model.Site.attributes.hiq?(c&&l/d.w>.51||r.actualWidth/d.w>.51)&&(d=r.imageModel.getImageWithOptions({w:a,q:94})):(c&&l/d.w>.51||!c&&r.actualWidth/d.w>.51)&&(d=r.imageModel.getImageWithOptions({w:a,q:94}))),d.w>=0&&(d.w>r.lastSize||d.q>r.lastQ)&&(r.isInSlideshow&&(!r.element.hasAttribute("src")||!r.element.getAttribute("src").indexOf("data:")>-1)?(r.element.hasAttribute("data-lazy")||(e=!0),r.element.getAttribute("data-lazy")!==d.url&&r.element.setAttribute("data-lazy",d.url)):r.element._hasLazyLoadObserver&&!r.isInWallpaper?r.element._inViewport?r.element.getAttribute("src")!==d.url&&r.element.setAttribute("src",d.url):r.element.getAttribute("src")!==d.url&&r.element.getAttribute("data-lazy-src")!==d.url&&r.element.setAttribute("data-lazy-src",d.url):r.element.getAttribute("src")!==d.url&&r.element.setAttribute("src",d.url),r.lastSize=d.w,r.lastQ=d.q,r.element._cachedLastSize=d.w,r.element._cachedLastQ=d.q)}},this),e&&Cargo.Event.trigger("slideshow-lazyload")}},a={options:n.options,init:n.init,refresh:n.refresh,update:n.update,requestTick:n.requestTick,requestRefreshTick:n.requestRefreshTick,setOptions:function(t){e.extend(n.options,t),!1!==n.options.forceMargin&&(n.options.forceHorizontalMargin=n.options.forceMargin,n.options.forceVerticalMargin=n.options.forceMargin),n.options.allowInit&&n.vars.initialized&&n.update()},targets:function(){return n.options.targets}};return e(function(){n.init()}),a}(jQuery),function(e,t){"use strict";this.PhotoSwipe=function(i,n,a,r){var s={features:null,bind:function(e,t,i,o){var n=(o?"remove":"add")+"EventListener";t=t.split(" ");for(var a=0;a<t.length;a++)t[a]&&e[n](t[a],i,!1)},isArray:function(e){return e instanceof Array},createEl:function(e,t){var i=document.createElement(t||"div");return e&&(i.className=e),i},getScrollY:function(){var i=e.pageYOffset;return i!==t?i:document.documentElement.scrollTop},unbind:function(e,t,i){s.bind(e,t,i,!0)},removeClass:function(e,t){var i=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(i," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")},addClass:function(e,t){s.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},hasClass:function(e,t){return e.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},getChildByClass:function(e,t){for(var i=e.firstChild;i;){if(s.hasClass(i,t))return i;i=i.nextSibling}},arraySearch:function(e,t,i){for(var o=e.length;o--;)if(e[o][i]===t)return o;return-1},extend:function(e,t,i){for(var o in t)if(t.hasOwnProperty(o)){if(i&&e.hasOwnProperty(o))continue;e[o]=t[o]}},easing:{sine:{out:function(e){return Math.sin(e*(Math.PI/2))},inOut:function(e){return-(Math.cos(Math.PI*e)-1)/2}},cubic:{out:function(e){return--e*e*e+1}}},detectFeatures:function(){if(s.features)return s.features;var t=s.createEl(),i=t.style,o="",n={};if(n.oldIE=document.all&&!document.addEventListener,n.touch="ontouchstart"in e,e.requestAnimationFrame&&(n.raf=e.requestAnimationFrame,n.caf=e.cancelAnimationFrame),n.pointerEvent=navigator.pointerEnabled||navigator.msPointerEnabled,!n.pointerEvent){var a=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var r=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);r&&r.length>0&&(r=parseInt(r[1],10))>=1&&r<8&&(n.isOldIOSPhone=!0)}var l=a.match(/Android\s([0-9\.]*)/),d=l?l[1]:0;(d=parseFloat(d))>=1&&(d<4.4&&(n.isOldAndroid=!0),n.androidVersion=d),n.isMobileOpera=/opera mini|opera mobi/i.test(a)}for(var c,h,u=["transform","perspective","animationName"],g=["","webkit","Moz","ms","O"],p=0;p<4;p++){o=g[p];for(var m=0;m<3;m++)c=u[m],h=o+(o?c.charAt(0).toUpperCase()+c.slice(1):c),!n[c]&&h in i&&(n[c]=h);o&&!n.raf&&(o=o.toLowerCase(),n.raf=e[o+"RequestAnimationFrame"],n.raf&&(n.caf=e[o+"CancelAnimationFrame"]||e[o+"CancelRequestAnimationFrame"]))}if(!n.raf){var f=0;n.raf=function(t){var i=(new Date).getTime(),o=Math.max(0,16-(i-f)),n=e.setTimeout(function(){t(i+o)},o);return f=i+o,n},n.caf=function(e){clearTimeout(e)}}return n.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,s.features=n,n}};s.detectFeatures(),s.features.oldIE&&(s.bind=function(e,t,i,o){t=t.split(" ");for(var n,a=(o?"detach":"attach")+"Event",r=function(){i.handleEvent.call(i)},s=0;s<t.length;s++)if(n=t[s])if("object"==typeof i&&i.handleEvent){if(o){if(!i["oldIE"+n])return!1}else i["oldIE"+n]=r;e[a]("on"+n,i["oldIE"+n])}else e[a]("on"+n,i)});var l=this,d={allowPanToNext:!0,spacing:.12,bgOpacity:1,mouseUsed:!1,loop:!0,pinchToClose:!0,closeOnScroll:!0,animatedCloseOnScroll:!0,showCaption:!0,closeOnVerticalDrag:!0,verticalDragRange:.75,hideAnimationDuration:222,showAnimationDuration:222,showHideOpacity:!1,focus:!0,escKey:!0,arrowKeys:!0,mainScrollEndFriction:.35,panEndFriction:.35,isClickableElement:function(e){return"A"===e.tagName},getDoubleTapZoom:function(e,t){return e?1:t.initialZoomLevel<.7?1:1.33},maxSpreadZoom:1.33,modal:!0,scaleMode:"fit"};s.extend(d,r);var c=null,h=function(){var e=s.getScrollY();null===c&&(c=e),Si||(fi+=e-c,c=e,C<=l.currItem.fitRatio&&!_i&&d.modal&&(!d.animatedCloseOnScroll||et||X?fi=0:N&&Math.abs(fi)>0&&!Te&&(Ei(),xi()),ui&&clearTimeout(ui),d.animatedCloseOnScroll,ui=setTimeout(function(){Ei(),ki()},200)))};e.addEventListener("scroll",h);var u,g,p,m,f,v,b,y,w,C,S,x,E,k,I,T,A,M,P,O,L,N,D,R,H,V,G,F,z,B,q,W,j,U,K,Y,Z,X,J,Q,ee,te,ie,oe,ne,ae,re,se,le,de,ce,he,ue,ge,pe,me={x:0,y:0},fe={x:0,y:0,rotation:0},ve={x:0,y:0,rotation:0},be={},_e={},ye=0,we={},Ce={x:0,y:0},Se=0,xe=!0,Ee=[],ke={},Ie=!1,Te=!1,Ae=function(e,t){s.extend(l,t.publicMethods),Ee.push(e)},Me=function(e){var t=Zt();return e>t-1?e-t:e<0?t+e:e},Pe={},Oe=function(e,t){return Pe[e]||(Pe[e]=[]),Pe[e].push(t)},Le=function(e){var t=Pe[e];if(t){var i=Array.prototype.slice.call(arguments);i.shift();for(var o=0;o<t.length;o++)t[o].apply(l,i)}},Ne=function(){return(new Date).getTime()},De=function(e){ue=e,l.bg.style.opacity=e*d.bgOpacity},Re=function(e,t,i,o,n,a){(!Ie||n&&n!==l.currItem)&&(o/=n?n.fitRatio:l.currItem.fitRatio),i+=_e.top,e[N]=x+t+"px, "+i+"px"+E+" scale("+o+") rotateZ("+a+"rad)"},He=function(e){se&&(e&&(C>l.currItem.fitRatio?Ie||(ai(l.currItem,!1,!0),Ie=!0):Ie&&(ai(l.currItem),Ie=!1)),Re(se,ve.x,ve.y,C,null,ve.rotation))},Ve=function(e){e.container&&Re(e.container.style,e.initialPosition.x,e.initialPosition.y,e.initialZoomLevel,e,0)},$e=function(e,t,i){i[N]=x+e+"px, "+t+"px"+E},Ge=function(e,t){if(!d.loop&&t){var i=m+(Ce.x*ye-e)/Ce.x,o=e-bt.x;(i<0&&o>0||i>=Zt()-1&&o<0)&&(e=bt.x+o*d.mainScrollEndFriction)}bt.x=e,$e(e,0,f)},Fe=function(e,t){var i=_t[e]-we[e];return fe[e]+me[e]+i-i*(t/S)},ze=function(e,t){e.x=t.x,e.y=t.y,t.id&&(e.id=t.id)},Be=function(e){e.x=Math.round(e.x),e.y=Math.round(e.y)},qe=null,We=function(){qe&&(s.unbind(document,"mousemove",We),s.addClass(i,"pswp--has_mouse"),d.mouseUsed=!0,Le("mouseUsed")),qe=setTimeout(function(){qe=null},100)},je=function(e,t){var i=ti(l.currItem,be,e);return t&&(re=i),i},Ue=function(e){return e||(e=l.currItem),e.initialZoomLevel},Ke=function(e){return e||(e=l.currItem),e.w>0?d.maxSpreadZoom:1},Ye=function(e,t,i,o){return o===l.currItem.initialZoomLevel?(i[e]=l.currItem.initialPosition[e],!0):(i[e]=Fe(e,o),i[e]>t.min[e]?(i[e]=t.min[e],!0):i[e]<t.max[e]&&(i[e]=t.max[e],!0))},Ze=function(e){var t="";d.escKey&&27===e.keyCode?t="close":d.arrowKeys&&(37===e.keyCode?t="prev":39===e.keyCode&&(t="next")),t&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey||(e.preventDefault?e.preventDefault():e.returnValue=!1,l[t]()))},Xe=function(e){e&&(ee||Q||le||Y)&&(e.preventDefault(),e.stopPropagation())},Je=function(){l.setScrollOffset(0,s.getScrollY())},Qe={},et=0,tt=function(e){Qe[e]&&(Qe[e].raf&&V(Qe[e].raf),et--,delete Qe[e])},it=function(e){Qe[e]&&tt(e),Qe[e]||(et++,Qe[e]={})},ot=function(){for(var e in Qe)Qe.hasOwnProperty(e)&&tt(e)},nt=function(e,t,i,o,n,a,r){var s,l=Ne();it(e);var d=function(){if(Qe[e]){if((s=Ne()-l)>=o)return tt(e),a(i),void(r&&r());a((i-t)*n(s/o)+t),Qe[e].raf=H(d)}};d()},at={shout:Le,listen:Oe,viewportSize:be,options:d,isMainScrollAnimating:function(){return le},getZoomLevel:function(){return C},getCurrentIndex:function(){return m},isDragging:function(){return X},isZooming:function(){return ne},setScrollOffset:function(e,t){we.x=e,z=we.y=t,Le("updateScrollOffset",we)},applyZoomPan:function(e,t,i,o){ve.x=t,ve.y=i,C=e,He(o)},init:function(){if(!u&&!g){var a;o("init",l),l.framework=s,l.template=i,l.bg=s.getChildByClass(i,"pswp__bg"),l.captionPositioner=s.getChildByClass(i,"quick-view-caption-positioner"),l.captionWrapper=s.getChildByClass(l.captionPositioner,"quick-view-caption-wrapper"),l.caption=s.getChildByClass(l.captionWrapper,"quick-view-caption"),G=i.className,u=!0,B=s.detectFeatures(),H=B.raf,V=B.caf,N=B.transform,F=B.oldIE,l.scrollWrap=s.getChildByClass(i,"pswp__scroll-wrap"),l.container=s.getChildByClass(l.scrollWrap,"pswp__container"),f=l.container.style,l.itemHolders=T=[{el:l.container.children[0],wrap:0,index:-1},{el:l.container.children[1],wrap:0,index:-1},{el:l.container.children[2],wrap:0,index:-1}],T[0].el.style.display=T[2].el.style.display="none",function(){if(N){var e=B.perspective&&!R;return x="translate"+(e?"3d(":"("),void(E=B.perspective?", 0px)":")")}N="left",s.addClass(i,"pswp--ie"),$e=function(e,t){t.left=e+"px"},Ve=function(e){var t=e.fitRatio>1?1:e.fitRatio,i=e.container.style,o=t*e.w,n=t*e.h;i.width=o+"px",i.height=n+"px",i.left=e.initialPosition.x+"px",i.top=e.initialPosition.y+"px"},He=function(){if(se){var e=se,t=l.currItem,i=t.fitRatio>1?1:t.fitRatio,o=i*t.w,n=i*t.h;e.width=o+"px",e.height=n+"px",e.left=ve.x+"px",e.top=ve.y+"px"}}}(),w={resize:l.updateSize,orientationchange:function(){clearTimeout(q),q=setTimeout(function(){be.x!==l.scrollWrap.clientWidth&&l.updateSize()},500)},scroll:Je,keydown:Ze,click:Xe};var r=B.isOldIOSPhone||B.isOldAndroid||B.isMobileOpera;for(B.animationName&&B.transform&&!r||(d.showAnimationDuration=d.hideAnimationDuration=0),a=0;a<Ee.length;a++)l["init"+Ee[a]]();if(n){var c=l.ui=new n(l,s);c.init()}Le("firstUpdate"),m=m||d.index||0,(isNaN(m)||m<0||m>=Zt())&&(m=0),l.currItem=Yt(m),(B.isOldIOSPhone||B.isOldAndroid)&&(xe=!1),i.setAttribute("aria-hidden","false"),d.modal&&(xe?i.style.position="fixed":(i.style.position="absolute",i.style.top=s.getScrollY()+"px")),i.classList.add("quick-view-vertical-align-"+d.alignVertical),i.classList.add("quick-view-horizontal-align-"+d.alignHorizontal),z===t&&(Le("initialLayout"),z=s.getScrollY());var h="pswp--open ";for(d.mainClass&&(h+=d.mainClass+" "),d.showHideOpacity&&(h+="pswp--animate_opacity "),h+=R?"pswp--touch":"pswp--notouch",h+=B.animationName?" pswp--css_animation":"",h+=B.svg?" pswp--svg":"",s.addClass(i,h),l.updateSize(),v=-1,Se=null,a=0;a<3;a++)$e((a+v)*Ce.x+_e.left,0,T[a].el.style);F||s.bind(l.scrollWrap,y,l),Oe("initialZoomInEnd",function(){l.setContent(T[0],m-1),l.setContent(T[2],m+1),T[0].el.style.display=T[2].el.style.display="block",d.focus&&i.focus(),l.updateCaption(),s.bind(document,"keydown",l),B.transform&&s.bind(l.scrollWrap,"click",l),d.mouseUsed||s.bind(document,"mousemove",We),s.bind(e,"resize scroll orientationchange",l),Le("bindEvents")}),l.setContent(T[1],m),l.updateCurrItem(),Le("afterInit"),o("after-init",l),xe||(k=setInterval(function(){et||X||ne||C!==l.currItem.initialZoomLevel||l.updateSize()},1e3)),s.addClass(i,"pswp--visible")}},close:function(){u&&(u=!1,g=!0,Le("close"),o("closing",l),s.unbind(e,"resize scroll orientationchange",l),s.unbind(e,"scroll",w.scroll),s.unbind(document,"keydown",l),s.unbind(document,"mousemove",We),B.transform&&s.unbind(l.scrollWrap,"click",l),X&&s.unbind(e,b,l),clearTimeout(q),Le("unbindEvents"),Xt(l.currItem,null,!0,l.destroy))},destroy:function(){Le("destroy"),o("destroy",l),Wt&&clearTimeout(Wt),i.setAttribute("aria-hidden","true"),i.className=G,k&&clearInterval(k),s.unbind(l.scrollWrap,y,l),s.unbind(e,"scroll",l),e.removeEventListener("scroll",h),Ct(),ot(),Pe=null},panTo:function(e,t,i){i||(e>re.min.x?e=re.min.x:e<re.max.x&&(e=re.max.x),t>re.min.y?t=re.min.y:t<re.max.y&&(t=re.max.y)),ve.x=e,ve.y=t,He()},handleEvent:function(t){t=t||e.event,w[t.type]&&w[t.type](t)},goTo:function(e){var t=(e=Me(e))-m;Se=t,m=e,l.currItem=Yt(m),ye-=t,Ge(Ce.x*ye),ot(),le=!1,l.updateCurrItem()},next:function(){l.goTo(m+1)},prev:function(){l.goTo(m-1)},updateCurrZoomItem:function(e){if(e&&(Le("beforeChange",0),o("before-slide-change",l,0)),T[1].el.children.length){var t=T[1].el.children[0];se=s.hasClass(t,"pswp__zoom-wrap")?t.style:null}else se=null;re=l.currItem.bounds,S=C=l.currItem.initialZoomLevel,ve.x=re.center.x,ve.y=re.center.y,e&&(Le("afterChange"),o("after-slide-change",l))},invalidateCurrItems:function(){I=!0;for(var e=0;e<3;e++)T[e].item&&(T[e].item.needsUpdate=!0)},updateCaption:function(){if(l.currItem.caption&&d.showCaption){for(;l.caption.childNodes.length>0;)l.caption.childNodes[0].parentNode.removeChild(l.caption.childNodes[0]);l.caption.appendChild(l.currItem.caption),ri(l.currItem),l.caption.classList.remove("hidden")}else if(d.showCaption){var e=function(){for(;l.caption.childNodes.length>0;)l.caption.childNodes[0].parentNode.removeChild(l.caption.childNodes[0]);l.caption.removeEventListener("transitionend",e)};l.caption.classList.contains("hidden")?e():(l.caption.addEventListener("transitionend",e),l.caption.classList.add("hidden"))}},updateCurrItem:function(e){if(0!==Se){var i,n=Math.abs(Se);if(!(e&&n<2)){l.currItem=Yt(m),Ie=!1,Le("beforeChange",Se);var a=Se;null===a&&(a=0),o("slide-change",l,a),n>=3&&(v+=Se+(Se>0?-3:3),n=3);for(var r=0;r<n;r++)Se>0?(i=T.shift(),T[2]=i,$e((++v+2)*Ce.x+_e.left,0,i.el.style),l.setContent(i,m-n+r+1+1)):(i=T.pop(),T.unshift(i),$e(--v*Ce.x+_e.left,0,i.el.style),l.setContent(i,m+n-r-1-1));if(se&&1===Math.abs(Se)){var s=Yt(A);s.initialZoomLevel!==C&&(ti(s,be),ai(s),Ve(s))}var d=1-Se,c=T[d];if(c&&!isNaN(A)){var h=c.el,u=h.querySelector("iframe"),g=h.querySelector("video");if(u){var p=u.getAttribute("src");u.setAttribute("src",""),setTimeout(function(){u&&u.setAttribute("src",p)},200)}g&&(g.pause(),g.currentTime=0)}Se=0,l.updateCurrZoomItem(),A!==t&&l.updateCaption(),A=m;var g=l.currItem.container.querySelector("video");g&&g.play(),Le("afterChange")}}},updateSize:function(o){if(!xe&&d.modal){var n=s.getScrollY();if(z!==n&&(i.style.top=n+"px",z=n),!o&&ke.x===e.innerWidth&&ke.y===e.innerHeight)return;ke.x=e.innerWidth,ke.y=e.innerHeight,i.style.height=ke.y+"px"}var a=e.getComputedStyle(l.template),r=parseFloat(a.getPropertyValue("padding-left"))+parseFloat(a.getPropertyValue("border-left-width")),c=parseFloat(a.getPropertyValue("margin-left")),h=parseFloat(a.getPropertyValue("padding-right"))+parseFloat(a.getPropertyValue("border-right-width")),u=parseFloat(a.getPropertyValue("margin-right")),g=parseFloat(a.getPropertyValue("padding-top"))+parseFloat(a.getPropertyValue("border-top-width")),p=parseFloat(a.getPropertyValue("margin-top")),f=parseFloat(a.getPropertyValue("padding-bottom"))+parseFloat(a.getPropertyValue("border-bottom-width")),b=parseFloat(a.getPropertyValue("margin-bottom"));_e.top=g,_e.left=r,_e.bottom=f,_e.right=h,_e.marginTop=p,_e.marginLeft=c,_e.marginBottom=b,_e.marginRight=u;var _=l.scrollWrap.getBoundingClientRect();if(be.x=_.width,be.y=_.height,Je(),Ce.x=be.x+be.x*d.spacing,Ce.y=be.y,Ge(Ce.x*ye),Le("beforeResize"),v!==t){for(var y,w,x,E=0;E<3;E++)y=T[E],$e((E+v)*Ce.x+_e.left,0,y.el.style),x=m+E-1,d.loop&&Zt()>2&&(x=Me(x)),(w=Yt(x))&&(I||w.needsUpdate||!w.bounds)?(l.cleanSlide(w),l.setContent(y,x),1===E&&(l.currItem=w,l.updateCurrZoomItem(!0)),w.needsUpdate=!1):-1===y.index&&x>=0&&l.setContent(y,x),w&&w.container&&(ti(w,be),ai(w),Ve(w));I=!1}S=C=l.currItem.initialZoomLevel,(re=l.currItem.bounds)&&(ve.x=re.center.x,ve.y=re.center.y,He(!0)),Le("resize")},zoomTo:function(e,t,i,o,n){t&&(S=C,_t.x=Math.abs(t.x)-ve.x,_t.y=Math.abs(t.y)-ve.y,ze(fe,ve));var a=je(e,!1),r={};Ye("x",a,r,e),Ye("y",a,r,e);var c=C,h={x:ve.x,y:ve.y};Be(r);var u=function(t){1===t?(C=e,ve.x=r.x,ve.y=r.y,l.currItem.caption&&d.showCaption&&(Math.abs(C-l.currItem.fitRatio)>.01?l.caption.classList.add("hidden"):l.caption.classList.remove("hidden"))):(C=(e-c)*t+c,ve.x=(r.x-h.x)*t+h.x,ve.y=(r.y-h.y)*t+h.y),n&&n(t),He(1===t)};i?nt("customZoomTo",0,1,i,o||s.easing.sine.inOut,u):u(1)}},rt={},st={},lt={},dt={},ct={},ht=[],ut={},gt=[],pt={},mt=0,ft={x:0,y:0},vt=0,bt={x:0,y:0},_t={x:0,y:0},yt={x:0,y:0},wt=function(e,t){return pt.x=Math.abs(e.x-t.x),pt.y=Math.abs(e.y-t.y),Math.sqrt(pt.x*pt.x+pt.y*pt.y)},Ct=function(){te&&(V(te),te=null)},St=function(){X&&(te=H(St),Vt())},xt=function(e,t){return!(!e||e===document)&&!(e.getAttribute("class")&&e.getAttribute("class").indexOf("pswp__scroll-wrap")>-1)&&(t(e)?e:xt(e.parentNode,t))},Et={},kt=function(e,t){return Et.prevent=!xt(e.target,d.isClickableElement),Le("preventDragEvent",e,t,Et),Et.prevent},It=function(e,t){return t.x=e.pageX+-_e.left+-_e.marginLeft,t.y=e.pageY+-_e.top+-_e.marginTop,t.clientY=e.clientY,t.id=e.identifier,t},Tt=function(e,t,i){i.x=.5*(e.x+t.x),i.y=.5*(e.y+t.y)},At=function(){var e=ve.y-l.currItem.initialPosition.y;return Math.min(1.2-Math.abs(e/(be.y/2)),1)},Mt={},Pt={},Ot=[],Lt=function(e){for(;Ot.length>0;)Ot.pop();return D?(pe=0,ht.forEach(function(e){0===pe?Ot[0]=e:1===pe&&(Ot[1]=e),pe++})):e.type.indexOf("touch")>-1?e.touches&&e.touches.length>0&&(Ot[0]=It(e.touches[0],Mt),e.touches.length>1&&(Ot[1]=It(e.touches[1],Pt))):(Mt.x=e.pageX,Mt.y=e.pageY,Mt.clientY=e.clientY,Mt.id="",Ot[0]=Mt),Ot},Nt=function(e,i){var o,n,a,r,s=ve[e]+i[e],c=i[e]>0,h=bt.x+i.x,u=bt.x-ut.x;if(o=s>re.min[e]||s<re.max[e]?d.panEndFriction:1,s=ve[e]+i[e]*o,(d.allowPanToNext||C===l.currItem.initialZoomLevel)&&(se?"h"!==de||"x"!==e||Q||(c?(s>re.min[e]&&(o=d.panEndFriction,re.min[e],n=re.min[e]-fe[e]),(n<=0||u<0)&&Zt()>1?(r=h,u<0&&h>ut.x&&(r=ut.x)):re.min.x!==re.max.x&&(a=s)):(s<re.max[e]&&(o=d.panEndFriction,re.max[e],n=fe[e]-re.max[e]),(n<=0||u>0)&&Zt()>1?(r=h,u>0&&h<ut.x&&(r=ut.x)):re.min.x!==re.max.x&&(a=s))):r=h,"x"===e))return r!==t&&(Ge(r,!0),ie=r!==ut.x),re.min.x!==re.max.x&&(a!==t?ve.x=a:ie||(ve.x+=i.x*o)),r!==t;le||ie||C>l.currItem.fitRatio&&(ve[e]+=i[e]*o)},Dt=null,Rt=function(t){if(!("mousedown"===t.type&&t.button>0))if(Kt)t.preventDefault();else if(!Z||"mousedown"!==t.type){if(kt(t,!0)&&t.preventDefault(),Ci=t.type,Dt=setTimeout(function(){l.template.classList.add("mouse-down")},200),Le("pointerDown"),D){var i=s.arraySearch(ht,t.pointerId,"id");i<0&&(i=ht.length),ht[i]={x:t.pageX,y:t.pageY,clientY:t.clientY,id:t.pointerId}}var o=Lt(t),n=o.length;oe=null,ot(),X&&1!==n||(X=ce=!0,s.bind(e,b,l),K=_i=ge=he=Y=ie=ee=J=Q=!1,de=null,mi=o[0].y+-z,Le("firstTouchStart",o),ze(fe,ve),me.x=me.y=0,ze(dt,o[0]),ze(ct,dt),ut.x=Ce.x*ye,gt=[{x:dt.x,y:dt.y}],j=W=Ne(),je(C,!0),Ct(),St()),!ne&&n>1&&!le&&!ie&&(S=C,Q=!1,ne=J=!0,me.y=me.x=0,ze(fe,ve),ze(rt,o[0]),ze(st,o[1]),Tt(rt,st,yt),_t.x=Math.abs(yt.x)-ve.x,_t.y=Math.abs(yt.y)-ve.y,ae=wt(rt,st))}},Ht=function(e){if(e.preventDefault(),D){var t=s.arraySearch(ht,e.pointerId,"id");if(t>-1){var i=ht[t];i.x=e.pageX,i.y=e.pageY,i.clientY=e.clientY}}if(X){var o=Lt(e);if(de||ee||ne)oe=o;else if(bt.x!==Ce.x*ye)de="h";else{var n=Math.abs(o[0].x-dt.x)-Math.abs(o[0].y-dt.y);Math.abs(n)>=10&&(de=n>0?"h":"v",oe=o),"h"===de&&d.showCaption&&l.caption.classList.add("hidden")}pi+=mi-o[0].clientY,mi=o[0].clientY}},Vt=function(){if(oe){var t=oe.length;if(0!==t)if(ze(rt,oe[0]),lt.x=rt.x-dt.x,lt.y=rt.y-dt.y,ne&&t>1){if(dt.x=rt.x,dt.y=rt.y,!lt.x&&!lt.y&&function(e,t){return e.x===t.x&&e.y===t.y}(oe[1],st))return;ze(st,oe[1]),Q||(Q=!0,Le("zoomGestureStarted"),l.currItem.caption&&d.showCaption&&l.caption.classList.add("hidden"));var i=wt(rt,st),o=Bt(i);o>l.currItem.initialZoomLevel+l.currItem.initialZoomLevel/15&&(ge=!0);var n=1,a=Ue(),r=Ke();if(o<a)if(d.pinchToClose&&!ge&&S<=l.currItem.initialZoomLevel){var s=a-o,c=1-s/(a/1.2);De(c),Le("onPinchClose",c),he=!0}else(n=(a-o)/a)>1&&(n=1),o=a-n*(a/3);else o>r&&((n=(o-r)/(6*a))>1&&(n=1),o=r+n*a);n<0&&(n=0),Tt(rt,st,ft),me.x+=ft.x-yt.x,me.y+=ft.y-yt.y,ze(yt,ft),ve.x=Fe("x",o),ve.y=Fe("y",o),K=o>C,C=o,He()}else{if(!de)return;if(ce&&(ce=!1,Math.abs(lt.x)>=10&&(lt.x-=oe[0].x-ct.x),Math.abs(lt.y)>=10&&(lt.y-=oe[0].y-ct.y,pi-=-(oe[0].y-ct.y))),dt.x=rt.x,dt.y=rt.y,0===lt.x&&0===lt.y)return;if("v"===de&&d.animatedCloseOnScroll&&"touchstart"===Ci){if(fi=pi,pi=0,!_i&&!Te){_i=!0,Ei(),xi();var h=1,u=0;yi=0,wi=0;var g,p,m=dt.y,f=dt.y,v=document.documentElement.scrollTop,b=document.documentElement.scrollHeight,_=be.y,y=!1,w=$(".content_container, .pinned > div:not(.fixed)"),x=$(".backdrop > div");x.each(function(){this.__cacheStyle=this.style});var E=function(e){if(0==e.touches.length||e.touches.length>1)return k(),void I();e.preventDefault(),yi=f-e.touches[0].pageY,wi=yi,yi+v<=0?(scrollMonitor.__frozen=!0,wi=-v):yi+v+_>=b?(scrollMonitor.__frozen=!0,wi=0):scrollMonitor.__frozen&&delete scrollMonitor.__frozen,u=m-e.touches[0].pageY,m=e.touches[0].pageY,y||(y=!0,p=requestAnimationFrame(function(){w.css({transform:"translateY("+-wi+"px)"}),x.each(function(e){var t=this.parentElement.__backdropData,i=this.parentElement.__cached_size,o=this.parentElement.__cached_page_size;if(t){var n=0,a=0,r=0;i&&(n=i.top,a=i.height,r=a),o&&(r=o.height),parseFloat(t.yPos),"fixed"===this.style.position&&(this.style.position="absolute");var s=v+wi,l=v+wi+Cargo.Backdrop.cache_window_data.height,d=n+v,c=n+v+r;if(d<=s&&c>=l){var h=d-s;this.style.transform="translateY("+-h+"px)"}else this.style.transform=c<l?"translateY("+(r-Cargo.Backdrop.cache_window_data.height)+"px)":"translateY(0px)"}}),y=!1}))},k=function(){e.removeEventListener("touchmove",E),e.removeEventListener("touchend",k),e.addEventListener("touchstart",I),cancelAnimationFrame(p),w.css({transform:""}),x.each(function(){this.__cacheStyle&&(this.style=this.__cacheStyle,delete this.__cacheStyle)}),document.documentElement.scrollTop=document.documentElement.scrollTop+yi,T(),requestAnimationFrame(function(){scrollMonitor.__frozen&&delete scrollMonitor.__frozen,Cargo.View.Backdrop.updateBackdropScrollPosition(!0),Cargo.Event.trigger("lightbox-scroll-finished")})},I=function(){u=0,cancelAnimationFrame(g),e.removeEventListener("touchstart",I)},T=function(){var e=u*(h*=.95);document.documentElement.scrollTop=document.documentElement.scrollTop+e,Math.abs(e)>.5?g=requestAnimationFrame(function(){T()}):I()};e.addEventListener("touchmove",E),e.addEventListener("touchend",k)}return}if("v"===de&&d.closeOnVerticalDrag&&"fit"===d.scaleMode&&C===l.currItem.initialZoomLevel){me.y+=lt.y,ve.y+=lt.y;var A=At();return Y=!0,Le("onVerticalDrag",A),De(A),void He()}!function(e,t,i){if(e-j>50){var o=gt.length>2?gt.shift():{};o.x=t,o.y=i,gt.push(o),j=e}}(Ne(),rt.x,rt.y),ee=!0,re=l.currItem.bounds;var M=Nt("x",lt);M||(Nt("y",lt),Be(ve),He())}}},$t=function(t){if(Ci="",B.isOldAndroid){if(Z&&"mouseup"===t.type)return;t.type.indexOf("touch")>-1&&(clearTimeout(Z),Z=setTimeout(function(){Z=0},600))}var i;if(clearTimeout(Dt),l.template.classList.remove("mouse-down"),Le("pointerUp"),kt(t,!1)&&t.preventDefault(),D){var o=s.arraySearch(ht,t.pointerId,"id");o>-1&&(i=ht.splice(o,1)[0],navigator.pointerEnabled?i.type=t.pointerType||"mouse":(i.type={4:"mouse",2:"touch",3:"pen"}[t.pointerType],i.type||(i.type=t.pointerType||"mouse")))}var n,a=Lt(t),r=a.length;if("mouseup"===t.type&&(r=0),2===r)return oe=null,!0;1===r&&ze(ct,a[0]),0!==r||de||le||(i||("mouseup"===t.type?i={x:t.pageX+-_e.left+-_e.marginLeft,y:t.pageY+-_e.top+-_e.marginTop,type:"mouse"}:t.changedTouches&&t.changedTouches[0]&&(i={x:t.changedTouches[0].pageX+-_e.left+-_e.marginLeft,y:t.changedTouches[0].pageY+-_e.top+-_e.marginTop,type:"touch"})),Le("touchRelease",t,i));var c=-1;if(0===r&&(X=!1,s.unbind(e,b,l),Ct(),ne?c=0:-1!==vt&&(c=Ne()-vt)),vt=1===r?Ne():-1,n=-1!==c&&c<150?"zoom":"swipe",ne&&r<2&&(ne=!1,1===r&&(n="zoomPointerUp"),Le("zoomGestureEnded")),oe=null,ee||Q||le||Y||_i){if(ot(),U||(U=Gt()),U.calculateSwipeSpeed("x"),_i)ui&&clearTimeout(ui),_i=!1,Ei(),ki();else if(Y){var h=At();if(h<d.verticalDragRange)l.close();else{var u=ve.y,g=ue;nt("verticalDrag",0,1,300,s.easing.cubic.out,function(e){ve.y=(l.currItem.initialPosition.y-u)*e+u,De((1-g)*e+g),He()}),Le("onVerticalDrag",1)}return}if((ie||le)&&0===r){var p=zt(n,U);if(p)return;n="zoomPointerUp"}le||("swipe"===n?!ie&&C>l.currItem.fitRatio&&Ft(U):qt())}},Gt=function(){var e,i,o={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(t){gt.length>1?(e=Ne()-j+50,i=gt[gt.length-2][t]):(e=Ne()-W,i=ct[t]),o.lastFlickOffset[t]=dt[t]-i,o.lastFlickDist[t]=Math.abs(o.lastFlickOffset[t]),o.lastFlickDist[t]>20?o.lastFlickSpeed[t]=o.lastFlickOffset[t]/e:o.lastFlickSpeed[t]=0,Math.abs(o.lastFlickSpeed[t])<.1&&(o.lastFlickSpeed[t]=0),o.slowDownRatio[t]=.95,o.slowDownRatioReverse[t]=1-o.slowDownRatio[t],o.speedDecelerationRatio[t]=1},calculateOverBoundsAnimOffset:function(e,i){o.backAnimStarted[e]||(ve[e]>re.min[e]?o.backAnimDestination[e]=re.min[e]:ve[e]<re.max[e]&&(o.backAnimDestination[e]=re.max[e]),o.backAnimDestination[e]!==t&&(o.slowDownRatio[e]=.7,o.slowDownRatioReverse[e]=1-o.slowDownRatio[e],o.speedDecelerationRatioAbs[e]<.05&&(o.lastFlickSpeed[e]=0,o.backAnimStarted[e]=!0,nt("bounceZoomPan"+e,ve[e],o.backAnimDestination[e],i||300,s.easing.sine.out,function(t){ve[e]=t,He()}))))},calculateAnimOffset:function(e){o.backAnimStarted[e]||(o.speedDecelerationRatio[e]=o.speedDecelerationRatio[e]*(o.slowDownRatio[e]+o.slowDownRatioReverse[e]-o.slowDownRatioReverse[e]*o.timeDiff/10),o.speedDecelerationRatioAbs[e]=Math.abs(o.lastFlickSpeed[e]*o.speedDecelerationRatio[e]),o.distanceOffset[e]=o.lastFlickSpeed[e]*o.speedDecelerationRatio[e]*o.timeDiff,ve[e]+=o.distanceOffset[e])},panAnimLoop:function(){if(Qe.zoomPan&&(Qe.zoomPan.raf=H(o.panAnimLoop),o.now=Ne(),o.timeDiff=o.now-o.lastNow,o.lastNow=o.now,o.calculateAnimOffset("x"),o.calculateAnimOffset("y"),He(),o.calculateOverBoundsAnimOffset("x"),o.calculateOverBoundsAnimOffset("y"),o.speedDecelerationRatioAbs.x<.05&&o.speedDecelerationRatioAbs.y<.05))return ve.x=ve.x,ve.y=ve.y,He(),void tt("zoomPan")}};return o},Ft=function(e){if(e.calculateSwipeSpeed("y"),re=l.currItem.bounds,e.backAnimDestination={},e.backAnimStarted={},Math.abs(e.lastFlickSpeed.x)<=.05&&Math.abs(e.lastFlickSpeed.y)<=.05)return e.speedDecelerationRatioAbs.x=e.speedDecelerationRatioAbs.y=0,e.calculateOverBoundsAnimOffset("x"),e.calculateOverBoundsAnimOffset("y"),!0;it("zoomPan"),e.lastNow=Ne(),e.panAnimLoop()},zt=function(e,t){var i,o,n;if(le||(mt=m),"swipe"===e){var a=dt.x-ct.x,r=t.lastFlickDist.x<10;a>30&&(r||t.lastFlickOffset.x>20)?o=-1:a<-30&&(r||t.lastFlickOffset.x<-20)&&(o=1)}o&&((m+=o)<0?(m=d.loop?Zt()-1:0,n=!0):m>=Zt()&&(m=d.loop?0:Zt()-1,n=!0),n&&!d.loop||(Se+=o,ye-=o,i=!0));var c,h=Ce.x*ye,u=Math.abs(h-bt.x);return i||h>bt.x==t.lastFlickSpeed.x>0?(c=Math.abs(t.lastFlickSpeed.x)>0?u/Math.abs(t.lastFlickSpeed.x):333,c=Math.min(c,400),c=Math.max(c,250)):c=333,mt===m&&(i=!1),le=!0,Le("mainScrollAnimStart"),nt("mainScroll",bt.x,h,c,s.easing.cubic.out,Ge,function(){ot(),le=!1,mt=-1,(i||mt!==m)&&l.updateCurrItem(),Le("mainScrollAnimComplete")}),i&&l.updateCurrItem(!0),i},Bt=function(e){return 1/ae*e*S},qt=function(){var e=C,t=Ue(),i=Ke();C<t?e=t:C>i&&(e=i);var o,n=ue;return he&&!K&&!ge&&C<t?(l.close(),!0):(he&&(o=function(e){De((1-n)*e+n)}),l.zoomTo(e,0,200,s.easing.cubic.out,o),!0)};Ae("Gestures",{publicMethods:{initGestures:function(){var e=function(e,t,i,o,n){M=e+t,P=e+i,O=e+o,L=n?e+n:""};(D=B.pointerEvent)&&B.touch&&(B.touch=!1),D?navigator.pointerEnabled?e("pointer","down","move","up","cancel"):e("MSPointer","Down","Move","Up","Cancel"):B.touch?(e("touch","start","move","end","cancel"),R=!0):e("mouse","down","move","up"),b=P+" "+O+" "+L,y=M,D&&!R&&(R=navigator.maxTouchPoints>1||navigator.msMaxTouchPoints>1),l.likelyTouchDevice=R,w[M]=Rt,w[P]=Ht,w[O]=$t,L&&(w[L]=w[O]),B.touch&&(y+=" mousedown",b+=" mousemove mouseup",w.mousedown=w[M],w.mousemove=w[P],w.mouseup=w[O]),R||(d.allowPanToNext=!1)}}});var Wt,jt,Ut,Kt,Yt,Zt,Xt=function(e,o,n,a){var r;Wt&&clearTimeout(Wt),Kt=!0,Ut=!0,e.initialLayout?(r=e.initialLayout,e.initialLayout=null):r=d.getThumbBoundsFn&&d.getThumbBoundsFn(m);var c=n?d.hideAnimationDuration:d.showAnimationDuration,h=function(){tt("initialZoom"),n?(l.template.removeAttribute("style"),l.bg.removeAttribute("style")):(De(1),o&&(o.style.display="block"),s.addClass(i,"pswp--hide-overflow"),s.addClass(i,"pswp--animated-in"),Le("initialZoom"+(n?"OutEnd":"InEnd"))),a&&a(),Kt=!1};if(!c||!r||r.x===t)return Le("initialZoom"+(n?"Out":"In")),C=e.initialZoomLevel,ze(ve,e.initialPosition),He(),i.style.opacity=n?0:1,De(1),void(c?setTimeout(function(){h()},c):h());!function(){var t=p,o=!l.currItem.src||l.currItem.loadError||d.showHideOpacity,a=_i,u=n?25:90;t&&(u=0),e.miniImg&&(e.miniImg.style.webkitBackfaceVisibility="hidden");var g=parseFloat(e.w),m=parseFloat(e.h);e.useViewportWidth&&(g=(be.x-(_e.left+_e.right))*e.lightboxWidth),e.useViewportHeight&&(m=(be.y-(_e.top+_e.bottom))*e.lightboxHeight);var f=r.w/r.h>g/m;if(!n){C=f?r.h/m:r.w/g;var v=.5*(r.w-g*C),b=.5*(r.h-m*C),y=v*Math.cos(r.transform.rotation)-b*Math.sin(r.transform.rotation),w=v*Math.sin(r.transform.rotation)+b*Math.cos(r.transform.rotation);ve.rotation=r.transform.rotation,ve.y=r.y+-(_e.top+_e.marginTop)+w,ve.x=r.x+-(_e.left+_e.marginLeft)+y,l[o?"template":"bg"].style.opacity=.001,He(),ve.rotation=0}if(it("initialZoom"),n&&!t&&s.removeClass(i,"pswp--animated-in"),n){s.removeClass(i,"pswp--hide-overflow");var S=l.getCurrentIndex();_.each(l.itemHolders,function(e){e.index!==S&&(e.el.style.display="none")}),d.showCaption&&l.caption.classList.add("hidden")}(o||a)&&(n?s[(t?"remove":"add")+"Class"](i,"pswp--animate_opacity"):setTimeout(function(){s.addClass(i,"pswp--animate_opacity")},30));var x=function(){if(Le("initialZoom"+(n?"Out":"In")),n){var l=f?r.h/m:r.w/g,d=.5*(r.w-g*l),u=.5*(r.h-m*l),p=d*Math.cos(r.transform.rotation)-u*Math.sin(r.transform.rotation),v=d*Math.sin(r.transform.rotation)+u*Math.cos(r.transform.rotation),b={x:ve.x,y:ve.y,rotation:0},_=C,y=ue,w=document.documentElement.scrollTop,S=wi,x=function(e){var t=w-document.documentElement.scrollTop,n=S-wi;if(1===e?(C=l,ve.x=r.x+-(_e.left+_e.marginLeft)+p,ve.y=r.y+t+n+-(_e.top+_e.marginTop)+v,ve.rotation=r.transform.rotation):(C=(l-_)*e+_,ve.x=(r.x+-b.x+-(_e.left+_e.marginLeft)+p)*e+b.x,ve.y=(r.y+t+n+-(_e.top+_e.marginTop)+v)*e+(1-e)*(b.y+t+n),ve.rotation=(r.transform.rotation-b.rotation)*e+b.rotation),He(),a){var s=1-e;if(Math.hasOwnProperty("cbrt")){var d=1-Math.cbrt(s);s=1-d*d*d*d}i.style.opacity=s}else o?i.style.opacity=1-e:De(y-e*y)};t?nt("initialZoom",0,1,c,s.easing.cubic.out,x,h):(x(1),Wt=setTimeout(h,c+20))}else C=e.initialZoomLevel,ze(ve,e.initialPosition),He(),De(1),o?i.style.opacity=1:De(1),Wt=setTimeout(h,c+20)};0===u?x():Wt=setTimeout(function(){x()},u)}()},Jt={},Qt=[],ei={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:!1,preload:[1,1],getNumItemsFn:function(){return jt.length}},ti=function(e,t,i){if(e.src&&!e.loadError||e.html&&!e.src){var o=!i;if(o&&(e.vGap||(e.vGap={top:0,bottom:0}),e.hGap||(e.hGap={left:0,right:0}),Le("parseVerticalMargin",e)),e.useViewportHeight||e.useViewportWidth?(Jt.x=t.x-e.hGap.left-e.hGap.right,Jt.y=t.y-e.vGap.top-e.vGap.bottom):(Jt.x=t.x-e.hGap.left-e.hGap.right-(_e.left+_e.right),Jt.y=t.y-e.vGap.top-e.vGap.bottom-(_e.top+_e.bottom)),o){var n=e.w,a=e.h;e.useViewportWidth&&(n=(t.x-(_e.left+_e.right))*e.lightboxWidth),e.useViewportHeight&&(a=(t.y-(_e.top+_e.bottom))*e.lightboxHeight);var r=Jt.x/n,s=Jt.y/a;e.useViewportHeight||e.useViewportWidth?e.fitRatio=1:e.fitRatio=r<s?r:s;var l=d.scaleMode;"orig"===l?i=1:"fit"===l&&(i=e.fitRatio),i>1&&(i=1),e.initialZoomLevel=i,e.bounds||(e.bounds={center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}})}if(!i)return;var n=e.w,a=e.h;return e.useViewportWidth&&(n=t.x*e.lightboxWidth),e.useViewportHeight&&(a=t.y*e.lightboxHeight),(e.useViewportHeight||e.useViewportWidth)&&(i=1),function(e,t,i){var o=e.bounds;"left"===d.alignHorizontal?o.center.x=0:"right"===d.alignHorizontal?o.center.x=Jt.x-t+e.hGap.left:o.center.x=(Jt.x-t)/2+e.hGap.left,"top"===d.alignVertical?o.center.y=0:"bottom"===d.alignVertical?o.center.y=Jt.y-i+e.vGap.top:o.center.y=(Jt.y-i)/2+e.vGap.top,o.max.x=t>Jt.x?Jt.x-t+e.hGap.left:o.center.x,o.max.y=i>Jt.y?Jt.y-i+e.vGap.top:o.center.y,o.min.x=t>Jt.x?e.hGap.left:o.center.x,o.min.y=i>Jt.y?e.vGap.top:o.center.y}(e,n*i,a*i),o&&i===e.initialZoomLevel&&(e.initialPosition=e.bounds.center),e.bounds}return e.w=e.h=0,e.initialZoomLevel=e.fitRatio=1,e.bounds={center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}},e.initialPosition=e.bounds.center,e.bounds},ii=function(e,t,i,o,n,a){t.loadError||o&&(t.imageAppended=!0,ai(t,o,t===l.currItem&&Ie),o.classList.add("quick-view-item"),i.appendChild(o),a&&(t.placeholder&&t.placeholder.classList.remove("quick-view-item"),setTimeout(function(){t&&t.loaded&&t.placeholder&&(t.placeholder.style.display="none",t.placeholder=null)},500)))},oi=function(e){e.loading=!0,e.loaded=!1;var t=e.img=s.createEl("pswp__img","img"),i=function(){e.loading=!1,e.loaded=!0,e.loadComplete?e.loadComplete(e):e.img=null,t.onload=t.onerror=null,t=null};return t.onload=i,t.onerror=function(){e.loadError=!0,i()},t.src=e.src,t},ni=function(e,t){if(e.src&&e.loadError&&e.container)return t&&(e.container.innerHTML=""),e.container.innerHTML=d.errorMsg.replace("%url%",e.src),!0},ai=function(e,t,i){if(e.html||e.src){t||(t=e.container.lastChild);var o=i?e.w:e.w*e.fitRatio,n=i?e.h:e.h*e.fitRatio,a=e.w*e.fitRatio,r=e.h*e.fitRatio;e.useViewportWidth&&(o=be.x*e.lightboxWidth,o=a=o-(_e.left+_e.right)),e.useViewportHeight&&(n=be.y*e.lightboxHeight,n=r=n-(_e.top+_e.bottom)),e.renderedSize.w=a,e.renderedSize.h=r,e===l.currItem&&ri(e),t.style.width=o+"px",t.style.height=n+"px"}},ri=function(e){var t=e.renderedSize.w,i=(e.renderedSize.h,Math.max(1,e.fitRatio));l.captionWrapper.style.width=t/i+"px",l.captionWrapper.style.right=_e.right+"px",l.captionWrapper.style.left=_e.left+"px"},si=function(){if(Qt.length){for(var e,t=0;t<Qt.length;t++)(e=Qt[t]).holder.index===e.index&&ii(e.index,e.item,e.baseDiv,e.img,0,e.clearPlaceholder);Qt=[]}};Ae("Controller",{publicMethods:{lazyLoadItem:function(e){e=Me(e);var t=Yt(e);t&&(!t.loaded&&!t.loading||I)&&(Le("gettingData",e,t),t.src&&oi(t))},initController:function(){s.extend(d,ei,!0),l.items=jt=a,Yt=l.getItemAt,Zt=d.getNumItemsFn,d.loop,Zt()<3&&(d.loop=!1),Oe("beforeChange",function(e){var t,i=d.preload,o=null===e||e>=0,n=Math.min(i[0],Zt()),a=Math.min(i[1],Zt());for(t=1;t<=(o?a:n);t++)l.lazyLoadItem(m+t);for(t=1;t<=(o?n:a);t++)l.lazyLoadItem(m-t)}),Oe("initialLayout",function(){l.currItem.initialLayout=d.getThumbBoundsFn&&d.getThumbBoundsFn(m)}),Oe("mainScrollAnimComplete",si),Oe("initialZoomInEnd",si),Oe("destroy",function(){for(var e,t=0;t<jt.length;t++)(e=jt[t]).container&&(e.container=null),e.placeholder&&(e.placeholder=null),e.img&&(e.img=null),e.preloader&&(e.preloader=null),e.loadError&&(e.loaded=e.loadError=!1);Qt=null})},getItemAt:function(e){return e>=0&&jt[e]!==t&&jt[e]},allowProgressiveImg:function(){return d.forceProgressiveLoading||!R||d.mouseUsed||screen.width>1200},setContent:function(e,t){d.loop&&(t=Me(t));var i=l.getItemAt(e.index);i&&(i.container=null);var o,n=l.getItemAt(t);if(n){Le("gettingData",t,n),e.index=t,e.item=n;var a=n.container=s.createEl("pswp__zoom-wrap"),r=!1;if(!n.src&&n.html&&(n.html.tagName?a.appendChild(n.html):a.innerHTML=n.html,a.firstChild&&a.firstChild.classList.add("quick-view-item"),r=a.querySelector("iframe")),r?e.el.classList.add("iframe-item"):e.el.classList.remove("iframe-item"),ni(n),ti(n,be),!n.src||n.loadError||n.loaded)n.src&&!n.loadError?((o=s.createEl("pswp__img","img")).style.opacity=1,o.src=n.src,ai(n,o),ii(0,n,a,o)):!n.src&&n.html&&ai(n,null);else{if(n.loadComplete=function(i){if(u){if(e&&e.index===t){if(ni(i,!0))return i.loadComplete=i.img=null,ti(i,be),Ve(i),void(e.index===m&&l.updateCurrZoomItem());i.imageAppended?!Kt&&i.placeholder&&(i.placeholder.style.display="none",i.placeholder=null):B.transform&&(le||Kt)?Qt.push({item:i,baseDiv:a,img:i.img,index:t,holder:e,clearPlaceholder:!0}):ii(0,i,a,i.img,0,!0)}i.loadComplete=null,i.img=null,Le("imageLoadComplete",t,i)}},s.features.transform){var c="pswp__img pswp__img--placeholder";c+=n.msrc?"":" pswp__img--placeholder--blank";var h=s.createEl(c,n.msrc?"img":"");h.classList.add("quick-view-item"),n.msrc&&(h.src=n.msrc),ai(n,h),a.appendChild(h),n.placeholder=h}n.loading||oi(n),l.allowProgressiveImg()&&(!Ut&&B.transform?Qt.push({item:n,baseDiv:a,img:n.img,index:t,holder:e}):ii(0,n,a,n.img,0,!0))}Ut||t!==m?Ve(n):(se=a.style,Xt(n,o||n.img)),e.el.innerHTML="",e.el.appendChild(a)}else e.el.innerHTML=""},cleanSlide:function(e){e.img&&(e.img.onload=e.img.onerror=null),e.loaded=e.loading=e.img=e.imageAppended=!1}}});var li,di,ci={},hi=function(e,t,i){var o=document.createEvent("CustomEvent"),n={origEvent:e,target:e.target,releasePoint:t,pointerType:i||"touch"};o.initCustomEvent("pswpTap",!0,!0,n),e.target.dispatchEvent(o)};Ae("Tap",{publicMethods:{initTap:function(){Oe("firstTouchStart",l.onTapStart),Oe("touchRelease",l.onTapRelease),Oe("destroy",function(){ci={},li=null})},onTapStart:function(e){e.length>1&&(clearTimeout(li),li=null)},onTapRelease:function(e,t){var i,o;if(t&&!ee&&!J&&!et){var n=t;if(li&&(clearTimeout(li),li=null,i=n,o=ci,Math.abs(i.x-o.x)<25&&Math.abs(i.y-o.y)<25))return void Le("doubleTap",n);if("mouse"===t.type)return void hi(e,t,"mouse");var a=e.target.tagName.toUpperCase();if("BUTTON"===a||s.hasClass(e.target,"pswp__single-tap"))return void hi(e,t);ze(ci,n),li=setTimeout(function(){hi(e,t),li=null},300)}}}});var ui,gi,pi=0,mi=0,fi=0,vi=!1,bi=0,_i=!1,yi=0,wi=0,Ci="",c=null,Si=!1,xi=function(){Te=!0,Ii()},Ei=function(){di&&(V(di),di=null,bi=0,fi=0,Te=!1)},ki=function(){if(!Te&&!Ti){var e=ve.y,t=(ve.x,ue),i=C;nt("resetVertical",0,1,300,s.easing.cubic.out,function(o){C=l.currItem.initialZoomLevel*o+(1-o)*i,ve.y=(l.currItem.initialPosition.y-e)*o+e;var n=.5*(l.currItem.initialZoomLevel*parseFloat(l.currItem.w)-C*parseFloat(l.currItem.w));ve.x=l.currItem.initialPosition.x+n,De((1-t)*o+t),He()})}},Ii=function(){vi||(vi=!0,Te&&(di=H(Ii),Ai(),vi=!1))},Ti=!1,Ai=function(){!_i&&Si&&(document.documentElement.scrollTop=document.documentElement.scrollTop+fi);var e=Math.min(be.y,be.x),t=Math.abs(fi)/e,i=Math.max(0,Math.min(1.3-Math.abs(bi/(e/3)),1));if(i<.85||Ti||t>.2)return Ei(),ui&&clearTimeout(ui),void(Ti||(Ti=!0,_i?(p=!0,l.close()):setTimeout(function(){p=!0,l.close()},25)));De(i);var o=Math.abs(bi)/(.75*be.y);if(l.currItem.hasOwnProperty("thumbRect")){var n=l.currItem.initialZoomLevel*parseFloat(l.currItem.h)*.5<l.currItem.thumbRect.h;n&&(o=0)}C=(1-o*o)*l.currItem.initialZoomLevel;var a=.5*(l.currItem.initialZoomLevel*parseFloat(l.currItem.w)-C*parseFloat(l.currItem.w)),r=.5*(l.currItem.initialZoomLevel*parseFloat(l.currItem.h)-C*parseFloat(l.currItem.h));ve.y=l.currItem.initialPosition.y+r+-bi,ve.x=l.currItem.initialPosition.x+a,He(),bi+=fi,fi=0};Ae("DesktopZoom",{publicMethods:{initDesktopZoom:function(){F||(R?l.setupDesktopZoom():l.setupDesktopZoom(!0))},setupDesktopZoom:function(e){gi={};var t="wheel mousewheel DOMMouseScroll";Oe("bindEvents",function(){s.bind(i,t,l.handleMouseWheel)}),Oe("unbindEvents",function(){gi&&s.unbind(i,t,l.handleMouseWheel)}),l.mouseZoomedIn=!1;var o,n=function(){l.mouseZoomedIn&&(s.removeClass(i,"pswp--zoomed-in"),l.mouseZoomedIn=!1),C<1?s.addClass(i,"pswp--zoom-allowed"):s.removeClass(i,"pswp--zoom-allowed"),a()},a=function(){o&&(s.removeClass(i,"pswp--dragging"),o=!1)};Oe("resize",n),Oe("afterChange",n),Oe("pointerDown",function(){l.mouseZoomedIn&&(o=!0,s.addClass(i,"pswp--dragging"))}),Oe("pointerUp",a),e||n()},handleMouseWheel:function(e){if(Si=!0,C<=l.currItem.fitRatio&&d.modal&&(!d.closeOnScroll||et||X?e.preventDefault():N&&Math.abs(e.deltaY)>2&&(p=!0,l.close())),gi.x=0,"deltaX"in e)1===e.deltaMode?(gi.x=18*e.deltaX,gi.y=18*e.deltaY):(gi.x=e.deltaX,gi.y=e.deltaY);else if("wheelDelta"in e)e.wheelDeltaX&&(gi.x=-.16*e.wheelDeltaX),e.wheelDeltaY?gi.y=-.16*e.wheelDeltaY:gi.y=-.16*e.wheelDelta;else{if(!("detail"in e))return;gi.y=e.detail}if(C<=l.currItem.fitRatio&&!_i)return fi+=gi.y,void(d.modal&&(!d.animatedCloseOnScroll||et||X?(e.preventDefault(),fi=0):N&&Math.abs(gi.y)>0&&!Te&&(Ei(),xi()),ui&&clearTimeout(ui),ui=setTimeout(function(){Ei(),ki()},200)));fi=0,e.stopPropagation(),je(C,!0);var t=ve.x-gi.x,i=ve.y-gi.y;(d.modal||t<=re.min.x&&t>=re.max.x&&i<=re.min.y&&i>=re.max.y)&&e.preventDefault(),l.panTo(t,i)},toggleDesktopZoom:function(e){e=e||{x:be.x/2+we.x,y:be.y/2+we.y};var t=d.getDoubleTapZoom(!0,l.currItem),o=C===t;l.mouseZoomedIn=!o,l.zoomTo(o?l.currItem.initialZoomLevel:t,e,333),s[(o?"remove":"add")+"Class"](i,"pswp--zoomed-in"),l.currItem.caption&&d.showCaption&&(o?l.caption.classList.remove("hidden"):l.caption.classList.add("hidden"))}}}),s.extend(l,at)},this.template='<div class="pswp quick-view" tabindex="-1" role="dialog" aria-hidden="true"> \t<div class="pswp__bg quick-view-background"></div> \t\x3c!-- Slides wrapper with overflow:hidden. --\x3e \t<div class="pswp__scroll-wrap"> \t\t<div class="pswp__container"> \t\t\t<div class="pswp__item"></div> \t\t\t<div class="pswp__item"></div> \t\t\t<div class="pswp__item"></div> \t\t</div> \t\t<div class="pswp__ui pswp__ui--hidden quick-view-navigation"> \t\t\t<div class="pswp__group pswp__group-prev"> \t\t\t\t<div class="pswp__button pswp__button-prev"> \t\t\t\t\t<svg version="1.1" class="left-arrow" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t\t\t\t\t\t viewBox="0 0 36 36" style="enable-background:new 0 0 36 36;" xml:space="preserve">\t\t\t\t\t\t\t<polyline class="shape-outline outer-color" points="21,29 10,18 21,7 \t"/>\t\t\t\t\t\t\t<polyline class="shape-shape inner-color"class="st1" points="21,29 10,18 21,7 \t"/>\t\t\t\t\t</svg>\t\t\t\t</div> \t\t\t</div>\t\t\t<div class="pswp__group pswp__group-next"> \t\t\t\t<div class="pswp__button pswp__button-next"> \t\t\t\t\t<svg version="1.1" class="right-arrow" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t\t\t\t\t\t viewBox="0 0 36 36" style="enable-background:new 0 0 36 36;" xml:space="preserve">\t\t\t\t\t\t\t<polyline class="shape-outline outer-color" points="21,29 10,18 21,7 \t"/>\t\t\t\t\t\t\t<polyline class="shape-shape inner-color"class="st1" points="21,29 10,18 21,7 \t"/>\t\t\t\t\t</svg>\t\t\t\t</div> \t\t\t</div> \t\t\t<div class="pswp__group pswp__group-close"> \t\t\t\t<div class="pswp__button pswp__button-close"> \t\t\t\t\t<svg class="close-button" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t\t\t\t\t\t viewBox="0 0 36 36" style="enable-background:new 0 0 36 36;" xml:space="preserve">\t\t\t\t\t\t\t<foreignObject class="shape-outline outer-color" width="36" height="36">\t\t\t\t\t\t\t\t<svg>\t\t\t\t\t\t\t\t\t<line x1="10" y1="10" x2="26" y2="26"/>\t\t\t\t\t\t\t\t\t<line x1="26" y1="10" x2="10" y2="26"/>\t\t\t\t\t\t\t    </svg>\t\t\t\t\t\t\t</foreignObject>\t\t\t\t\t\t\t<foreignObject class="shape-shape inner-color" width="36" height="36">\t\t\t\t\t\t\t\t<svg>\t\t\t\t\t\t\t\t\t<line x1="10" y1="10" x2="26" y2="26"/>\t\t\t\t\t\t\t\t\t<line x1="26" y1="10" x2="10" y2="26"/>\t\t\t\t\t\t\t    </svg>\t\t\t\t\t\t    </foreignObject>\t\t\t\t\t\t\t</svg>\t\t\t\t\t</svg>\t\t\t\t</div> \t\t\t</div>\t\t</div> \t</div><div id="freshbox" style="display: none; width: 0; height: 0;">\x3c!-- legacy support --\x3e</div> \t<div class="quick-view-caption-positioner"> \t\t<div class="quick-view-caption-wrapper"> \t\t\t<div class="quick-view-caption hidden" data-quick-view-caption><span></span></div>\t\t</div> \t</div> </div>';var i=function(){var e=document.createElement("div");for(e.innerHTML=this.template;e.childNodes.length>0;)document.body.appendChild(e.childNodes[0]);e=null}.bind(this),o=function(){};this.setEventProxy=function(e){"function"==typeof e&&(o=e)},this.isActive=!1,this.activeGallery=t,this.openImageArray=function(o,n,a){var r=function(e,t,i,o,n,a,r){var s=Math.acos,l=Math.atan,d=Math.sqrt,c=Math.PI,h={x:n,y:a},u=0,g={x:1,y:1},p={x:0,y:0},m=e*o-t*i;if(r)e?(p={x:l(i/e),y:l(t/e)},g={x:e,y:m/e}):t?(u=.5*c,g={x:t,y:m/t},p.x=l(o/t)):(g={x:i,y:o},p.x=.25*c);else if(e||t){var f=d(e*e+t*t);u=t>0?s(e/f):-s(e/f),g={x:f,y:m/f},p.x=l((e*i+t*o)/(f*f))}else if(i||o){var v=d(i*i+o*o);u=.5*c-(o>0?s(-i/v):-s(i/v)),g={x:m/v,y:v},p.y=l((e*i+t*o)/(v*v))}else g={x:0,y:0};return{scale:g,translate:h,rotation:u,skew:p}};if(o!==t&&this.activeGallery===t){var s=document.querySelectorAll(".pswp")[0];s===t&&(i(),s=document.querySelectorAll(".pswp")[0]);var l=[],d=0;if(Array.prototype.forEach.call(o,function(i){i===n&&(d=l.length);var o=!1;if(i.hasAttribute("data-caption")&&((o=document.createElement("span")).innerHTML=i.getAttribute("data-caption")),"A"===i.tagName&&i._lightboxHTML&&i._lightboxWidth&&i._lightboxHeight){var a=0,r=0,s=!1,c=!1,h=1,u=1;"string"==typeof i._lightboxWidth&&i._lightboxWidth.indexOf("%")>-1?(s=!0,a=(h=.01*parseFloat(i._lightboxWidth))*document.documentElement.clientWidth):a=i._lightboxWidth,"string"==typeof i._lightboxHeight&&i._lightboxHeight.indexOf("%")>-1?(c=!0,r=(u=.01*parseFloat(i._lightboxHeight))*e.innerHeight):r=i._lightboxHeight,l.push({html:i._lightboxHTML,src:null,msrc:null,caption:o,useViewportWidth:s,useViewportHeight:c,lightboxWidth:h,lightboxHeight:u,renderedSize:{w:r,h:r},w:a,h:r,el:i})}else{if(!i.hasAttribute("data-src")||!i.hasAttribute("width_o")&&!i.hasAttribute("width")||!i.hasAttribute("height_o")&&!i.hasAttribute("height"))return;var g=i.getAttribute("data-src");a=i.hasAttribute("width_o")?i.getAttribute("width_o"):i.getAttribute("width"),r=i.hasAttribute("height_o")?i.getAttribute("height_o"):i.getAttribute("height");i._lightboxSrc!==t&&(g=i._lightboxSrc),i._lightboxWidth!==t&&(a=i._lightboxWidth),i._lightboxHeight!==t&&(r=i._lightboxHeight),l.push({renderedSize:{w:a,h:r},caption:o,src:g,msrc:i.getAttribute("src"),w:a,h:r,el:i})}}),0==l.length)return!1;var c=this,h="middle",u="middle",g=!0,p=!0,m=!1;if(Cargo&&Cargo.Model&&(g=Cargo.Model.DisplayOptions.get("layout_options").show_quick_view_ui===t||Cargo.Model.DisplayOptions.get("layout_options").show_quick_view_ui,p=Cargo.Model.DisplayOptions.get("layout_options").close_quick_view_on_scroll===t||Cargo.Model.DisplayOptions.get("layout_options").close_quick_view_on_scroll,m=Cargo.Model.DisplayOptions.get("layout_options").quick_view_caption!==t&&Cargo.Model.DisplayOptions.get("layout_options").quick_view_caption,Cargo.Model.DisplayOptions.get("layout_options").quick_content_alignment)){var f=Cargo.Model.DisplayOptions.get("layout_options").quick_content_alignment;f.indexOf("right")>-1?u="right":f.indexOf("left")>-1&&(u="left"),f.indexOf("top")>-1?h="top":f.indexOf("bottom")>-1&&(h="bottom")}var v={index:d,maxSpreadZoom:1,getThumbBoundsFn:function(i){if(a&&a.preventAnimation)return!1;if(c.activeGallery==t)return!1;var o,n=c.activeGallery.getItemAt(i);if(n==t||n.el==t||"function"!=typeof n.el.getBoundingClientRect)return!1;if(!(o="A"===n.el.tagName?n.el.querySelector("img, video, iframe"):n.el))return!1;var s,l,d=closest(n.el,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("gallery_card")}),h=o.offsetWidth,u=o.offsetHeight,g=0,p=o.getBoundingClientRect();if(p.bottom<0||p.top>e.innerHeight)return!1;if(0===h||0===u)return!1;d?(s=e.getComputedStyle(o),l=e.getComputedStyle(d)):l=s=e.getComputedStyle(o);var m,f,v,b,_=l.getPropertyValue("transform"),y=parseFloat(s.borderTopWidth)||0,w=parseFloat(s.borderLeftWidth)||0,C=parseFloat(s.borderBottomWidth)||0,S=parseFloat(s.borderRightWidth)||0,x=(s.getPropertyValue("box-sizing"),[]),E=_.indexOf("matrix(")>-1,k=_.indexOf("matrix3d(")>-1;if(E){x=_.replace(")","").replace("matrix(","").split(",");for(var I=0;I<x.length;I++)x[I]=parseFloat(x[I]);m=r(x[0],x[1],x[2],x[3],x[4],x[5],!1)}else if(k){x=_.replace(")","").replace("matrix3d(","").split(",");for(I=0;I<x.length;I++)x[I]=parseFloat(x[I]);m=r(x[0],x[1],x[4],x[5],x[12],x[13],!1)}else m={rotation:0,scale:{x:1,y:1},skew:{x:0,y:0},translate:{x:0,y:0}};var T=0,A=closest(n.el,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("allow-scroll")});if(A&&(T=A.scrollTop),d){d.classList.contains("slick-slide")&&(d=d.querySelector(".gallery_card_image"));var M=closest(d,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("image-gallery")}),P=d.getBoundingClientRect(),O=M.getBoundingClientRect();if(P.left+P.width<O.left||O.left+O.width<P.left)return!1;b=d.offsetParent.getBoundingClientRect(),f=d.offsetLeft+b.left,v=d.offsetTop+b.top,d.offsetParent!==A&&(T=0);var L=d.querySelector(".gallery_image_caption");if(L){var N=e.getComputedStyle(L);g="none"===N.getPropertyValue("display")||"absolute"===N.getPropertyValue("position")||"fixed"===N.getPropertyValue("position")?0:"content-box"===N.getPropertyValue("box-sizing")?parseFloat(N.getPropertyValue("height"))+parseFloat(N.getPropertyValue("margin-top"))+parseFloat(N.getPropertyValue("margin-bottom"))+parseFloat(N.getPropertyValue("padding-top"))+parseFloat(N.getPropertyValue("padding-bottom")):parseFloat(N.getPropertyValue("height"))+parseFloat(N.getPropertyValue("margin-top"))+parseFloat(N.getPropertyValue("margin-bottom"))}var D=g*Math.sin(m.rotation),R=g*Math.cos(m.rotation);f+=.5*(d.offsetWidth+D-h),v=v+.5*(d.offsetHeight-R-u)+-T}else{var H=0,V=0;if(o.offsetParent){var $=e.getComputedStyle(o.offsetParent);H=parseFloat($.borderTopWidth)||0,V=parseFloat($.borderLeftWidth)||0,b=o.offsetParent.getBoundingClientRect()}else b={left:0,top:0};o.offsetParent!==A&&(T=0),f=o.offsetLeft+b.left+V,v=o.offsetTop+b.top+H+-T}var G=(f+=w)+.5*(h+=-(w+S)),F=(v+=y)+.5*(u+=-(y+C)),z=f-G,B=v-F,q=z*Math.cos(m.rotation)-B*Math.sin(m.rotation)+G,W=z*Math.sin(m.rotation)+B*Math.cos(m.rotation)+F,j=Math.min(h*m.scale.x/n.w,u*m.scale.y/n.h),U=j*n.w,K=j*n.h,Y={x:q+m.translate.x,y:W+m.translate.y,w:h*m.scale.x,h:u*m.scale.y,transform:m,innerX:U,innerY:K};return n.thumbRect=Y,Y},closeEl:!0,arrowEl:l.length>1,tapToClose:!0,closeOnScroll:!1,alignHorizontal:u,alignVertical:h,useControls:g,animatedCloseOnScroll:p,showCaption:m},b=!1,y=!1,w=function(){y=!0},C=function(){y=!1};if(e.addEventListener("touchend",C),e.addEventListener("touchstart",w),a!==t&&"object"==typeof a){for(var S in a)a.hasOwnProperty(S)&&(v[S]=a[S]);!0===a.disableZoom&&(b=!0,v.zoomEl=!1,v.getDoubleTapZoom=function(e,t){return t.initialZoomLevel},v.pinchToClose=!1)}if(this.activeGallery=new this.PhotoSwipe(s,this.PhotoSwipeUI_Default,l,v),b?s.classList.add("pswp--zoom-disabled"):s.classList.remove("pswp--zoom-disabled"),this.activeGallery.init(),this.isActive=!0,this.activeGallery.imageArray=o,this.activeGallery.listen("destroy",function(){null!==s.parentNode?y?Cargo.Event.once("lightbox-scroll-finished",function(){s.parentNode.removeChild(s),e.removeEventListener("touchend",C),e.removeEventListener("touchstart",w)}):(s.parentNode.removeChild(s),e.removeEventListener("touchend",C),e.removeEventListener("touchstart",w)):(e.removeEventListener("touchend",C),e.removeEventListener("touchstart",w)),c.isActive=!1,c.activeGallery=t}),Cargo.Helper&&Cargo.Helper.IsAdminEdit()){var x=function(e){"Content"!==e&&"Commerce"!==e&&"newDomain"!==e&&"EditProject"!==e||c.activeGallery.close()},E=_.throttle(function(){c&&c.activeGallery&&c.activeGallery.updateSize(!0)},200);parent.Cargo.Event.on("route",x),Cargo.Event.on("inspector_style_changed",E),this.activeGallery.listen("destroy",function(){parent.Cargo.Event.off("route",x),Cargo.Event.off("inspector_style_changed",E)})}return this.activeGallery}},function(t,i){t.PhotoSwipeUI_Default=function(){return function(t,i){var o,n,a,r,s,l,d,c,h,u=this,g=!1,p=!0,m={closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:1500,timeToIdleOutside:1500,closeEl:!0,fullscreenEl:!0,zoomEl:!0,counterEl:!0,arrowEl:!0,tapToClose:!1,tapToToggleControls:!0,useControls:!0,clickToCloseNonZoomable:!0,fitControlsWidth:1200},f=function(t){if(d)return!0;t=t||e.event,l.timeToIdle&&l.mouseUsed&&!r&&w();for(var o=t.target||t.srcElement;"svg"===o.nodeName||"path"===o.nodeName||"polyline"===o.nodeName||"g"===o.nodeName||"foreignObject"===o.nodeName||"line"===o.nodeName;)o=o.parentNode;for(var n,a,s=o.getAttribute("class")||"",c=0;c<x.length;c++)(n=x[c]).onTap&&s.indexOf("pswp__"+n.name)>-1&&(n.onTap(),a=!0);if(a){t.stopPropagation&&t.stopPropagation(),d=!0;var h=i.features.isOldAndroid?600:30;setTimeout(function(){d=!1},h)}},v=function(e,t,o){i[(o?"add":"remove")+"Class"](e,"pswp__"+t)},b=function(e){for(var t=0;t<l.closeElClasses.length;t++)if(i.hasClass(e,"pswp__"+l.closeElClasses[t]))return!0},_=0,y=!1,w=function(e){if(e){var t=closest(e.target,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("left-arrow")||e.classList.contains("right-arrow")||e.classList.contains("close-button")});y=!!t}clearTimeout(h),_=0,r&&u.setIdle(!1)},C=function(t){var i=(t=t||e.event).relatedTarget||t.toElement;i&&"HTML"!==i.nodeName||(clearTimeout(h),h=setTimeout(function(){u.setIdle(!0)},l.timeToIdleOutside))},S=function(){l.timeToIdle&&s("mouseUsed",function(){i.bind(document,"mousemove",w),i.bind(document,"mouseout",C),c=setInterval(function(){2===++_&&u.setIdle(!0)},l.timeToIdle/2)})},x=[{name:"button--zoom",option:"zoomEl",onTap:t.toggleDesktopZoom},{name:"button-close",option:"closeEl",onTap:t.close},{name:"button-prev",option:"arrowEl",onTap:t.prev},{name:"button-next",option:"arrowEl",onTap:t.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){o.isFullscreen()?o.exit():o.enter()}}];u.init=function(){var e;i.extend(t.options,m,!0),l=t.options,n=i.getChildByClass(t.scrollWrap,"pswp__ui"),(s=t.listen)("onVerticalDrag",function(e){p&&e<.95?u.hideControls():!p&&e>=.95&&u.showControls()}),s("onPinchClose",function(t){p&&t<.9?(u.hideControls(),e=!0):e&&!p&&t>.9&&u.showControls()}),s("zoomGestureEnded",function(){(e=!1)&&!p&&u.showControls()}),s("beforeChange",u.update),s("doubleTap",function(e){var i=t.currItem.initialZoomLevel;t.getZoomLevel()!==i?t.zoomTo(i,e,333):t.zoomTo(l.getDoubleTapZoom(!1,t.currItem),e,333)}),s("preventDragEvent",function(e,t,i){var o=e.target||e.srcElement;o&&o.getAttribute("class")&&e.type.indexOf("mouse")>-1&&(o.getAttribute("class").indexOf("__caption")>0||/(SMALL|STRONG|EM)/i.test(o.tagName))&&(i.prevent=!1)}),s("bindEvents",function(){u.bindEvents()}),s("unbindEvents",function(){u.unbindEvents()}),s("destroy",function(){l.captionEl&&(_fakeCaptionContainer&&n.removeChild(_fakeCaptionContainer),i.removeClass(_captionContainer,"pswp__caption--empty")),i.removeClass(n,"pswp__ui--over-close"),i.addClass(n,"pswp__ui--hidden"),u.setIdle(!1)}),!l.showAnimationDuration&&l.useControls&&i.removeClass(n,"pswp__ui--hidden"),s("initialZoomInEnd",function(){l.showAnimationDuration&&l.useControls&&i.removeClass(n,"pswp__ui--hidden")}),s("initialZoomOut",function(){i.addClass(n,"pswp__ui--hidden")}),function(){var e,t,o,a=function(n){if(n){for(var a=n.length,r=[],s=0;s<a;s++){e=n[s],t=e.className;for(var d=0;d<x.length;d++)o=x[d],t.indexOf("pswp__"+o.name)>-1&&(l[o.option]?(i.removeClass(e,"pswp__element--disabled"),r.push(e),o.onInit&&o.onInit(e)):i.addClass(e,"pswp__element--disabled"))}r.length}};a(n.children);for(var r=n.querySelectorAll(".pswp__group"),s=0;s<r.length;s++)a(r[s].children)}(),S(),clearTimeout(h),h=setTimeout(function(){u.setIdle(!0)},l.timeToIdleOutside),u.bindEvents(),l.fullscreenEl&&!i.features.isOldAndroid&&(o||(o=u.getFullscreenAPI()),o?(i.bind(document,o.eventK,u.updateFullscreen),u.updateFullscreen(),i.addClass(t.template,"pswp--supports-fs")):i.removeClass(t.template,"pswp--supports-fs"))},u.unbindEvents=function(){c&&clearInterval(c),i.unbind(document,"mouseout",C),i.unbind(document,"mousemove",w),i.unbind(n,"pswpTap click",f),i.unbind(t.scrollWrap,"pswpTap",u.onGlobalTap),i.unbind(t.scrollWrap,"mouseover",u.onMouseOver),o&&(i.unbind(document,o.eventK,u.updateFullscreen),o.isFullscreen()&&(l.hideAnimationDuration=0,o.exit()),o=null)},u.setupIdle=function(){S()},u.bindEvents=function(){l.useControls&&i.bind(n,"pswpTap click",f),i.bind(t.scrollWrap,"pswpTap",u.onGlobalTap),t.likelyTouchDevice||i.bind(t.scrollWrap,"mouseover",u.onMouseOver)},u.setIdle=function(e){y||(r=e,v(n,"ui--idle",e))},u.update=function(){g=!(!p||!t.currItem)},u.updateFullscreen=function(e){e&&setTimeout(function(){t.setScrollOffset(0,i.getScrollY())},50),i[(o.isFullscreen()?"add":"remove")+"Class"](t.template,"pswp--fs")},u.onGlobalTap=function(o){var n=(o=o||e.event).target||o.srcElement;if(!d)if(o.detail&&"mouse"===o.detail.pointerType){if(b(n))return void t.close();if(i.hasClass(n,"pswp__img")){if(l.disableZoom)return void t.close();if(1===t.getZoomLevel()&&t.getZoomLevel()<=t.currItem.fitRatio){if(l.clickToCloseNonZoomable)return void t.close()}else t.toggleDesktopZoom(o.detail.releasePoint)}}else if(l.tapToToggleControls&&(p?u.hideControls():u.showControls()),l.tapToClose&&(i.hasClass(n,"pswp__img")||b(n)))return void t.close()},u.onMouseOver=function(t){var i=(t=t||e.event).target||t.srcElement;v(n,"ui--over-close",b(i))},u.hideControls=function(){i.addClass(n,"pswp__ui--hidden"),l.useControls||i.addClass(n,"pswp__ui--displaynone"),p=!1},u.showControls=function(){l.useControls&&(p=!0,g||u.update(),i.removeClass(n,"pswp__ui--displaynone"),i.removeClass(n,"pswp__ui--hidden"))},u.toggleFullscreen=function(){o.isFullscreen()?o.exit():o.enter()},u.supportsFullscreen=function(){var e=document;return!!(e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen)},u.getFullscreenAPI=function(){var e,i=document.documentElement,o="fullscreenchange";return i.requestFullscreen?e={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:o}:i.mozRequestFullScreen?e={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+o}:i.webkitRequestFullscreen?e={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+o}:i.msRequestFullscreen&&(e={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}),e&&(e.enter=function(){if(a=l.closeOnScroll,l.closeOnScroll=!1,"webkitRequestFullscreen"!==this.enterK)return t.template[this.enterK]();t.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)},e.exit=function(){return l.closeOnScroll=a,document[this.exitK]()},e.isFullscreen=function(){return document[this.elementK]}),e}}}()}(this)}.call(window.lightbox={},window),function(){"use strict";new MobileAdjustments,window.baseUnit=new BaseUnit,Cargo.Event.on("element_resizer_init",function(e){e.setOptions({cargo_refreshEvents:["inline-editor-load-complete","inspector_preview","page_collection_reset","direct_link_loaded","mobile_padding_set"],generic_refreshEvents:[],updateEvents:["resize","orientationchange"],forceVerticalMargin:0,forceMobileImagesFullWidth:Cargo.Model.DisplayOptions.get("layout_options").mobile_images_full_width,adjustElementsToWindowHeight:Cargo.Model.DisplayOptions.get("layout_options").limit_vertical_images,scrollTransitionThreshold:-100,scrollTransition:Cargo.Model.DisplayOptions.get("layout_options").scroll_transition})})}(),function(global,setTimeout){function commentReplace(e,t){return t||""}function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){var i;if(e)for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}function eachReverse(e,t){var i;if(e)for(i=e.length-1;i>-1&&(!e[i]||!t(e[i],i,e));i-=1);}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var i;for(i in e)if(hasProp(e,i)&&t(e[i],i))break}function mixin(e,t,i,o){return t&&eachProp(t,function(t,n){!i&&hasProp(e,n)||(!o||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[n]=t:(e[n]||(e[n]={}),mixin(e[n],t,i,o)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,i,o){var n=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return n.requireType=e,n.requireModules=o,i&&(n.originalError=i),n}function newContext(e){function t(e,t,i){var o,n,a,r,s,l,d,c,h,u,g=t&&t.split("/"),p=w.map,m=p&&p["*"];if(e&&(l=(e=e.split("/")).length-1,w.nodeIdCompat&&jsSuffixRegExp.test(e[l])&&(e[l]=e[l].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&g&&(e=g.slice(0,g.length-1).concat(e)),function(e){var t,i;for(t=0;t<e.length;t++)if("."===(i=e[t]))e.splice(t,1),t-=1;else if(".."===i){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}(e),e=e.join("/")),i&&p&&(g||m)){e:for(a=(n=e.split("/")).length;a>0;a-=1){if(s=n.slice(0,a).join("/"),g)for(r=g.length;r>0;r-=1)if((o=getOwn(p,g.slice(0,r).join("/")))&&(o=getOwn(o,s))){d=o,c=a;break e}!h&&m&&getOwn(m,s)&&(h=getOwn(m,s),u=a)}!d&&h&&(d=h,c=u),d&&(n.splice(0,c,d),e=n.join("/"))}return getOwn(w.pkgs,e)||e}function i(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===b.contextName)return t.parentNode.removeChild(t),!0})}function o(e){var t=getOwn(w.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),b.require.undef(e),b.makeRequire(null,{skipMap:!0})([e]),!0}function n(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function a(e,i,o,a){var r,s,l,d,c=null,h=i?i.name:null,u=e,g=!0,p="";return e||(g=!1,e="_@r"+(A+=1)),c=(d=n(e))[0],e=d[1],c&&(c=t(c,h,a),s=getOwn(k,c)),e&&(c?p=s&&s.normalize?s.normalize(e,function(e){return t(e,h,a)}):-1===e.indexOf("!")?t(e,h,a):e:(c=(d=n(p=t(e,h,a)))[0],p=d[1],o=!0,r=b.nameToUrl(p))),{prefix:c,name:p,parentMap:i,unnormalized:!!(l=!c||s||o?"":"_unnormalized"+(M+=1)),url:r,originalName:u,isDefine:g,id:(c?c+"!"+p:p)+l}}function r(e){var t=e.id,i=getOwn(C,t);return i||(i=C[t]=new b.Module(e)),i}function s(e,t,i){var o=e.id,n=getOwn(C,o);!hasProp(k,o)||n&&!n.defineEmitComplete?(n=r(e)).error&&"error"===t?i(n.error):n.on(t,i):"defined"===t&&i(k[o])}function l(e,t){var i=e.requireModules,o=!1;t?t(e):(each(i,function(t){var i=getOwn(C,t);i&&(i.error=e,i.events.error&&(o=!0,i.emit("error",e)))}),o||req.onError(e))}function d(){globalDefQueue.length&&(each(globalDefQueue,function(e){var t=e[0];"string"==typeof t&&(b.defQueueMap[t]=!0),E.push(e)}),globalDefQueue=[])}function c(e){delete C[e],delete S[e]}function h(){var e,t,n=1e3*w.waitSeconds,a=n&&b.startTime+n<(new Date).getTime(),r=[],s=[],d=!1,c=!0;if(!f){if(f=!0,eachProp(S,function(e){var n=e.map,l=n.id;if(e.enabled&&(n.isDefine||s.push(e),!e.error))if(!e.inited&&a)o(l)?(t=!0,d=!0):(r.push(l),i(l));else if(!e.inited&&e.fetched&&n.isDefine&&(d=!0,!n.prefix))return c=!1}),a&&r.length)return(e=makeError("timeout","Load timeout for modules: "+r,null,r)).contextName=b.contextName,l(e);c&&each(s,function(e){!function e(t,i,o){var n=t.map.id;t.error?t.emit("error",t.error):(i[n]=!0,each(t.depMaps,function(n,a){var r=n.id,s=getOwn(C,r);!s||t.depMatched[a]||o[r]||(getOwn(i,r)?(t.defineDep(a,k[r]),t.check()):e(s,i,o))}),o[n]=!0)}(e,{},{})}),a&&!t||!d||!isBrowser&&!isWebWorker||y||(y=setTimeout(function(){y=0,h()},50)),f=!1}}function u(e){hasProp(k,e[0])||r(a(e[0],null,!0)).init(e[1],e[2])}function g(e,t,i,o){e.detachEvent&&!isOpera?o&&e.detachEvent(o,t):e.removeEventListener(i,t,!1)}function p(e){var t=e.currentTarget||e.srcElement;return g(t,b.onScriptLoad,"load","onreadystatechange"),g(t,b.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function m(){var e;for(d();E.length;){if(null===(e=E.shift())[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));u(e)}b.defQueueMap={}}var f,v,b,_,y,w={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},C={},S={},x={},E=[],k={},I={},T={},A=1,M=1;return _={require:function(e){return e.require?e.require:e.require=b.makeRequire(e.map)},exports:function(e){if(e.usingExports=!0,e.map.isDefine)return e.exports?k[e.map.id]=e.exports:e.exports=k[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(w.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},(v=function(e){this.events=getOwn(x,e.id)||{},this.map=e,this.shim=getOwn(w.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0}).prototype={init:function(e,t,i,o){o=o||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=o.ignore,o.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,b.startTime=(new Date).getTime();var e=this.map;return this.shim?void b.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;I[e]||(I[e]=!0,b.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id,o=this.depExports,n=this.exports,a=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(a)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{n=b.execCb(i,a,o,n)}catch(t){e=t}else n=b.execCb(i,a,o,n);if(this.map.isDefine&&void 0===n&&((t=this.module)?n=t.exports:this.usingExports&&(n=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",l(this.error=e)}else n=a;if(this.exports=n,this.map.isDefine&&!this.ignore&&(k[i]=n,req.onResourceLoad)){var r=[];each(this.depMaps,function(e){r.push(e.normalizedMap||e)}),req.onResourceLoad(b,this.map,r)}c(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(b.defQueueMap,i)||this.fetch()}},callPlugin:function(){var e=this.map,i=e.id,o=a(e.prefix);this.depMaps.push(o),s(o,"defined",bind(this,function(o){var n,d,h,u=getOwn(T,this.map.id),g=this.map.name,p=this.map.parentMap?this.map.parentMap.name:null,m=b.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(o.normalize&&(g=o.normalize(g,function(e){return t(e,p,!0)})||""),s(d=a(e.prefix+"!"+g,this.map.parentMap),"defined",bind(this,function(e){this.map.normalizedMap=d,this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),void((h=getOwn(C,d.id))&&(this.depMaps.push(d),this.events.error&&h.on("error",bind(this,function(e){this.emit("error",e)})),h.enable()))):u?(this.map.url=b.nameToUrl(u),void this.load()):((n=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})})).error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[i],eachProp(C,function(e){0===e.map.id.indexOf(i+"_unnormalized")&&c(e.map.id)}),l(e)}),n.fromText=bind(this,function(t,o){var s=e.name,d=a(s),c=useInteractive;o&&(t=o),c&&(useInteractive=!1),r(d),hasProp(w.config,i)&&(w.config[s]=w.config[i]);try{req.exec(t)}catch(e){return l(makeError("fromtexteval","fromText eval for "+i+" failed: "+e,e,[i]))}c&&(useInteractive=!0),this.depMaps.push(d),b.completeLoad(s),m([s],n)}),void o.load(e.name,m,n,w))})),b.enable(o,this),this.pluginMaps[o.id]=o},enable:function(){S[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var i,o,n;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,n=getOwn(_,e.id))return void(this.depExports[t]=n(this));this.depCount+=1,s(e,"defined",bind(this,function(e){this.undefed||(this.defineDep(t,e),this.check())})),this.errback?s(e,"error",bind(this,this.errback)):this.events.error&&s(e,"error",bind(this,function(e){this.emit("error",e)}))}i=e.id,o=C[i],hasProp(_,i)||!o||o.enabled||b.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(C,e.id);t&&!t.enabled&&b.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},(b={config:w,contextName:e,registry:C,defined:k,urlFetched:I,defQueue:E,defQueueMap:{},Module:v,makeModuleMap:a,nextTick:req.nextTick,onError:l,configure:function(e){if(e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/"),"string"==typeof e.urlArgs){var t=e.urlArgs;e.urlArgs=function(e,i){return(-1===i.indexOf("?")?"?":"&")+t}}var i=w.shim,o={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){o[t]?(w[t]||(w[t]={}),mixin(w[t],e,!0,!0)):w[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(T[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=b.makeShimExports(e)),i[t]=e}),w.shim=i),e.packages&&each(e.packages,function(e){var t;t=(e="string"==typeof e?{name:e}:e).name,e.location&&(w.paths[t]=e.location),w.pkgs[t]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(C,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t,null,!0))}),(e.deps||e.callback)&&b.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}},makeRequire:function(o,n){function s(t,i,d){var c,u;return n.enableBuildCallback&&i&&isFunction(i)&&(i.__requireJsBuild=!0),"string"==typeof t?isFunction(i)?l(makeError("requireargs","Invalid require call"),d):o&&hasProp(_,t)?_[t](C[o.id]):req.get?req.get(b,t,o,s):(c=a(t,o,!1,!0).id,hasProp(k,c)?k[c]:l(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+e+(o?"":". Use require([])")))):(m(),b.nextTick(function(){m(),(u=r(a(null,o))).skipMap=n.skipMap,u.init(t,i,d,{enabled:!0}),h()}),s)}return n=n||{},mixin(s,{isBrowser:isBrowser,toUrl:function(e){var i,n=e.lastIndexOf("."),a=e.split("/")[0];return-1!==n&&(!("."===a||".."===a)||n>1)&&(i=e.substring(n,e.length),e=e.substring(0,n)),b.nameToUrl(t(e,o&&o.id,!0),i,!0)},defined:function(e){return hasProp(k,a(e,o,!1,!0).id)},specified:function(e){return e=a(e,o,!1,!0).id,hasProp(k,e)||hasProp(C,e)}}),o||(s.undef=function(e){d();var t=a(e,o,!0),n=getOwn(C,e);n.undefed=!0,i(e),delete k[e],delete I[t.url],delete x[e],eachReverse(E,function(t,i){t[0]===e&&E.splice(i,1)}),delete b.defQueueMap[e],n&&(n.events.defined&&(x[e]=n.events),c(e))}),s},enable:function(e){getOwn(C,e.id)&&r(e).enable()},completeLoad:function(e){var t,i,n,a=getOwn(w.shim,e)||{},r=a.exports;for(d();E.length;){if(null===(i=E.shift())[0]){if(i[0]=e,t)break;t=!0}else i[0]===e&&(t=!0);u(i)}if(b.defQueueMap={},n=getOwn(C,e),!t&&!hasProp(k,e)&&n&&!n.inited){if(!(!w.enforceDefine||r&&getGlobal(r)))return o(e)?void 0:l(makeError("nodefine","No define call for "+e,null,[e]));u([e,a.deps||[],a.exportsFn])}h()},nameToUrl:function(e,t,i){var o,n,a,r,s,l,d=getOwn(w.pkgs,e);if(d&&(e=d),l=getOwn(T,e))return b.nameToUrl(l,t,i);if(req.jsExtRegExp.test(e))r=e+(t||"");else{for(o=w.paths,a=(n=e.split("/")).length;a>0;a-=1)if(s=getOwn(o,n.slice(0,a).join("/"))){isArray(s)&&(s=s[0]),n.splice(0,a,s);break}r=n.join("/"),r=("/"===(r+=t||(/^data\:|^blob\:|\?/.test(r)||i?"":".js")).charAt(0)||r.match(/^[\w\+\.\-]+:/)?"":w.baseUrl)+r}return w.urlArgs&&!/^blob\:/.test(r)?r+w.urlArgs(e,r):r},load:function(e,t){req.load(b,e,t)},execCb:function(e,t,i,o){return t.apply(o,i)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=p(e);b.completeLoad(t.id)}},onScriptError:function(e){var t=p(e);if(!o(t.id)){var i=[];return eachProp(C,function(e,o){0!==o.indexOf("_@r")&&each(e.depMaps,function(e){if(e.id===t.id)return i.push(o),!0})}),l(makeError("scripterror",'Script error for "'+t.id+(i.length?'", needed by: '+i.join(", "):'"'),e,[t.id]))}}}).require=b.makeRequire(),b}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){if("interactive"===e.readyState)return interactiveScript=e}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.2",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,i,o){var n,a,r=defContextName;return isArray(e)||"string"==typeof e||(a=e,isArray(t)?(e=t,t=i,i=o):e=[]),a&&a.context&&(r=a.context),(n=getOwn(contexts,r))||(n=contexts[r]=req.s.newContext(r)),a&&n.configure(a),n.require(e,t,i)},req.config=function(e){return req(e)},req.nextTick=void 0!==setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,i){var o=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return o.type=e.scriptType||"text/javascript",o.charset="utf-8",o.async=!0,o},req.load=function(e,t,i){var o,n=e&&e.config||{};if(isBrowser)return(o=req.createNode(n,t,i)).setAttribute("data-requirecontext",e.contextName),o.setAttribute("data-requiremodule",t),!o.attachEvent||o.attachEvent.toString&&o.attachEvent.toString().indexOf("[native code")<0||isOpera?(o.addEventListener("load",e.onScriptLoad,!1),o.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,o.attachEvent("onreadystatechange",e.onScriptLoad)),o.src=i,n.onNodeCreated&&n.onNodeCreated(o,n,t,i),currentlyAddingScript=o,baseElement?head.insertBefore(o,baseElement):head.appendChild(o),currentlyAddingScript=null,o;if(isWebWorker)try{setTimeout(function(){},0),importScripts(i),e.completeLoad(t)}catch(o){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+i,o,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){if(head||(head=e.parentNode),dataMain=e.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||-1!==mainScript.indexOf("!")||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(e,t,i){var o,n;"string"!=typeof e&&(i=t,t=e,e=null),isArray(t)||(i=t,t=null),!t&&isFunction(i)&&(t=[],i.length&&(i.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&((o=currentlyAddingScript||getInteractiveScript())&&(e||(e=o.getAttribute("data-requiremodule")),n=contexts[o.getAttribute("data-requirecontext")])),n?(n.defQueue.push([e,t,i]),n.defQueueMap[e]=!0):globalDefQueue.push([e,t,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this,"undefined"==typeof setTimeout?void 0:setTimeout);