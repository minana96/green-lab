if(void 0!==window.Convertful)throw"Canceled reinitialization!";window.Convertful={},function(){"use strict";if(window.cQuery)return!1;var e=window.cQuery=function(t,n){if(t instanceof e)return t;if("string"==typeof t&&"<"===t[0]&&">"===t.substr(-1)&&t.length>=3)return e.$tmp.html(t).children().detach();if("function"==typeof t)return t=t.bind(window,e),e.isReady?t():s.push(t);if(!(this instanceof e))return new e(t,n);if(this.elms=[],void 0===t)return this;if((t instanceof Node||t===window)&&this.elms.push(t),"string"==typeof t){n=void 0===n?document:n;var i=function(e){if(e.querySelectorAll&&t)for(var n=e.querySelectorAll(t),i=0;i<n.length;i++)this.elms.push(n[i])}.bind(this);n instanceof e?n.each(i):i(n)}return this};e.fn=e.prototype,e.fn.each=function(e){return this.elms.forEach(function(t,n){e.call(t,t,n)}),this},e.each=function(t,n){var i=function(e,t){n(t,e)};if(t instanceof Array)t.forEach(i);else if(t instanceof e)t.each(i);else for(var o in t)t.hasOwnProperty(o)&&n(o,t[o])},e.eachCSS=function(t,n){t instanceof Array?t.forEach(function(e){n.apply(void 0,e)}):e.each(t,n)},e.fn.map=function(e){return this.elms.map(function(t,n,i){return e.call(n,t,i)})},e.fn.hasClass=function(e){for(var t=new RegExp("(^| )"+e+"((?= )|$)","g"),n=0;n<this.elms.length;n++)if(this.elms[n].className.match(t))return!0;return!1},e.fn.addClass=function(e){var t=new RegExp("(^| )"+e+"((?= )|$)","g");return this.each(function(){this.className.match(t)||(this.className+=" "+e)})},e.fn.removeClass=function(e){var t=new RegExp("(^| )"+e+"((?= )|$)","g");return this.each(function(){this.className=this.className.replace(t,"$1$2").trim()})},e.fn.mod=function(e,t){if(0===this.elms.length)return this;var n,i=new RegExp("(^| )"+e+"_([a-zA-Z0-9_-]+)((?= )|$)","g");return!1===t?this.each(function(){this.className=this.className.replace(i,"$3")}):void 0===t?!!(n=i.exec(this.elms[0].className))&&n[2]:this.each(function(){this.className.match(i)?this.className=this.className.replace(i,"$1"+e+"_"+t+"$3"):this.className+=" "+e+"_"+t})};var t=function(e,t){return void 0===t||(e.matches||e.matchesSelector||e.msMatchesSelector||e.oMatchesSelector).call(e,t)};e.fn.is=function(e){for(var n=0;n<this.elms.length;n++)if(t(this.elms[n],e))return!0;return!1},e.fn.find=function(t){return e(t,this)},e.fn.filter=function(n){var i=e();return this.each(function(){t(this,n)&&i.elms.push(this)}),i},e.fn.first=function(){return e(this.elms[0])},e.fn.closest=function(n){var i=e();return this.each(function(e){for(;e.parentNode;e=e.parentNode)if(t(e,n)){i.elms.push(e);break}}),i},e.fn.parent=function(n){var i=e();return this.each(function(){t(this.parentNode,n)&&i.elms.push(this.parentNode)}),i},e.fn.children=function(n){var i=e();return this.each(function(){for(var e=0;e<this.children.length;e++)t(this.children[e],n)&&i.elms.push(this.children[e])}),i},e.fn.attr=function(e,t){return void 0===t?this.elms.length?this.elms[0].getAttribute(e):null:this.each(function(){this.setAttribute(e,t)})},e.fn.css=function(t){return 2===arguments.length&&(t=[arguments]),"string"==typeof t?this.elms.length?this.elms[0].style[t]:null:this.each(function(n){var i="";e.eachCSS(t,function(e,t){e=e.replace(/[A-Z][a-z]*/g,e=>"-"+e.toLowerCase()).replace("--","-").replace(/(^-)|(-$)/g,""),Number(t)==t&&(t+="px"),i+=e+":"+t+";"}),n.style.cssText+=";"+i})},e.fn.eraseCSS=function(e){return this.each(function(){for(var t=0;t<e.length;t++)this.style[e[t]]=null})},e.fn.data=function(e,t){if(void 0===t){if(!this.elms.length)return;if(void 0===e){if(this.elms[0].$$oqData)return this.elms[0].$$oqData;if(this.elms[0].$$oqData={},!this.elms[0].hasAttributes())return{};var n;for(var i in this.elms[0].attributes)if(this.elms[0].attributes.hasOwnProperty(i)){if("data-"!==(n=this.elms[0].attributes[i]).name.slice(0,5))continue;var o;try{o=JSON.parse(n.value)}catch(e){o=n.value}this.elms[0].$$oqData[n.name.substr(5)]=o}return this.elms[0].$$oqData}return this.elms[0].$$oqData&&this.elms[0].$$oqData[e]||this.attr("data-"+e)}return this.each(function(){this.$$oqData||(this.$$oqData={}),null===t?delete this.$$oqData[e]:this.$$oqData[e]=t})},e.fn.val=function(e){return void 0===e?this.elms.length?this.elms[0].value:null:this.each(function(){this.value=e})},e.fn.height=function(e){return void 0===e?this.elms.length?this.elms[0].offsetHeight:0:this.css({height:e})},e.fn.html=function(e){return void 0===e?this.elms.length?this.elms[0].innerHTML:null:this.each(function(t){t.innerHTML=e})},e.fn.text=function(){var e="";return this.each(function(t){e+=t.textContent||t.innerText||""}),e},e.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})},e.fn.remove=function(){this.find("*").each(function(){delete this.$$oqEvents}),this.html("").each(function(){delete this.$$oqEvents}).detach(),this.elms=[]},e.fn.eachEach=function(e,t){return this.each(function(n){e.each(function(e){t(n,e)})})};var n=function(t){return function(n){return e(n)[t](this),this}};e.fn.append=function(t){return this.eachEach(e(t),function(e,t){e.appendChild(t)})},e.fn.appendTo=n("append"),e.fn.prepend=function(t){return this.eachEach(e(t),function(e,t){e.insertBefore(t,e.firstChild)})},e.fn.prependTo=n("prepend"),e.fn.before=function(t){return this.eachEach(e(t),function(e,t){e.parentNode.insertBefore(t,e)})},e.fn.insertBefore=n("before"),e.fn.after=function(t){return this.eachEach(e(t),function(e,t){e.parentNode.insertBefore(t,e),e.parentNode.insertBefore(e,t)})},e.fn.insertAfter=n("after"),e.fn.replace=function(t){e(t).before(this).remove()},e.fn.on=function(n,i){var o=3===arguments.length&&"string"==typeof i?i:null;return o&&(i=arguments[2]),this.each(function(s){var r=o?function(e){for(var n=e.target;n.parentNode;n=n.parentNode)if(t(n,o))return i.call(n,e)}:i.bind(s);e.each(n.split(" "),function(e,t){var n=(o?o+":":"")+t;s.$$oqEvents||(s.$$oqEvents={}),s.$$oqEvents[n]||(s.$$oqEvents[n]=[]),s.$$oqEvents[n].push([i,r]),s.addEventListener(t,r)})})},e.fn.off=function(t,n){var i=3===arguments.length&&"string"==typeof n?n:null;return i&&(n=arguments[2]),this.each(function(o){e.each(t.split(" "),function(e,t){var s=(i?i+":":"")+t;o.$$oqEvents&&o.$$oqEvents[s]&&(o.$$oqEvents[s]=o.$$oqEvents[s].filter(function(e){return e[0]!==n||o.removeEventListener(t,e[1])&&!1}),o.$$oqEvents[s].length||delete o.$$oqEvents[s])})})},e.fn.one=function(e,t){var n=function(i){t.call(this,i),this.off(e,n)}.bind(this);return this.on(e,n)},e.fn.trigger=function(e){return this.each(function(){this.dispatchEvent(new Event(e))})};var i,o,s=[];if(e.ready=function(){e.isReady=!0,s.forEach(function(e){e()})},"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll)setTimeout(e.ready);else{var r=function(){document.removeEventListener("DOMContentLoaded",r),window.removeEventListener("load",r),e.ready()};document.addEventListener("DOMContentLoaded",r),window.addEventListener("load",r)}i=window.history,o=i.pushState,i.pushState=function(e){return"function"==typeof i.onpushstate&&window.Convertful&&window.Convertful.requestAnimationFrame(function(){i.onpushstate({state:e})}),o.apply(i,arguments)},e.fn.animate=function(t,n,i,o,s){n=n||250,i=i||"ease-in-out",s=s||25;var r="";return e.eachCSS(t,function(e){r+=(r?", ":"")+e+" "+n+"ms "+i}),this.stop().css({transition:r,"-webkit-transition":r}).data("$animationStart",setTimeout(function(){this.css(t)}.bind(this),s)).data("$animationEnd",setTimeout(function(){this.stop(),o instanceof Function&&o.call(this)}.bind(this),s+n))},e.fn.stop=function(){return this.each(function(){var t=e(this);["$animationStart","$animationStop"].forEach(function(e){clearTimeout(t.data(e)),t.data(e,null)})}).eraseCSS(["transition","-webkit-transition"])},e.fn.scrollTo=e.scrollTo=function(t,n,i){if(n<=0)i instanceof Function&&i.call(this);else{var o=this.hasOwnProperty("elms")?this.elms[0]:window;setTimeout(function(){o.scroll(0,o.pageYOffset+(t-o.pageYOffset)/n*10),e.scrollTo(t,n-10,i)},10)}};var a=function(t,n){var i=[];return e.each(t,function(e,t){e=n?n+"["+e+"]":e,i.push(null!==t&&"object"==typeof t?a(t,e):encodeURIComponent(e)+"="+encodeURIComponent(t))}),i.join("&")};e.etag={},e.ajax=function(t,n){"string"!=typeof t&&(t=(n=t||{}).url);var i=n.dataType||"json",o=new XMLHttpRequest;o.onload=o.onerror=o.ontimeout=function(s){var r=o.status>=200&&o.status<300||304===o.status,a=n[r?"success":"error"];if(a instanceof Function){var c=o.response||s.target.response;if("json"===i&&"string"==typeof c)try{c=JSON.parse(c)}catch(s){return}a(c)}if(r&&n.ifModified){var l=o.getResponseHeader("etag");l&&(e.etag[t]=l)}};var s=n.data||{},r="POST"===n.type;return r||void 0===n.cache||n.cache||(s._=Date.now()),s=a(s),r?(o.open("POST",t,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded")):o.open("GET",t+(s.length?-1===t.indexOf("?")?"?":"&":"")+s,!0),o.withCredentials=!0,n.ifModified&&e.etag[t]&&o.setRequestHeader("If-None-Match",e.etag[t]),o.responseType=i,o.timeout=n.timeout||2e4,o.send.apply(o,r?[s]:[]),o},e.get=function(t,n,i,o){return e.ajax("string"!=typeof t?t:{type:"GET",url:t,data:n,success:i,dataType:o})},e.post=function(t,n,i,o){return e.ajax("string"!=typeof t?t:{type:"POST",url:t,data:n,success:i,dataType:o})};var c=[];e.storagePrefix="conv_",function(){if(document.cookie&&void 0!==window.localStorage){var e={store:function(e,t){try{localStorage[null!==t&&void 0!==t?"setItem":"removeItem"](e,t)}catch(e){}},retrieve:function(e){return localStorage.getItem(e)}};try{e.store("",1),e.store("",null),c.push(e)}catch(e){}}}(),c.push({store:function(t,n){var i=new Date(Date.now()+(null===n?-1:63072e6));e.setCookie(t,n,i)},retrieve:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([.$?*|{}()\[\]\\\/+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):null}}),e.store=function(t,n){null!==n&&(n=e.stringify(n));for(var i=0;i<c.length;i++)c[i].store(e.storagePrefix+t,n)},e.retrieve=function(t,n){for(var i=null,o=0;o<c.length&&!i;o++)try{i=JSON.parse(c[o].retrieve(e.storagePrefix+t))}catch(e){}return null===i&&void 0!==n&&(i=n),i},e.getCookie=function(e,t){for(var n=null,i=0;i<c.length&&!n;i++)try{n=c[i].retrieve(e)}catch(e){}return null===n&&void 0!==t&&(n=t),n},e.setCookie=function(e,t,n){var i=e+"="+t;n&&(i=i+"; expires="+n.toGMTString()),document.cookie=i+"; path=/; secure; samesite=none"},e.safeEval=function(e){try{window.eval(e)}catch(e){console.error(e)}},e.extend=function(){var t={},n=!1,i=0,o=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(n=arguments[0],i++);for(var s=function(i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n&&"[object Object]"===Object.prototype.toString.call(i[o])?t[o]=e.extend(!0,t[o],i[o]):t[o]=i[o])};i<o;i++){s(arguments[i])}return t},e.removeItem=function(e,t){return e.filter(function(e){return e!=t})},e.stringify=function(e){if(Array.prototype.toJSON){var t;console.warn("Overriding Array.prototype.toJSON");var n=Array.prototype.toJSON;return delete Array.prototype.toJSON,t=JSON.stringify(e),Array.prototype.toJSON=n,t}return JSON.stringify(e)},e.debounce=function(e){var t=arguments.length<=1||void 0===arguments[1]?100:arguments[1],n=void 0;return function(){for(var i=this,o=arguments.length,s=Array(o),r=0;r<o;r++)s[r]=arguments[r];clearTimeout(n),n=setTimeout(function(){e.apply(i,s)},t)}},e.getCoords=function(e){var t=e.getBoundingClientRect(),n=document.body,i=document.documentElement,o=window.pageYOffset||i.scrollTop||n.scrollTop,s=window.pageXOffset||i.scrollLeft||n.scrollLeft,r=i.clientTop||n.clientTop||0,a=i.clientLeft||n.clientLeft||0;return{top:t.top+o-r,left:t.left+s-a,height:e.offsetHeight}};var l=function(){e.$document=e(document),e.$window=e(window),e.$head=e(document.head),e.$html=e(document.documentElement),e.$body=e(document.body),e.$tmp=e(document.createElement("div"))};e.isReady?l():s.push(l)}(),window.Convertful=function(e){var t=function(){return Math.floor(Date.now()/1e3)},n={getPlatform:function(){var e=navigator.userAgent;return void 0!==window.orientation||-1!==e.indexOf("IEMobile")?/Android/i.test(e)?/Mobile/i.test(e)?"mobile":"tablet":/ipad|playbook|silk/i.test(e)?"tablet":"mobile":/Nintendo|PLAYSTATION|Xbox/i.test(e)?"console":window.orientation||"ontouchstart"in window||"onmsgesturechange"in window?-1!==e.indexOf("Edge")?"desktop":"unknown":"desktop"},getUrlQueries:function(e){e||(e=window.location);var t={},n=document.createElement("a");n.href=e;for(var i=n.search.substring(1).split("&"),o=0;o<i.length;o++){var s=i[o].split("=");t[s[0]]=decodeURIComponent(s[1])}return t},getUrlQuery:function(e,t){var n,i,o=/[?&]?([^=]+)=([^&]*)/g;for(t||(t=location.search),(i=t.indexOf("?"))&&(t=t.substring(i+1));n=o.exec(t);)if(e===decodeURIComponent(n[1]))return decodeURIComponent(n[2].replace(/\+/g," "));return""},getRef:function(e){if(""===e)return["direct"];var t=e.split("/")[2].replace(/^www\./,"");if(t===location.host.replace(/^www\./,""))return["internal"];var n=["utm_source=bing","gclid=","utm_medium=cpc","utm_medium=paid-media","utm_medium=ppc","aclk?","cid="];if(-1!==e.search(/\bgoogle\..*\?.*adurl=http/))return["ppc"];for(var i=0;i<n.length;i++)if(-1!==e.split("?").slice(1).join("?").indexOf(n[i])||-1!==location.search.indexOf(n[i]))return["ppc"];if(-1!==e.split("?").slice(1).join("?").indexOf("utm_medium=email")||-1!==location.search.indexOf("utm_medium=email"))return["email"];var o={facebook:["facebook.com","fb.me"],pinterest:["pinterest.com"],twitter:["twitter.com","t.co"],linkedin:["linkedin.com"],googleplus:["plus.google.com","plus.url.google.com"]};for(var s in o)if(o.hasOwnProperty(s))for(i=0;i<o[s].length;i++)if(-1!==t.replace(o[s][i],"#").split(".").indexOf("#"))return["social",s];var r={google:[["google"]],bing:[["bing"],["q"]],yahoo:[["search.yahoo","m.yahoo","m2.yahoo"]],baidu:[["baidu"],["wd","word"]],yandex:[["yandex","ya.ru"],["text"]],socom:[["so.com"],["q"]],"360cn":[["360.cn"],["q"]],"360sou":[["360sou"],["q"]],aol:[["aol"],["query","q"]],duckduckgo:[["duckduckgo"]],askcom:[["ask.com"],["q","QUERYT"]],mailru:[["mail.ru"],["words"]],sogou:[["sogou"],["q","query"]]};for(var a in r)if(r.hasOwnProperty(a)){var c=new RegExp("(\\.|^)("+r[a][0].join("|").replace(/\./g,"\\.")+")(\\.|$)").test(t),l=r[a].length<2||new RegExp("(\\?|&)("+r[a][1].join("|")+")=").test(e);if(c&&l)return["organic",a]}return["external"]},getWidgetEvents:function(t){var n=e.retrieve("lastEvents",{}),i={};return e.each(n,function(e,n){n[t]&&(i[e]=!0)}),i},storeWidgetEvent:function(t,i,o){var s="close"===i?1:"conversion"===i?2:0,r=e.retrieve("lastEvents",{});"string"==typeof r[t=+t]&&(r[t]=JSON.parse(r[t])||[]),r[t]=r[t]||[];for(var a=0;a<=s;a++)r[t][a]=r[t][a]||0;r[t][s]=o,e.store("lastEvents",r),"conversion"===i&&n.trigger("conversion",[t])}},i={};n.on=function(e,t){return void 0===i[e]&&(i[e]=[]),i[e].push(t),this},n.off=function(e,t){if(i[e]instanceof Array&&void 0!==t){var o=i[e].indexOf(t);-1!==o&&i[e].splice(o,1)}else delete i[e];return n},n.one=function(e,t){var i=function(){t.apply(n,arguments),n.off(e,i)};return n.on(e,i)},n.trigger=function(e,t){if(i[e]instanceof Array)for(var o=i[e].length-1;o>=0;)i[e][o]&&"function"==typeof i[e][o]&&i[e][o].apply(n,t),o-=1;return n},n.getElmType=function(e){return e.match(/([a-z_]+)(\d?)/)[1]},n.requestAnimationFrame=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60,!0)}).bind(window);var o={values:{},affects:{},_bound:{},permanent:[],attach:function(i,o){if(o[0]instanceof Array)for(var a=0;a<o.length;a+=2)this.attach(i,o[a]);else{var c,l=o[0],d=void 0===this.affects[l],f=t();if("string"==typeof l&&(d&&(this.affects[l]=[]),-1===this.affects[l].indexOf(i)&&this.affects[l].push(i),d))if("timeOnPage"===l)this.pageTimer=setInterval(function(){this.set(l,t()-f)}.bind(this),1e3),this.set(l,0);else if("inactivityTime"===l){var u=0,h=function(){u++,this.set(l,u)}.bind(this);this.pageInactivityTimer=setInterval(h,1e3),e.$window.on("mousemove scroll orientationchange keydown",this._bound.inactivity=function(){clearInterval(this.pageInactivityTimer),u=0,this.pageInactivityTimer=setInterval(h,1e3)}.bind(this)),this.set(l,u)}else if("timeOnSite"===l)this.siteTimer=setInterval(function(){this.set(l,t()-n.session().start)}.bind(this),1e3),this.set(l,t()-n.session().start);else if("wasShown"===l)this.set(l,n.getWidgetEvents(0)),n.on("afterShow",function(){this.set(l,n.getWidgetEvents(0))}.bind(this));else if("wasClosed"===l)this.set(l,n.getWidgetEvents(1)),n.on("close",function(){this.set(l,n.getWidgetEvents(1))}.bind(this));else if("wasSubmitted"===l)this.set(l,n.getWidgetEvents(2)),n.on("submit",function(){this.set(l,n.getWidgetEvents(2))}.bind(this));else if("wasConvertedBeforeReload"===l)this.set(l,[]),n.on("conversion",function(e){var t=this.values.wasConvertedBeforeReload||[];t.push(""+e),this.set(l,t)}.bind(this));else if("leaveIntent"===l){var v=0,m=!1;e.$body.on("mousemove",this._bound.bodymove=function(e){m=e.screenY<200&&e.screenY<=v,v=e.screenY}.bind(this)),e.$body.on("mouseleave",this._bound.bodyleave=function(){m&&this.setEvent(l)}.bind(this))}else if("clicked:"===l.substr(0,8)){var p=l.substr(8),g=function(t){if("submit"!==t.target.type&&t.preventDefault(),!this.affects[l])return e.$body.off("click",p,g);this.setEvent(l)}.bind(this);e.$body.on("click",p,g),-1===this.permanent.indexOf(l)&&this.permanent.push(l)}else if("triggered:"===l.substr(0,10)){var w=e.retrieve("customEvents",{});this.set(l,w[l]||!1),n.on(o[3],function(){r.setEvent(l)}.bind(this)),-1===this.permanent.indexOf(l)&&this.permanent.push(l)}else if("scrollPc"===l)this._bound.scrollPc=function(){this.set(l,(window.pageYOffset||document.body.scrollTop)/((document.body.scrollHeight||document.body.offsetHeight)-window.innerHeight)*100)}.bind(this),e.$window.on("scroll",this._bound.scrollPc),e.$window.on("touchmove",this._bound.scrollPc),this._bound.scrollPc();else if("scrollPx"===l)this._bound.scrollPx=function(){this.set(l,window.pageYOffset||document.body.scrollTop)}.bind(this),e.$window.on("scroll",this._bound.scrollPx),e.$window.on("touchmove",this._bound.scrollPx),this._bound.scrollPx();else if("relativeUrl"===l||"absoluteUrl"===l||"relativeStartUrl"===l||"absoluteStartUrl"===l){var _="Start"===l.substr(-8,5),b=function(e){var t=e?n.session().startUrl:location.href;"r"===l[0]&&(t=t.replace(/^(?:\/\/|[^\/]+)*/,"")),t=t.replace(/#$/,""),this.set(l,decodeURI(t))}.bind(this,_);_||(window.onpopstate=history.onpushstate=b),b()}else if("sessionImpressions"===l||"pageImpressions"===l){var y=[],$=function(e){e&&-1===y.indexOf(e)&&1===(n.widgets[e]||{}).isObstacle&&y.push(e),this.set("sessionImpressions",n.session().shown),this.set("pageImpressions",y)}.bind(this);n.on("afterShow",$),n.on("widgetAffected",$),$()}else if("firstRefUrl"===l)this.set(l,n.session().referrer);else if("lastRefUrl"===l)this.set(l,document.referrer);else if("ref"===l)this.set(l,n.getRef(n.session().referrer));else if("pageViews"===l)this.set(l,n.session().pageViews);else if("visitNum"===l)this.set(l,n.personGet("$visitNum"));else if("timeFromFv"===l)this.set(l,t()-n.personGet("$fvDate"));else if("timeFromLv"===l&&n.personGet("$lvDate"))this.set(l,t()-n.personGet("$lvDate"));else if("lvDate"===l&&n.personGet("$lvDate"))this.set(l,new Date(1e3*n.personGet("$lvDate")).toISOString().substr(0,10));else if(0===l.indexOf("urlGet"))this.set(l,n.getUrlQuery(l.split(":")[1]));else if("date"===l)this.set(l,new Date((new Date).getTime()+3600*o[3]*1e3).toISOString().substr(0,10));else if(0===l.indexOf("cookie"))this.cookieTimer=setInterval(function(){this.set(l,e.getCookie(l.split(":")[1]))}.bind(this),1e3),this.set(l,e.getCookie(l.split(":")[1]));else if("screenWidth"===l)e.$window.on("resize",function(){this.set(l,window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)}.bind(this)),this.set(l,window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth);else if("platform"===l)this.set(l,n.getPlatform());else if(0===l.indexOf("platformVar:")){var S=l.split(":")[1];this.set(l,(window.convPlatformVars||[])[S]||[])}else if(c=/^timeFrom(Impression|Close|Conversion):([0-9]+)$/.exec(l)){var k=e.retrieve("lastEvents",{})[c[2]]||[],x=["impression","close","conversion"].indexOf(c[1].toLowerCase());"string"==typeof k&&(k=JSON.parse(k)||[]),this.set(l,t()-(k[x]||0)),"Close"===c[1]&&n.on("close",function(e){this.set("timeFromClose:"+e,1)}.bind(this))}else if(0===l.indexOf("personParam"))this.set(l,n.personGet(l.split(":")[1]));else if(0===l.indexOf("countdownTime")){var E,C=o[4]||i,O=n.personGet("$countdowns",{})[C];E=o[3]<1e9?O?O.end+O.reset<t()?o[3]:O.end-t():o[3]:parseInt(o[3])-t(),this.set(l,E)}else if("obstacleShown"===l){var T=function(){this.set(l,n.shownObstacles.length>0)}.bind(this);n.on("beforeShow",T),n.on("afterHide",T),n.on("widgetAffected",T),T()}else if("countryID"===l||"regionID"===l||"cityID"===l){var I=e.getCookie("conv_geoip"),D="countryID"===l?1:"regionID"===l?2:3;I?this.set(l,I.split(",")[D]):this.set(l,0)}else"fab:"===l.substr(0,4)&&(this.set(l,!1),-1===this.permanent.indexOf(l)&&this.permanent.push(l),n.on("afterHide",this._bound.fab=function(e){s.checkFabRules(e)&&n.showFab(e)}))}},detach:function(t,n){e.each(this.affects,function(i,o){if(-1!==o.indexOf(t)){if(!n&&-1!==this.permanent.indexOf(i))return!0;o.splice(o.indexOf(t),1),0===o.length&&(delete this.affects[i],"timeOnPage"===i?clearInterval(this.pageTimer):"inactivityTime"===i?(clearInterval(this.pageInactivityTimer),e.$window.off("mousemove scroll orientationchange keydown",this._bound.inactivity)):"timeOnSite"===i?clearInterval(this._bound.siteTimer):0===i.indexOf("cookie")?clearInterval(this.cookieTimer):"leaveIntent"===i?e.$body.off("mousemove",this._bound.bodymove).off("mouseleave",this._bound.bodyleave):"scrollPc"!==i&&"scrollPx"!==i||e.$window.off("scroll",this._bound[i]))}}.bind(this))},set:function(e,t,i){t!==this.values[e]&&(this.values[e]=t,n.requestAnimationFrame(this._render.bind(this,e,t,i)))},_render:function(e,t,n){},setEvent:function(e){this.set(e,!0,function(t){var i=/^clicked:a\[href\*="(#[^"\]]+)"]$/.exec(e);if(i){var o=i[1],s=location.hash;s===o&&(s=""),location=o;var r=function(e){e==t&&(history.replaceState(null,"",location.pathname+location.search+s),n.off("beforeHide",r))};n.on("beforeHide",r)}}),setTimeout(this.set.bind(this,e,!1),100)},checkRule:function(e){var t=this._checkRule(e);return n.debug&&console.debug(e,t),t},_checkRule:function(e){if(e[0]instanceof Array){for(var t=this.checkRule(e[0]),n=2;n<e.length;n+=2){var i=this.checkRule(e[n]);switch(e[n-1]){case"and":t=t&&i;break;case"and_not":t=t&&!i;break;case"or":t=t||i}}return t}if("boolean"==typeof e[0])return e[0];var o=this.values[e[0]];if(void 0===o)return!1;switch(e[1]){case"=":return""===e[2]?null===o||"string"!=typeof o&&0===o.length:o==e[2];case"!=":return""===e[2]?null!==o||"string"!=typeof o&&0!==o.length:o!=e[2];case"<":return o<e[2];case"<=":return o<=e[2];case">":return o>e[2];case">=":return o>=e[2];case"!~=":return!o||o.indexOf&&-1===o.indexOf(e[2])||"object"==typeof o&&!Array.isArray(o)&&void 0===o[e[2]];case"~=":return o&&(o.indexOf&&-1!==o.indexOf(e[2])||"object"==typeof o&&void 0!==o[e[2]]);default:return!1}}},s=n.si={_render:function(e,t,i){var o=this.affects[e];if(o)for(var s=0;s<o.length;s++){var r=o[s],a=n.widgets[r];this.checkWidgetRules(r)?n.show(r)&&(n.hideFab(r),a.isInstant||this.detach(r),i instanceof Function&&i(r),n.trigger("widgetAffected",[r])):a.isInstant&&n.$widgets[r]&&"personParam:$UID"!==e?n.hide(r):this.checkFabRules(r)?n.showFab(r):n.hideFab(r)}},checkWidgetRules:function(e){var t=n.widgets[e];return!(!t||t.showIf.length&&!this.checkRule(t.showIf))},checkFabRules:function(e){var t=n.widgets[e],i=t.fabShowIf||[];return!(!t||i.length&&!this.checkRule(i))},getPlatform:n.getPlatform,getRef:n.getRef,getUrlQuery:n.getUrlQuery,getWidgetEvents:n.getWidgetEvents};n.si.__proto__=o;var r=n.cevents={rules:{},affects:[],set:function(t,n,i){isNaN(t)||(t="triggered:"+t),this.values[t]=n;for(var o=e.retrieve("customEvents",{}),r=this.affects[t]||[],a=0;a<r.length;a++){var c,l=r[a],d=this.rules[l];this.checkRule(d)&&(c="triggered:"+l,s.values[c]=!0,s._render(c,!0),n&&!o[c]&&(o[c]=!0,e.store("customEvents",o),i||this._trackEvent(l)))}},_trackEvent:function(i){var o=n.personGet("$UID");if(o)e.post(n.ajaxUrl+"/api/custom_event/track/"+i,{site_id:n.siteId,subscriber_uid:o});else{var s=e.retrieve("prevEvents",[]);(s=s.filter(function(e){return e.site_event_id!==i})).push({site_event_id:i,date:t()}),e.store("prevEvents",s)}},setEvent:function(e,t){this.set(e,!0,t)}};n.cevents.__proto__=o;var a=n.ab={ids:[],vars:{},init:function(t){var i=[];t.forEach(function(e){var t=+e.id,n=+e.varOf;n&&(a.vars[t]=a.vars[n]=a.vars[n]||[n]).push(t),i.push(t)});var o=n.session(),s=o.ab=(o.ab||[]).filter(function(e){return-1!==i.indexOf(e)});e.each(a.vars,function(e,t){if(-1!==i.indexOf(+e)){for(var n=0;n<t.length;n++)if(-1===i.indexOf(t[n])&&t.splice(n,1),-1!==s.indexOf(t[n]))return;s.push(t[Math.floor(Math.random()*t.length)])}}),s.length>0&&n.session(o),a.ids=i.filter(function(e){return!a.vars[e]||-1!==s.indexOf(e)})},canBeShown:function(e){return-1!==a.ids.indexOf(e)},getVarsOf:function(e){return a.vars[e]||[e]}};n.activeWidgets=[],n.$widgets={},n.$containers={},n.$overlays={},n.$styles={},n._loadedFonts={},n.$scripts={},n._externalJsLoaded=!0,n.shownObstacles=[],n.socsignEvents={},n.waypoints=[],n.currentState="desktop",n.lastClickedElement=null,n.countdownAnimations=[],n.activeFabs=[],n.$fabs={};var c=navigator.userAgent||navigator.vendor||window.opera;n.isIOS=c.match(/iphone|ipod|ipad/i),n.isFB=c.indexOf("FBAN")>-1||c.indexOf("FBAV")>-1,n.isReady=!1,n._clickFunctions={formSubmit:function(t){t.preventDefault();var i=e(t.currentTarget);i.is(".conv-btn.conv_action_submit")||(i=i.closest(".conv-screen").find(".conv-btn.conv_action_submit").first());var o=i.closest(".conv-widget").attr("id").replace("conv","");n._maybeSubmitData(o,i.mod("conv_id"),n._getWidgetActiveScreenData(o))},btnClick:function(i){var o,s=e(i.currentTarget),r=s.mod("conv_action");if(n.trackEvent(s),"close"===r)o=+s.closest(".conv-widget").attr("id").replace("conv",""),n.storeWidgetEvent(o,"close",t());else if("link"===r){var a=s.attr("href"),c=a&&0===a.indexOf("javascript:"),l="_blank"===s.attr("target");c?e.safeEval(a.substr(11)):l||(i.preventDefault(),setTimeout(function(){location=a},500))}},shareClick:function(t){t.preventDefault();var i=n.lastClickedElement=e(t.currentTarget).closest(".conv-share").elms[0],o=e(t.currentTarget).closest(".conv-widget").attr("id").replace("conv",""),s=n.widgets[o];void 0!==n.shareWindow?s.shareTimer=setInterval(function(){(null===n.shareWindow.window||n.shareWindow.window.closed)&&(clearInterval(s.shareTimer),n.lastClickedElement=i,n._shareCallback(t))}.bind(this),250):n._shareCallback(t)},socsignClick:function(t){t.preventDefault();var i=e(t.currentTarget).attr("href");n.isIOS&&n.isFB&&(i+="&prevUrl="+location.href,e.store("convStoredData",n._getWidgetActiveScreenData(id)),e.store("convScroll",window.pageYOffset)),n._openDialog(i,"toolbar=no, width=600, height=600")},scratchClick:function(t){t.preventDefault();var i=e(t.currentTarget),o=i.closest(".conv-widget").attr("id").replace("conv","");i.closest(".conv-scratch").hasClass("conv_active")||n._maybeSubmitData(o,i.mod("conv_id"),n._getWidgetActiveScreenData(o))},close:function(e){n.close(e)}},n.showFab=function(t){var i=n.widgets[t];if(i.fab&&-1===n.activeFabs.indexOf(t)&&-1===n.activeWidgets.indexOf(t)){var o=n.$containers[t]=n.$containers[t]||e('<div class="conv-container"></div>');n.activeWidgets.length||n.activeFabs.length||(e.$head.append(n.$styles.general),e.$window.on("resize",n._resize));var r=e(i.fab);return o.append(r),o.appendTo(e.$body),n.activeFabs.push(t),n.$fabs[t]=r,e.each(i.externalCss||[],function(e,i){n._addStyle(i,t,"fab")}),r.one("click",function(){s.setEvent("fab:"+t)}),r}},n.hideFab=function(t){-1!==n.activeFabs.indexOf(t)&&(n.activeFabs=e.removeItem(n.activeFabs,t),void 0!==n.$fabs[t]&&n.$fabs[t].remove(),n.activeWidgets.length||n.activeFabs.length||(n.$styles.general.detach(),e.$window.off("resize",n._resize)),n._removeStyle(t,"fab"))},n._addStyle=function(t,i,o){if(t&&i){o||(o="");var s=[],r=n.$styles[i]=n.$styles[i]||new cQuery;if(/^https?:\//.test(t))if(n._loadedFonts.hasOwnProperty(t))s.push(n._loadedFonts[t].addClass("conv_id_"+i+o));else{var a=e('<link rel="stylesheet" class="conv-css-external conv_id_'+i+o+'" href="'+t+'" />');s.push(a),n._loadedFonts[t]=a}else s.push(e('<style type="text/css" class="conv-css conv_id_'+i+o+'">'+t+"</style>"));e.each(s,function(t,n){null===n.elms[0].parentElement&&e.$head.append(n.elms[0]),r.elms.push(n.elms[0])})}},n._removeStyle=function(t,i){(n.$styles[t]||new cQuery).each(function(n){var o=e(n);i?o.removeClass("conv_id_"+t+i):n.className=n.className.replace(/\bconv_id_.*?\b/g,""),/conv_id_/.test(n.className)||o.remove()})},n._initWidget=function(t){var i=n.widgets[t];n.activeWidgets.length&&e.$head.find("link.conv_id_general").elms.length||(e.$head.append(n.$styles.general),e.$window.on("resize",n._resize),n.isIOS&&e.$window.on("orientationchange",n._orientationchange)),e.each(i.externalCss||[],function(e,i){n._addStyle(i,t)}),n._addStyle(i.css,t);var o=(i.externalJs||[]).length,s=0;if(void 0===n.$scripts[t]){n.$scripts[t]=new cQuery;var r=function(){++s>=o&&(n.trigger("externalJsLoaded",[t]),n._externalJsLoaded=!0)};e.each(i.externalJs||[],function(e,i){var o=document.createElement("script");o.readyState&&!o.onload?o.onreadystatechange=function(){"loaded"!==o.readyState&&"complete"!==o.readyState||(o.onreadystatechange=null,r())}:o.onload=r,n._externalJsLoaded=!1,o.src=i,o.type="text/javascript",n.$scripts[t].elms.push(document.body.appendChild(o))})}n.isIOS&&(i.iosH=window.innerHeight)},n.show=function(t){if(!n.isReady||void 0===n.widgets)return n.one("afterInit",function(e){n.show(e)}.bind(this,t)),!1;if(-1!==n.activeWidgets.indexOf(t)||!n.widgets[t]||void 0!==n.$widgets[t])return!1;var i,o=n.widgets[t],s=n.$containers[t]=e('<div class="conv-container"></div>');if(n.hideFab(t),o.place&&o.place[1]){i=e(o.place[1]).first();var r=o.place[0];i.elms.length||"replace"!==r||(i=e.$body.find('.conv-widget[id="conv'+o.id+'"]').parent())}else r="appendTo",i=e.$body;return!(!i||!i.elms.length)&&(s[r](i),n._initWidget(t),n.activeWidgets.push(t),o.isObstacle&&n.shownObstacles.push(t),setTimeout(function(){s.mod("conv_state",n.currentState).append(e(o.html));var i=n.$widgets[t]=s.find(".conv-widget"),r=n.$overlays[t]=s.find(".conv-overlay"),a=i.find("form"),c=i.find(".conv-socsign-link"),l=i.find(".conv-follow-item > div.fb-like"),d=i.find(".conv-countdown"),f=i.find(".conv-scratch_card"),u=i.find(".conv-spintowin");s.on("click",".conv-closer, .conv-wrap-closer, .conv-btn.conv_action_close",function(e){e.preventDefault(),n.close(t)}),r.elms.length&&s.find(".conv-wrap").on("click",function(i){e(i.target).is(".conv-wrap")&&n.close(t)}),i.on("click",function(e){n.lastClickedElement=e.target}),a.on("submit",n._clickFunctions.formSubmit),i.find(".conv-btn.conv_action_submit").on("click",n._clickFunctions.formSubmit),i.find(".conv-btn:not(.conv_action_submit)").on("click",n._clickFunctions.btnClick),i.find(".conv-share-item").on("click",n._clickFunctions.shareClick),c.on("click",n._clickFunctions.socsignClick),f.on("click",n._clickFunctions.scratchClick),a.find(".conv-form-field input, .conv-form-field select").on("focus change",function(t){e(t.target).closest(".conv-form-field").removeClass("conv_error").find(".conv-form-field-message").html("").css({display:"none"})}),i.find("textarea").on("input change",function(){this.style.height="auto",this.style.height=this.scrollHeight+"px"}),i.find(".conv_shortcode_value").each(function(t){e(t).attr("contenteditable",!1)}),l.elms.length&&(window.FB&&!l.hasClass("fb_iframe_widget")&&window.FB.XFBML.parse(),o.facebookTimer=setInterval(function(){var t=document.activeElement;t&&"IFRAME"===t.tagName&&e(t).closest("div.fb-like").elms.length&&(clearInterval(o.facebookTimer),setTimeout(function(){n.lastClickedElement=e(t).closest(".conv-follow").elms[0],n._followCallback()},5e3))},250)),c.elms.length&&e.$window.on("message",n.socsignEvents[t]=n._socsignCallback),n._maybeReplaceSubscriberVars(i.find(".conv-screen.conv_active"),t);var h=function(){d.elms.length&&n._initCountdowns(d),f.elms.length&&n._initScratchCards(f),u&&n._initSpinToWins(u)};n._externalJsLoaded?h():n.on("externalJsLoaded",h),n.trigger("beforeShow",[t]),o.isObstacle?setTimeout(function(){r.addClass("conv_active"),i.addClass("conv_active"),n.addImpression(t)},100):n.addWaypoint(s,function(){i.addClass("conv_active"),n.addImpression(t)}.bind(n,t)),o.onshow_js&&e.safeEval(o.onshow_js),e.$body.addClass("conv_opened_"+t),"welcome"===o.type?(o.isScrollable=i.hasClass("conv_scrollable"),o._restoreScrollValue=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop),window.scroll(0,0),o.isScrollable?o.isObstacle&&n.addWaypoint(s.find(".conv-widget-h"),n.hide.bind(n,t),"onHide"):(n.isIOS?(e.$body.addClass("conv_ios_fix"),e.$html.addClass("conv_ios_fix")):e.$body.addClass("conv_welcome_fix"),i.find(".conv-widget-h").height()>window.innerHeight&&i.addClass("conv_inner_scrolling"))):"mobile"===n.getPlatform()&&"inline"!==o.type&&i.find(".conv-widget-h").height()>window.innerHeight?(o._restoreScrollValue=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop),n._addStyle("body.conv_opened_"+t+"{overflow-y:hidden!important; position: fixed!important;}",t,"scroll_fix"),n.on("beforeHide",function(){o._restoreScrollValue&&e.scrollTo(o._restoreScrollValue,0),o._restoreScrollValue=null})):"inline"===o.type&&i.hasClass("conv_is_content_locker")&&s.attr("id","conv"+t+"_container");var v=i.find(".conv-ref a"),m=v.attr("href");m&&-1!==m.indexOf("utm_")&&-1===m.indexOf("utm_referrer")&&v.attr("href",m+"&utm_referrer="+encodeURIComponent(window.location)),n.trigger("show",[t]),n.requestAnimationFrame(function(){e.each(n.getUrlQueries(),function(e,t){if(!/^conv_/.test(e))return 0;e=e.replace(/^conv_/,"");var n=a.find('[name="'+e+'"]');if(void 0===n.elms[0])return 0;switch(n.attr("type")||n.elms[0].tagName.toLowerCase()){case"radio":var i=n.filter('[value="'+t+'"]');if(void 0!==i.elms[0]){i.elms[0].checked=!0;break}for(var o=a.elms[0].getElementsByTagName("LABEL"),s=0;s<o.length;s++)if(o[s].innerText===t){n.filter("#"+o[s].htmlFor).elms[0].checked=!0;break}break;case"checkbox":n.elms[0].checked=!0;break;case"select":var r=n.find('[value="'+t+'"]');if(void 0!==r.elms[0]){n.val(r.val());break}n.find("option").each(function(e){if(e.innerText===t)return e.selected=!0,!0});break;case"date":var c=new Date(t);n.val(c.getFullYear()+"-"+("0"+(c.getMonth()+1)).slice(-2)+"-"+("0"+c.getDate()).slice(-2));break;default:n.val(t)}}),e.$window.trigger("resize"),n._resize()})},150),!0)},n.addImpression=function(e){n.sendStat(e);var t=n.session();-1===t.shown.indexOf(e)&&t.shown.push(e),n.session(t),n.trigger("afterShow",[e])},n.sendStat=function(i){var o={widget_id:i,type:"impression"};return n.personGet("$UID")&&(o.subscriber_uid=n.personGet("$UID")),n.storeWidgetEvent(i,"impression",t()),e.post(n.ajaxUrl+"/api/widget/track_event",o)},n.hide=function(t){var i=n.widgets[t];if(t&&i&&n.$containers[t]){n.trigger("beforeHide",[t]);var o=this._afterHide.bind(this,t);if("welcome"===i.type){var s=n.$containers[t].find(".conv-widget-h").elms[0],r=s.offsetTop+s.offsetHeight;if(i.isScrollable&&r<=window.pageYOffset){var a=i._restoreScrollValue||window.pageYOffset-r;o(),e.scrollTo(a,300)}else if(i.isScrollable)e.scrollTo(s.offsetHeight,parseInt((r-window.pageYOffset)/4),function(){o(),window.scroll(0,0)});else{var c=n.$containers[t].find(".conv-widget-h");c.css({position:"fixed",transform:"translateY(0%)"}),i._restoreScrollValue&&e.scrollTo(i._restoreScrollValue,300),c.animate({transform:"translateY(-100%)"},parseInt((r-window.pageYOffset)/4),"ease",function(){o()})}i._restoreScrollValue=null}else setTimeout(o,300);n.$widgets.hasOwnProperty(t)&&(n.$widgets[t].removeClass("conv_active"),n.$overlays[t].removeClass("conv_active")),n.activeWidgets=e.removeItem(n.activeWidgets,t),n.shownObstacles=e.removeItem(n.shownObstacles,t)}},n._afterHide=function(t){var i=n.widgets[t];if(t&&n.$containers[t]&&i){if(n.$containers[t].remove(),n._removeStyle(t),n.$scripts[t]&&n.$scripts[t].remove(),delete n.$widgets[t],delete n.$containers[t],delete n.$overlays[t],delete n.$scripts[t],n.socsignEvents[t]&&(e.$window.off("message",n.socsignEvents[t]),delete n.socsignEvents[t]),n.activeWidgets.length||n.activeFabs.length||(n.$styles.general.detach(),e.$window.off("resize",n._resize),n.isIOS&&e.$window.on("orientationchange",n._orientationchange)),i.isInstant&&e.$window.trigger("resize"),i.facebookTimer&&clearInterval(i.facebookTimer),i.shareTimer&&clearInterval(i.shareTimer),n.countdownAnimations.length&&!e(".conv-countdown").elms.length)for(var o in n.countdownAnimations)n.countdownAnimations.hasOwnProperty(o)&&cancelAnimationFrame(n.countdownAnimations[o]);n.trigger("afterHide",[t]),e.$body.removeClass("conv_opened_"+t),e.$body.removeClass("conv_ios_fix"),e.$html.removeClass("conv_ios_fix"),e.$body.removeClass("conv_welcome_fix")}},n.addWaypoint=function(t,i,o){n.waypoints.push({elm:t instanceof cQuery?t.elms[0]:t,fn:i,mode:o||"onShow"}),1===n.waypoints.length&&e.$window.on("scroll",n._scroll),n._resize()},n.followDialog=function(t,i){var o=e(t);n._openDialog(i,"toolbar=no, width=650, height=600",function(){n.lastClickedElement=o.closest(".conv-follow").elms[0],n._followCallback()})},n._openDialog=function(e,t,n){var i=window.open(e,null,t);if(n)var o=window.setInterval(function(){try{(null==i||i.closed)&&(window.clearInterval(o),n())}catch(e){}},500);return i},n._initCountdowns=function(i){var o,s,r=i.closest(".conv-widget").attr("id").replace(/[^0-9]/g,""),a=i.find(".conv-countdown-time.conv_for_days > .conv-countdown-time-h"),c=i.find(".conv-countdown-time.conv_for_hours > .conv-countdown-time-h"),l=i.find(".conv-countdown-time.conv_for_minutes > .conv-countdown-time-h"),d=i.find(".conv-countdown-time.conv_for_seconds > .conv-countdown-time-h"),f=n.personGet("$countdowns",{}),u=function(){if(void 0===s||t()-s>=1){s=t();var f=o-t(),h=Math.floor(f%60),v=Math.floor(f/60%60),m=Math.floor(f/3600%24),p=Math.floor(f/86400);if(f<0)return n.countdownAnimations.length&&cancelAnimationFrame(n.countdownAnimations[r]),void i.each(function(t){n._countdownCallback(e(t),r)});a.html((p<10?"0":"")+p),c.html(("0"+m).slice(-2)),l.html(("0"+v).slice(-2)),d.html(("0"+h).slice(-2))}n.countdownAnimations[r]=n.requestAnimationFrame(u)};if(i.data("ends_on"))o=+i.data("ends_on"),f[r]={};else if(i.data("ends_after")){var h=+i.data("parent"),v=+i.data("ends_after"),m=+i.data("ends_reset"),p=h||r,g=function(){o=v+t(),f[p]={end:o,orig:v,reset:m}};f[p]?(o=f[p].end,(+f[p].orig!==v||m+o<=t())&&g()):g()}n.personSet("$countdowns",f),n.countdownAnimations[r]=n.requestAnimationFrame(u)},n._initScratchCards=function(t){t.each(function(t){e(t).scratch_card()})},n._initSpinToWins=function(t){t.each(function(t){e(t).find(".conv-spintowin-container").spinToWin()})};var l=function(e,t){n.requestAnimationFrame(function(){for(var i=0;i<n.activeWidgets.length;i++){var o=n.activeWidgets[i];n.$widgets[o]&&e(o,n.widgets[o],n.$widgets[o])}t instanceof Function&&t()})};n._orientationchange=function(){l(function(e,t){"welcome"===t.type&&t.isScrollable&&(t.iosH=window.innerHeight)},n._resize)},n._resize=function(){e.each(n.$containers,function(e,t){t.mod("conv_state",n.currentState)}),l(function(e,t,i){var o=i.find(".conv-widget-h").height(),s="desktop"===n.currentState?"place":"mobilePlace";switch(t.overlap=i.hasClass("conv_overlap"),t.type){case"bar":if(t.overlap||t.height===o)break;Number(o)==o&&(o+="px"),t.height=o,n._removeStyle(e,"body_padding"),"top"!==i.mod("conv_"+s)?n._addStyle("body.conv_opened_"+e+"{padding-bottom: "+t.height+"!important;}",e,"body_padding"):n._addStyle("body.conv_opened_"+e+"{padding-top: "+t.height+"!important;}",e,"body_padding");break;case"welcome":var r="100vh";if(t.isScrollable){var a=i.find(".conv-widget-h").css({bottom:"auto","min-height":""}),c=a.height();n.isIOS?r=t.iosH:c>window.innerHeight?r=c:a.css({bottom:0}),a.css({"min-height":r,"max-height":r})}i.find(".conv-widget-h").height()>window.innerHeight&&(i.addClass("conv_inner_scrolling"),r=i.find(".conv-widget-h").height()),n._removeStyle(e,"body_padding"),Number(r)==r&&(r+="px"),n._addStyle("body.conv_opened_"+e+"{padding-top: "+r+"!important;}",e,"body_padding")}"welcome"!==t.type&&"inline"!==t.type&&o<=i.height()&&i.css("overflow-y","unset")}),n.waypoints=n.waypoints.filter(function(e){return e.elm&&e.elm.offsetHeight}),n.waypoints.forEach(function(t){var n=e.getCoords(t.elm),i=n.top,o=n.height;"onShow"===t.mode?t.min=(t.max=i+o/2)-window.innerHeight:t.min=i+o}),n._scroll()},n._scroll=function(){for(var t=0;t<n.waypoints.length;t++){var i=n.waypoints[t];(void 0===i.min||window.pageYOffset>i.min)&&(void 0===i.max||window.pageYOffset<i.max)&&(i.fn(),n.waypoints.splice(t--,1))}n.waypoints.length||e.$window.off("scroll",n._scroll)},n.close=function(e){(e=+e)&&-1!==n.activeWidgets.indexOf(e)&&n.widgets[e]&&(n.storeWidgetEvent(e,"close",t()),n.hide(e),n.trigger("close",[e]))},n._socsignCallback=function(t){if(t.origin!==window.location.origin){var i=e(n.lastClickedElement).closest(".conv-socsign");if(i.elms.length){var o=t.data.data||{},s=o.widgetId||+i.closest(".conv-widget").attr("id").replace("conv",""),r=n._getWidgetActiveScreenData(s);Object.keys(r).forEach(function(e){r[e].length||delete r[e]}),n._maybeSubmitData(s,i.mod("conv_id"),e.extend(!0,o,r,{email:o.email}))}}},n._followCallback=function(){n.trackEvent(e(n.lastClickedElement))},n._shareCallback=function(){n.trackEvent(e(n.lastClickedElement))},n._countdownCallback=function(e,t){"1"===e.data("close")&&n.close(t);var i=e.data("redirect");i&&i.length>0&&location.assign(i.replace(/&amp;/g,"&"))},n._scratchCardCallback=function(e){var t=n.$widgets[e].find(".conv-screen.conv_active"),i=t.find(".conv-scratch_card");n._maybeReplaceSubscriberVars(t.elms[0],e),i.find(".conv-scratch").addClass("conv_active")},n._spintowinCallback=function(t,i,o){if(i.hasOwnProperty(i.$fields.prize)){var s=i[i.$fields.prize],r=n.$containers[t],a=e(".conv-screen.conv_active .conv-spintowin-container",r),c=a.elms[0].getBoundingClientRect();"mobile"===n.getPlatform()&&c.y&&("welcome"===n.widgets[t].type?window.scrollTo(0,c.y):r.find(".conv-widget").elms[0].scrollTo(0,c.y)),a.spinToWin("finishSpin",s,o)}},n.trackEvent=function(i){var o,s,r=+i.closest(".conv-widget").attr("id").replace("conv",""),a=n.session();r&&-1!==n.activeWidgets.indexOf(r)&&(o=n.$widgets[r],s={site_id:n.siteId,widget_id:r,type:"click",element_id:i.mod("conv_id"),subscriber_uid:n.personGet("$UID",""),extra_data:{url:location.href,first_pageview_moment:t(),landing_page_url:a.startUrl,page_title:document.title,timezone_offset:(new Date).getTimezoneOffset(),referral_url:a.referrer,visit_number:n.personGet("$visitNum")}},e.retrieve("lastEvents",[])[r][2]&&(s.was_converted=!0),e.post(n.ajaxUrl+"/api/widget/track_event",s,function(e){if(i.removeClass("conv-preloader"),!e.success)return n._displayErrors(e.errors,o);n._handleEventSuccess(e.data,s)}))};var d=!1;return n._maybeSubmitData=function(i,o,s){if(i&&-1!==n.activeWidgets.indexOf(+i)&&!d){var r=n.$widgets[i],a=r.find(".conv_id_"+o);a.addClass("conv-preloader"),d=!0,n.requestAnimationFrame(function(){n._createDatapost("widget",s,i,o,function(o){if(d=!1,a.removeClass("conv-preloader"),!o.success)return n._displayErrors(o.errors,r);var c=0===r.find("input[name=email]").elms.length;e.each(s,function(e){c=c||/^email/.test(e)}),c&&n.storeWidgetEvent(i,"conversion",t());var l=r.find(".conv-screen.conv_active");l.find(".conv-scratch_card").elms.length&&(d=!0,n._scratchCardCallback(i)),l.find(".conv-spintowin").elms.length&&(d=!0,n._spintowinCallback(i,o.data.prize)),n.trigger("submit",[i])})})}},n._createDatapost=function(i,o,s,r,a){var c=n.session();o={site_id:n.siteId,widget_id:s,element_id:r,source:i,data:o,extra_data:{url:location.href,first_pageview_moment:t(),landing_page_url:c.startUrl,page_title:document.title,timezone_offset:(new Date).getTimezoneOffset(),referral_url:c.referrer,visit_number:n.personGet("$visitNum")},subscriber_uid:n.personGet("$UID",""),prev_events:e.retrieve("prevEvents",[])},e.post(n.ajaxUrl+"/api/datapost/create",o,function(e){e.success&&n._handleEventSuccess(e.data,o),a&&a(e,o)})},n._getWidgetActiveScreenData=function(t,i){var o={},s=(n.$widgets[t]||new cQuery).find(".conv-screen.conv_active");return e.each(s.find("input[name], textarea[name], select[name]"),function(t,n){var s=e(n),r=s.attr("name"),a=s.attr("id"),c=s.val();s.is('[type="checkbox"], [type="radio"]')?(i&&(c=s.closest(".conv-form-field").find('label[for="'+a+'"]').text()||c),s.is(":checked")?o[r]=c:void 0===o[r]&&(o[r]="")):o[r]=c}),o},n._maybeReplaceSubscriberVars=function(t){var i=e(t).find(".conv-btn-text, .conv-text .conv-text-h, .conv-btn-subtext, .conv-screen.conv_active .conv-scratch-value .conv-scratch-label, .conv-screen.conv_active .conv-scratch-value .conv-scratch-code"),o=n.personGet();i.elms.forEach(function(t){var n,i=e(t);n=(n=i.html()).replace(/"?{([a-z0-9_,-]+)}"?/gi,function(e,t){if(/"+{([a-z0-9_,-]+)}"+/.test(e))return"{"+t+"}";var n,s=t.split(",");t=s[0],n=s[1];var r=o[t]||n||"";return""===r&&(i.hasClass("conv-scratch-label")||i.hasClass("conv-scratch-code"))&&(r=e),r}),i.html(n)})},n.goToScreen=function(t,i){var o=n.$widgets[t],s=0;if(!o)return!1;var r,a=o.find(".conv-screen"),c=a.filter(".conv_active"),l=c.find(".conv-scratch").elms.length>0,f=c.find(".conv-spintowin").elms.length>0;l&&(s=Math.max(s,3e3)),f&&(s=Math.max(s,1e4)),i?r=a.filter(".conv_id_"+i).elms[0]:void 0!==c.elms[0]&&c.elms[0].nextSibling&&c.elms[0].nextSibling.classList&&c.elms[0].nextSibling.classList.contains("conv-screen")&&(r=c.elms[0].nextSibling),setTimeout(function(){r?(n._maybeReplaceSubscriberVars(r,t),c.removeClass("conv_active"),r.classList.add("conv_active"),e(r).find(".conv-spintowin-container, .conv-scratch_card").each(function(t){-1!==t.className.indexOf("spintowin")?e.$window.trigger("resize."+e(t).data("instance-uid")):-1!==t.className.indexOf("scratch_card")&&t.convScratchCard.resize()})):l||n.hide(t);d=!1;var i=c.find(".conv-video iframe");i.each(function(e){var t=e.cloneNode(!1);e.parentNode.insertBefore(t,e)}),i.remove()},s)},n.nextScreen=function(e){n.goToScreen(e)},n.makeGetRedirect=function(e){setTimeout(function(){location.assign(e)},100)},n.makePostRedirect=function(t,n){var i=e('<form method="post">');i.css("display","none").attr("action",t).attr("method","POST"),e.each(n,function(t,n){var o=e('<input type="hidden">');o.attr("name",t).val(n),i.append(o)}),e.$body.append(i),setTimeout(function(){i.elms[0].submit(),i.remove()},100)},n._handleEventSuccess=function(i,o){if(void 0===i.subscriber_uid){var s=e.retrieve("prevEvents",[]);s.push({widget_id:o.widget_id,element_id:o.element_id,data:o.data,date:t()}),e.store("prevEvents",s)}else n.personSet("$UID",i.subscriber_uid),e.store("prevEvents",null),i.need_sync&&n._syncSubscriber();i.converted&&n.storeWidgetEvent(o.widget_id,"conversion",t()),i.completed_events&&e.each(i.completed_events||[],function(e,t){r.setEvent("triggered:"+t,!0),n.trigger("triggered:"+t)}.bind(this));var a=n._getWidgetActiveScreenData(o.widget_id,!0);e.each(e.extend(!0,o.data,o.extra_data,i.extra_data,a)||[],function(e,t){n.personSet(e,t)}),e.each(i.prize||{},function(e,t){n.personSet(e,t)}),i.js&&n.requestAnimationFrame(function(){i.js instanceof Array?e.each(i.js,function(t,n){e.safeEval(n)}):e.safeEval(i.js)})},n._subscriberSyncCount=0,n._syncSubscriber=function(){var t=n.personGet("$UID",void 0);t&&(n._subscriberSyncCount++,e.get(n.ajaxUrl+"/api/subscriber/get_integrations_data",{subscriber_uid:t,site_id:n.siteId},function(t){if(!1===t.data.sync_finished)return n._subscriberSyncCount<5?setTimeout(n._syncSubscriber,1e3*Math.pow(2,n._subscriberSyncCount)):n._subscriberSyncCount=0,!1;n._subscriberSyncCount=0,e.each(t.data.personParam,function(e,t){n.personSet(e,t)})}))},n._displayErrors=function(t,n){e.each(t,function(e,i){var o=n.find(".conv-screen.conv_active .conv-form-field.conv_for_"+e).addClass("conv_error");Object.keys(t)[0]===e&&o.find(".conv-form-field-message").html(i).css({display:"block"})})},n._utmParams=["utm_source","utm_medium","utm_campaign","utm_term","utm_content"],n.session=function(){if(arguments.length)return e.store("session",arguments[0]);var i=e.retrieve("session"),o=!i||!i.expires||i.expires<t();if(o){n.personSet({$visitNum:n.personGet("$visitNum",0)+1,$fvDate:n.personGet("$fvDate",t()),$lvDate:i&&i.expires?i.expires-1800:null}),i={start:t(),shown:[],startUrl:document.URL,referrer:document.referrer};for(var s=0;s<this._utmParams.length;s++){var r=this._utmParams[s],a=n.getUrlQuery(r);""!==a&&void 0!==a&&(i[r]=a)}}return i.expires=t()+1800,n.session(i),i.isNew=o,"string"==typeof i.shown&&(i.shown=JSON.parse(i.shown||"[]")||[]),i},n.personSet=function(t,i){if(void 0===i&&t)return e.each(t,n.personSet);var o=n.personGet();null!==i?o[t]=i:delete o[t],e.store("person",o),t="personParam:"+t,s.set(t,i)},n.personSetOnce=function(t,i){if(void 0===i&&t)return e.each(t,n.personSetOnce);null===n.personGet(t)&&n.personSet(t,i)},n.personGet=function(t,n){var i=e.retrieve("person",{});return void 0===t?i:(n=void 0===n?null:n,i=void 0!==i[t]?i[t]:n)},n.reset=function(){e.store("person",null),e.store("session",null),e.store("lastEvents",null),e.store("prevEvents",null),e.store("customEvents",{})},n.reinit=function(){var t=function(e){s.checkWidgetRules(e)&&n.show(e),n.off("afterHide",t)};e.each(n.widgets,function(e,i){var o=+i.id;i.isInstant&&a.canBeShown(o)&&(n.$widgets[o]?(n.on("afterHide",t.bind(this,o)),n.hide(o)):s.checkWidgetRules(o)&&n.show(o))}.bind(this))},n.init=function(t){n.ver="1.3",n.siteId=+t.site_id,n.widgets={},t.cookies&&e.each(t.cookies,function(t,n){e.setCookie(t,n)}),t.personParam&&e.each(t.personParam,function(e,t){n.personSet(e,t)}),a.init(t.widgets),e.each(n.getUrlQueries(),function(e,t){if(!/^conv_/.test(e))return 0;e=e.replace(/^conv_/,""),n.personSet(e,t),"email"===e&&n._createDatapost("get_parameter",{email:t})}),cQuery(function(e){if(n.currentState=document.documentElement.clientWidth<600?"mobile":"desktop",e.$window.on("resize",function(){n.currentState=document.documentElement.clientWidth<600?"mobile":"desktop"}),t.widgets.length&&(n.$styles.general=e('<style type="text/css" class="conv-css conv_id_general">'+(t.css||"")+"</style>")),t.widgets.forEach(function(e){var t=+e.id;n.widgets[t]=e,a.canBeShown(t)&&(s.attach(t,e.showIf),e.fab&&s.attach(t,e.fabShowIf),n.one("afterInit",function(e){n.widgets[e].isInstant&&s.checkWidgetRules(e)&&n.show(e)&&(n.widgets[e].isInstant||s.detach(e),n.trigger("widgetAffected",[e]))}.bind(this,t)))}),r.rules=t.custom_events||{},e.each(r.rules,function(t,n){if(r.attach(t,n),r.checkRule(n)){var i=e.retrieve("customEvents",{}),o="triggered:"+t;s.values[o]=!0,s._render(o,!0),i[o]=!0,e.store("customEvents",i),r._trackEvent(t)}}),t.js&&e.safeEval(t.js),n.isIOS&&n.isFB&&"1"===n.getUrlQuery("convFBLogin")){window.scroll(0,+e.retrieve("convScroll"));var i={data:e.retrieve("convStoredData")||{}},o=JSON.parse(n.getUrlQuery("convData")),c=+o.widgetId;e.each(o.data,function(e,t){i.data[e]=t}),n.one("afterShow",function(e){if(e===c){var t=n.$widgets[e].find(".conv-socsign").mod("conv_id");n._maybeSubmitData(e,t,i)}}),n.show(c)}location.hash&&s.setEvent('clicked:a[href*="'+location.hash+'"]'),n.isReady=!0,n.trigger("afterInit")})},n.load=function(){var t=document.getElementById("convertful-api")||document.getElementById("optinguru-api")||document.getElementById("optin-api");if(!t){var n=document.getElementsByTagName("script");for(var i in n=Array.prototype.slice.call(n)){var o=n[i].getAttribute("src");if(/(Convertful|optin)(.*?).js/gi.test(o)){t=n[i];break}}}var s=window.Convertful,r=t.getAttribute("src"),a=r.split("/").slice(0,-1).join("/"),c=+(t.getAttribute("data-owner")||s.getUrlQuery("owner",r));if(c){s.ajaxUrl=a,s.owner=c,window.Convertful=s,e.ajax({url:a+"/api/widget/export",ifModified:!0,data:{owner:c,domain:location.host||window.parent.location.host,subscriber_uid:s.personGet("$UID",void 0)},success:function(e){e.success&&e.data.site_id&&e.data.widgets instanceof Array&&s.init(e.data)}});var l=s.session();l.pageViews=(l.pageViews||0)+1,s.session(l),l.isNew&&(document.cookie="session_id=1;expires="+new Date(1e3*l.expires).toGMTString()+";domain="+a.split("/")[2]+";path=/; secure; samesite=none")}},n}(cQuery),function(e,t){t.Convertful&&!t.disable_convertful&&t.Convertful.load()}(cQuery,window);
//# sourceMappingURL=Convertful.js.map